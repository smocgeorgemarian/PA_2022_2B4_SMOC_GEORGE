if (self.CavalryLogger) { CavalryLogger.start_js_script(document.currentScript); }/*FB_PKG_DELIM*/

__d("MessengerDesktopAppLinks",[],(function(a,b,c,d,e,f){e.exports={macOSX:"/messenger/desktop/downloadV2/?platform=mac",windows:"/messenger/desktop/downloadV2/?platform=win",download:"https://messenger.com/desktop/#startDownload"}}),null);
__d("LSSerializeBackupPayloadIndirection.bs",["bs_curry","cr:280","cr:740","unrecoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){if(b("cr:740")==null)if(b("cr:280")==null)return b("unrecoverableViolation")("LSSerializeBackupPayloadIndirection.res: messenger_armadillo_web:enable_armadillo OR messenger_armadillo_web:enable_encrypted_backups_shadow_test is not defined","labyrinth_web");else return b("bs_curry")._5(b("cr:280").call,a,c,d,e,f).then(function(a){return a});else return b("bs_curry")._5(b("cr:740").call,a,c,d,e,f).then(function(a){return a})}f.$LSSerializeBackupPayloadConditional$requireCond=b("cr:280");f.$LSSerializeBackupPayloadConditional$requireCond$1=b("cr:740");f.call=a}),null);
__d("LSDeleteBackupOnClient",["LSAppendDataTraceAddon","LSFlushDataTrace.bs"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(e){return c.seq([function(b){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]Beginning execution."),c.i64.neq(a[0],f)?c.fe(c.db.table(168).fetch([[[a[0]]]]),function(a){return a["delete"]()}):c.fe(c.db.table(168).fetch(),function(a){return a["delete"]()})},function(b){return a[2]?c.fe(c.db.table(172).fetch([[[[0,1]]]]),function(a){var b=a.update;a.item;return b({backupId:f})}):c.resolve()},function(e){return a[3]!==f?c.seq([function(d){return a[3]!==f?c.sp(b("LSAppendDataTraceAddon"),a[3],[0,1423],[0,2],f,f):c.resolve()},function(d){return a[3]!==f?c.nop(b("LSFlushDataTrace.bs"),a[3]):c.resolve()}]):a[1]!==f?c.seq([function(b){return c.seq([function(b){return c.ftr(c.db.table(153).fetch(),function(b){return b.contextOne===a[1]||b.contextTwo===a[1]||b.contextThree===a[1]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[2]=f:(b=a.item,d[2]=b.traceId)})},function(a){return d[0]=d[2]}])},function(a){return d[0]!==f?d[0]!==f?c.sp(b("LSAppendDataTraceAddon"),d[0],[0,1423],[0,2],f,f):c.resolve():c.resolve()},function(b){return c.seq([function(b){return c.ftr(c.db.table(153).fetch(),function(b){return b.contextOne===a[1]||b.contextTwo===a[1]||b.contextThree===a[1]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[2]=f:(b=a.item,d[2]=b.traceId)})},function(a){return d[1]=d[2]}])},function(a){return d[1]!==f?c.nop(b("LSFlushDataTrace.bs"),d[1]):c.resolve()}]):c.resolve()},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsDeleteBackupOnClientStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSSyncEpochs",["LSAppendDataTraceAddon","LSCreateDataTraceID.bs","LSDeleteBackupOnClient","LSFlushDataTrace.bs","LSIssueNewTask"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Beginning execution."),c.islc(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])&&c.i64.eq(a.backupTenancy,[0,2])}),0,c.i64.to_float([0,1])).next().then(function(a,b){b=a.done;a=a.value;return b?d[0]=!1:(a.item,d[0]=!0)})},function(a){return d[0]?d[2]=c.i64.or_([0,78],[0,128]):d[2]=[0,78],c.nop(b("LSCreateDataTraceID.bs")).then(function(a){return a=a,d[3]=a[0],a})},function(a){return d[4]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][MEBTraceUtils]",d[4],"EncryptedBackups Trace ID",d[4],c.i64.to_string(d[2])].join("")),c.db.table(153).add({traceId:d[3],initTimestampMs:c.i64.of_float(Date.now()),traceType:d[2],shouldFlush:!1,contextThree:"synch_epochs"})},function(a){return d[3]!==f?c.sp(b("LSAppendDataTraceAddon"),d[3],[0,1436],[0,2],f,f):c.resolve()},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.context===c.i64.to_string([0,50013])}).next().then(function(a,b){b=a.done;a=a.value;return b?d[5]=!1:(a.item,d[5]=!0)})},function(a){return d[5]?c.seq([function(a){return d[3]!==f?c.sp(b("LSAppendDataTraceAddon"),d[3],[0,1436],[0,2],"Another sync job is already in progress. Terminating this.",f):c.resolve()},function(a){return d[8]="synch_epochs",c.seq([function(a){return c.ftr(c.db.table(153).fetch(),function(a){return a.contextOne===d[8]||a.contextTwo===d[8]||a.contextThree===d[8]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[9]=f:(b=a.item,d[9]=b.traceId)})},function(a){return d[7]=d[9]}])},function(a){return d[7]!==f?c.nop(b("LSFlushDataTrace.bs"),d[7]):c.resolve()},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Another sync job is already in progress. Terminating this.")}]):c.seq([function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return d[7]=a})},function(a){return c.i64.eq(d[7],[0,1])?c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(a,e){var g=a.done;a=a.value;return g?0:(e=a.item,d[9]=e.backupId,d[8]=e.deviceId,c.i64.neq(d[8],f)?(d[10]=new c.Map(),d[10].set("backup_id",d[9]),d[10].set("device_id",d[8]),d[10].set("trace_id",d[3]),d[11]=c.toJSON(d[10]),c.sp(b("LSIssueNewTask"),"messenger_encrypted_backups",[0,50013],d[11],f,f,[0,0],[0,0],f,f,[0,0])):c.seq([function(a){return d[3]!==f?c.sp(b("LSAppendDataTraceAddon"),d[3],[0,1436],[0,2],"device_id is null. Cleaning backup on client",f):c.resolve()},function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client"),d[3]!==f?d[3]!==f?c.sp(b("LSAppendDataTraceAddon"),d[3],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]device_id is null. Cleaning backup on client",f):c.resolve():c.resolve()},function(a){return d[3]!==f?c.nop(b("LSFlushDataTrace.bs"),d[3]):c.resolve()},function(a){return c.sp(b("LSDeleteBackupOnClient"),d[9],"synch_epochs",!0,d[3])}]))}):c.seq([function(a){return d[3]!==f?c.sp(b("LSAppendDataTraceAddon"),d[3],[0,1436],[0,2],"Exactly 1 entry is expected in client_state_table",f):c.resolve()},function(a){return d[11]="synch_epochs",c.seq([function(a){return c.ftr(c.db.table(153).fetch(),function(a){return a.contextOne===d[11]||a.contextTwo===d[11]||a.contextThree===d[11]}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[12]=f:(b=a.item,d[12]=b.traceId)})},function(a){return d[8]=d[12]}])},function(a){return d[8]!==f?c.nop(b("LSFlushDataTrace.bs"),d[8]):c.resolve()},function(a){return c.ct(c.ftr(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return d[9]=a})},function(a){return d[10]="",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]",d[10],"Exactly 1 entry is expected in client_state_table. Found = ",d[10],c.i64.to_string(d[9])].join(""))}])}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsSyncEpochsStoredProcedure]Finishing execution.")}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSTaskSerializerMuteThreadV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerMuteThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(a){return c[6]=f.threadKey,b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?(c[7]=b.createArray(),c[8]=(c[7].push("TaskSerializerMuteThreadV2: Thread not found"),c[7]),c[9]=(c[7].push(c[6]),c[7]),c[10]=b.toJSON(c[7]),function(a){b.logger(a).mustfix(a)}(c[10]),a=[e,e],c[3]=a[0],c[4]=a[1],a):(f=d.item,b.seq([function(a){return b.db.table(9).fetch([[[c[6]]]]).next().then(function(d,f){var a=d.done;d=d.value;return a?c[7]=[0,1]:(f=d.item,c[12]=f.syncGroup,b.i64.neq(c[12],e)?c[11]=c[12]:c[11]=[0,1],c[7]=c[11])})},function(a){return c[9]=new b.Map(),c[9].set("thread_key",c[6]),c[9].set("mailbox_type",[0,0]),c[9].set("mute_expire_time_ms",f.muteExpireTimeMs),c[9].set("sync_group",c[7]),c[10]=b.toJSON(c[9]),a=[c[10],[0,144]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerRemoveThread",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(32).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("TaskSerializerRemoveThreadV2: Task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,c[5]=f.removeType,b.i64.neq(c[5],e)?(c[6]=new b.Map(),c[6].set("thread_key",f.threadKey),c[6].set("remove_type",c[5]),c[6].set("sync_group",f.syncGroup==null?[0,1]:f.syncGroup),c[7]=b.toJSON(c[6]),g=[c[7],[0,146]],c[3]=g[0],c[4]=g[1],g):(d=[e,e],c[3]=d[0],c[4]=d[1],d),f=[c[3],c[4]],c[0]=f[0],c[1]=f[1],f)})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSTaskSerializerSendMessageV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(31).fetch([[[a[0]]]]).next().then(function(d,f){var g=d.done;d=d.value;return g?(c[3]=b.createArray(),c[4]=(c[3].push("task ID not found"),c[3]),c[5]=(c[3].push(a[0]),c[3]),c[6]=b.toJSON(c[3]),function(a){b.logger(a).mustfix(a)}(c[6]),g=[e,e],c[0]=g[0],c[1]=g[1],g):(f=d.item,b.seq([function(d){return c[9]=f.offlineThreadingId,c[10]=f.messageId,c[14]=f.threadAttributionSource,c[7]=f.platformRef,c[8]=f.platformToken,c[6]=f.replySourceId,c[11]=f.replySourceType,c[13]=f.sendType,c[12]=f.initiatingSource,b.db.table(12).fetch([[[c[9]]],"optimistic"]).next().then(function(f,h){var d=f.done;f=f.value;return d?(c[15]=b.createArray(),c[16]=(c[15].push("OTID not found"),c[15]),c[17]=(c[15].push(c[9]),c[15]),c[18]=b.toJSON(c[15]),function(a){b.logger(a).mustfix(a)}(c[18]),d=[e,e],c[3]=d[0],c[4]=d[1],d):(h=f.item,b.seq([function(d){return c[21]=h.text,c[19]=h.threadKey,c[22]=h.messageId,c[20]=h.stickerId,c[24]=h.mentionOffsets,c[25]=h.mentionLengths,c[18]=h.mentionIds,c[26]=h.mentionTypes,c[29]=h.replyType,c[27]=h.isForwarded,c[23]=h.forwardScore,c[28]=h.hotEmojiSize,b.db.table(9).fetch([[[c[19]]]]).next().then(function(f,i){var d=f.done;f=f.value;return d?(c[30]=b.createArray(),c[31]=(c[30].push("thread not found"),c[30]),c[32]=(c[30].push(c[19]),c[30]),c[33]=b.toJSON(c[30]),function(a){b.logger(a).mustfix(a)}(c[33]),d=[e,e],c[15]=d[0],c[16]=d[1],d):(i=f.item,b.seq([function(d){return b.db.table(2).fetch([[[a[0]]]]).next().then(function(e,f){var d=e.done;e=e.value;return d?c[30]=!1:(f=e.item,b.seq([function(d){return b.islc(b.ftr(b.db.table(2).fetch(),function(a){return a.queueName===f.queueName}),0,b.i64.to_float([0,1])).next().then(function(e,f){var d=e.done;e=e.value;return d?c[34]=!1:(f=e.item,c[34]=b.i64.eq(f.taskId,a[0]))})},function(a){return c[30]=c[34]}]))})},function(a){return b.i64.eq(i.authorityLevel,[0,20])&&b.i64.eq(i.threadType,[0,2])&&c[30]?b.seq([function(a){return c[35]=c[13]==null?[0,1]:c[13],c[34]=new b.Map(),c[34].set("thread_id",c[19]),c[34].set("otid",c[9]),c[34].set("source",c[14]==null?[0,0]:c[14]),c[34].set("send_type",[0,1]),b.i64.eq(c[35],[0,1])?b.resolve(c[34].set("text",c[21])):b.i64.eq(c[35],[0,2])?b.resolve(b.i64.neq(c[20],e)?(c[34].set("sticker_id",c[20]),c[34].set("send_type",c[35])):0):b.i64.eq(c[35],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[43]=a[0],c[44]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[43]=a[0],c[44]=a[1],a)})},function(a){return c[43]!==e?b.i64.neq(c[44],e)?(c[34].set("url",c[43]),c[34].set("attribution_app_id",c[44]),c[34].set("send_type",c[35])):0:0}]):b.i64.eq(c[35],[0,3])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,9])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,10])?b.seq([function(a){return c[34].set("text",c[21]),c[43]=b.createArray(),c[44]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[45]=a.offlineAttachmentId,c[46]=(c[43].push(b.i64.from_string(a.attachmentFbid)),c[43]),c[45]!==e?c[46]=(c[44].push(c[45]),c[44]):0})},function(a){return c[34].set("attachment_fbids",c[43]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[44]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[43]=e:(d=b.item,c[43]=d.attachmentFbid)})},function(a){return c[43]!==e?(c[34].set("text",c[21]),c[34].set("forwarded_share_id",c[43]),c[34].set("send_type",c[35])):0}]):b.i64.eq(c[35],[0,5])?b.resolve(c[10]!==e?(c[34].set("forwarded_msg_id",c[10]),c[34].set("send_type",c[35]),b.i64.neq(c[23],e)?c[34].set("forward_score",c[23]):0):0):b.i64.eq(c[35],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[43]=a[0],c[44]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[43]=a[0],c[44]=a[1],a)})},function(a){return c[43]!==e?(c[34].set("url",c[43]),c[34].set("text",c[21]),c[34].set("send_type",c[35])):0}]):b.resolve(0)},function(a){return c[39]=c[6]===""?e:c[6],c[39]!==e?b.i64.neq(c[11],e)?(c[43]=new b.Map(),c[43].set("reply_source_id",c[39]),c[43].set("reply_source_type",c[11]),c[43].set("reply_type",c[29]==null?[0,0]:c[29]),c[34].set("reply_metadata",c[43])):0:0,c[40]=c[18]===""?e:c[18],c[40]!==e?(c[43]=c[24]===""?e:c[24],c[43]!==e?(c[44]=c[25]===""?e:c[25],c[44]!==e?(c[45]=new b.Map(),c[45].set("mention_ids",c[40]),c[45].set("mention_offsets",c[43]),c[45].set("mention_lengths",c[44]),c[45].set("mention_types",c[26]===""?e:c[26]),c[34].set("mention_data",c[45])):0):0):0,c[27]!==e?c[34].set("is_forwarded",c[27]):0,c[41]=c[7]===""?e:c[7],c[41]!==e?c[34].set("platform_ref",c[41]):0,c[42]=c[8]===""?e:c[8],c[42]!==e?c[34].set("platform_token",c[42]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[35],a)})?b.i64.neq(c[28],e)?c[34].set("hot_emoji_size",c[28]):0:0,b.i64.neq(c[12],e)?c[34].set("initiating_source",c[12]):0,c[36]=b.createArray(),b.fe(b.db.table(14).fetch([[[c[19]]]]),function(a){a=a.item;return c[43]=(c[36].push(a.contactId),c[36])})},function(a){return c[37]=new b.Map(),c[37].set("participants",c[36]),c[37].set("send_payload",c[34]),b.fe(b.ftr(b.db.table(9).fetch(),function(a){return b.i64.eq(a.threadKey,i.threadKey)}),function(a){var b=a.update;a.item;return b({otidOfFirstMessage:h.offlineThreadingId})})},function(a){return c[38]=b.toJSON(c[37]),a=[c[38],[0,130]],c[32]=a[0],c[33]=a[1],a}]):b.seq([function(a){return c[35]=c[13]==null?[0,1]:c[13],c[34]=new b.Map(),c[34].set("thread_id",c[19]),c[34].set("otid",c[9]),c[34].set("source",c[14]==null?[0,0]:c[14]),c[34].set("send_type",[0,1]),b.i64.eq(c[35],[0,1])?b.resolve(c[34].set("text",c[21])):b.i64.eq(c[35],[0,2])?b.resolve(b.i64.neq(c[20],e)?(c[34].set("sticker_id",c[20]),c[34].set("send_type",c[35])):0):b.i64.eq(c[35],[0,7])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[41]=a[0],c[42]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[41]=a[0],c[42]=a[1],a)})},function(a){return c[41]!==e?b.i64.neq(c[42],e)?(c[34].set("url",c[41]),c[34].set("attribution_app_id",c[42]),c[34].set("send_type",c[35])):0:0}]):b.i64.eq(c[35],[0,3])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,9])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,10])?b.seq([function(a){return c[34].set("text",c[21]),c[41]=b.createArray(),c[42]=b.createArray(),b.fe(b.sb(b.db.table(16).fetch([[[c[19],c[22]]]]),[["attachmentIndex","ASC"]]),function(a){a=a.item;return c[43]=a.offlineAttachmentId,c[44]=(c[41].push(b.i64.from_string(a.attachmentFbid)),c[41]),c[43]!==e?c[44]=(c[42].push(c[43]),c[42]):0})},function(a){return c[34].set("attachment_fbids",c[41]),b.i64.eq(c[35],[0,9])?c[34].set("offline_attachment_ids",c[42]):0,c[34].set("send_type",c[35])}]):b.i64.eq(c[35],[0,4])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?c[41]=e:(d=b.item,c[41]=d.attachmentFbid)})},function(a){return c[41]!==e?(c[34].set("text",c[21]),c[34].set("forwarded_share_id",c[41]),c[34].set("send_type",c[35])):0}]):b.i64.eq(c[35],[0,5])?b.resolve(c[10]!==e?(c[34].set("forwarded_msg_id",c[10]),c[34].set("send_type",c[35]),b.i64.neq(c[23],e)?c[34].set("forward_score",c[23]):0):0):b.i64.eq(c[35],[0,6])?b.seq([function(a){return b.db.table(16).fetch([[[c[19],c[22]]]]).next().then(function(b,d){var a=b.done;b=b.value;return a?(a=[e,e],c[41]=a[0],c[42]=a[1],a):(d=b.item,a=[d.filename,d.attributionAppId],c[41]=a[0],c[42]=a[1],a)})},function(a){return c[41]!==e?(c[34].set("url",c[41]),c[34].set("text",c[21]),c[34].set("send_type",c[35])):0}]):b.resolve(0)},function(a){return c[37]=c[6]===""?e:c[6],c[37]!==e?b.i64.neq(c[11],e)?(c[41]=new b.Map(),c[41].set("reply_source_id",c[37]),c[41].set("reply_source_type",c[11]),c[41].set("reply_type",c[29]==null?[0,0]:c[29]),c[34].set("reply_metadata",c[41])):0:0,c[38]=c[18]===""?e:c[18],c[38]!==e?(c[41]=c[24]===""?e:c[24],c[41]!==e?(c[42]=c[25]===""?e:c[25],c[42]!==e?(c[43]=new b.Map(),c[43].set("mention_ids",c[38]),c[43].set("mention_offsets",c[41]),c[43].set("mention_lengths",c[42]),c[43].set("mention_types",c[26]===""?e:c[26]),c[34].set("mention_data",c[43])):0):0):0,c[27]!==e?c[34].set("is_forwarded",c[27]):0,c[39]=c[7]===""?e:c[7],c[39]!==e?c[34].set("platform_ref",c[39]):0,c[40]=c[8]===""?e:c[8],c[40]!==e?c[34].set("platform_token",c[40]):0,[[0,1],[0,2]].some(function(a){return b.i64.eq(c[35],a)})?b.i64.neq(c[28],e)?c[34].set("hot_emoji_size",c[28]):0:0,b.i64.neq(c[12],e)?c[34].set("initiating_source",c[12]):0,c[36]=b.toJSON(c[34]),a=[c[36],[0,46]],c[32]=a[0],c[33]=a[1],a}])},function(a){return a=[c[32],c[33]],c[15]=a[0],c[16]=a[1],a}]))})},function(a){return a=[c[15],c[16]],c[3]=a[0],c[4]=a[1],a}]))})},function(a){return a=[c[3],c[4]],c[0]=a[0],c[1]=a[1],a}]))})},function(a){return a=[c[0],c[1]],d[0]=a[0],d[1]=a[1],a}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasksForQueue",["LSAppendDataTraceAddon","LSFlushDataTrace.bs","LSSerializeBackupPayloadIndirection.bs","LSSyncEpochs","LSTaskSerializerMuteThreadV2","LSTaskSerializerRemoveThread","LSTaskSerializerSendMessageV2"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(b){return c.ftr(c.db.table(3).fetch([[[a[0]]]]),function(b){return c.i64.neq(b.epochId,f)&&b.taskQueueName===a[0]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[0]=!1:(a.item,d[0]=!0)})},function(e){return d[2]=new c.Map(),d[2].set("queue_name",a[0]),d[2].set("next_sync_ms",f),d[2].set("work_item_type",[0,4]),d[2].set("network_payload",f),d[2].set("http_url_override",f),d[2].set("skip_realtime_gateway",!1),d[3]=d[2],d[0]?c.resolve():c.seq([function(b){return c.islc(c.ftr(c.db.table(2).fetch(),function(b){return b.queueName===a[0]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[4]=c[0],d[5]=c[1],d[6]=c[2],d[7]=c[3],d[8]=c[4],d[9]=c[5],c)})},function(b){return c.db.table(3).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[11]=[0,0]:(b=a.item,d[11]=b.lastSyncRequestTimestampMs)})},function(e){return d[14]=c.i64.sub(d[5],c.i64.of_float(Date.now())),c.i64.le(d[14],[0,0])?(c.i64.eq(d[7],[0,0])||a[1]?d[15]=[0,0]:(c.i64.gt(d[7],[0,7])?d[17]=c.i64.sub(d[7],[0,7]):d[17]=d[7],d[18]=c.i64.sub(d[17],[0,1]),d[19]=c.i64.mul(c.i64.lsl_([0,1],c.i64.to_int32(c.i64.lt(d[18],[0,7])?d[18]:[0,7])),[0,500]),d[15]=c.i64.lt(d[19],[0,3e4])?d[19]:[0,3e4]),d[16]=c.i64.sub(c.i64.add(d[11],d[15]),c.i64.of_float(Date.now())),d[13]=c.i64.gt(d[16],[0,0])?d[16]:[0,0]):d[13]=d[14],c.i64.neq(d[13],[0,0])?c.resolve((d[15]=new c.Map(),d[15].set("queue_name",a[0]),d[15].set("next_sync_ms",d[13]),d[15].set("work_item_type",[0,3]),d[15].set("network_payload",f),d[15].set("http_url_override",f),d[15].set("skip_realtime_gateway",!1),d[3]=d[15])):c.seq([function(a){return c.i64.neq(d[6],[0,0])||d[8]==="16"||d[8]==="4"?c.resolve((a=[d[4],f,[0,2],f,f,!1],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a)):c.seq([function(a){return d[22]=c.createArray(),d[23]=!0,c.islc(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[24]=c[0],d[25]=c[1],d[26]=c[2],d[27]=c[3],d[28]=c[4],d[29]=c[5],c)})},function(a){return c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}).next().then(function(a,b){b=a.done;a=a.value;return b?d[31]=!0:(a.item,d[31]=!0)})},function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),function(a){var e=a.item;return d[42]=e.taskId,d[40]=e.context,d[43]=e.failureCount,d[41]=e.timeoutTimestampMs,d[23]=e.httpUrlOverride===d[29]&&!0===d[31]&&d[23],d[23]?c.seq([function(a){return d[40]===f?c.seq([function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}),function(a){return a["delete"]()})},function(a){return d[44]=f}]):c.seq([function(a){return c.i64.neq(d[41],f)?d[48]=c.i64.ge(c.i64.of_float(Date.now()),d[41]):d[48]=!1,d[48]?c.seq([function(a){return c.fe(c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}),function(a){return a["delete"]()})},function(a){return d[49]=f}]):c.seq([function(a){return c.seq([function(a){return d[40]==="46"?c.seq([function(a){return c.sp(b("LSTaskSerializerSendMessageV2"),d[42]).then(function(a){return a=a,d[57]=a[0],d[58]=a[1],a})},function(a){return a=[d[57],c.i64.to_string(d[58])],d[53]=a[0],d[54]=a[1],a}]):c.seq([function(a){return d[40]==="144"?c.seq([function(a){return c.sp(b("LSTaskSerializerMuteThreadV2"),d[42]).then(function(a){return a=a,d[59]=a[0],d[60]=a[1],a})},function(a){return a=[d[59],c.i64.to_string(d[60])],d[57]=a[0],d[58]=a[1],a}]):c.seq([function(a){return d[40]==="146"?c.seq([function(a){return c.sp(b("LSTaskSerializerRemoveThread"),d[42]).then(function(a){return a=a,d[61]=a[0],d[62]=a[1],a})},function(a){return a=[d[61],c.i64.to_string(d[62])],d[59]=a[0],d[60]=a[1],a}]):c.seq([function(a){return d[40]==="32"?c.seq([function(a){return c.seq([function(a){return c.db.table(32).fetch([[[d[42]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[68]=c.createArray(),d[69]=(d[68].push("taskSerializerUpdateThreadName: Task ID not found"),d[68]),d[70]=(d[68].push(d[42]),d[68]),d[71]=c.toJSON(d[68]),function(a){c.logger(a).mustfix(a)}(d[71]),e=[f,f],d[65]=e[0],d[66]=e[1],e):(b=a.item,c.seq([function(a){return d[71]=b.threadKey,c.db.table(9).fetch([[[d[71]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?(d[72]=c.createArray(),d[73]=(d[72].push("taskSerializerUpdateThreadName: Thread not found"),d[72]),d[74]=(d[72].push(d[71]),d[72]),d[75]=c.toJSON(d[72]),function(a){c.logger(a).mustfix(a)}(d[75]),a=[f,f],d[68]=a[0],d[69]=a[1],a):(e=b.item,c.seq([function(a){return c.db.table(9).fetch([[[d[71]]]]).next().then(function(b,e){var a=b.done;b=b.value;return a?d[72]=[0,1]:(e=b.item,d[77]=e.syncGroup,c.i64.neq(d[77],f)?d[76]=d[77]:d[76]=[0,1],d[72]=d[76])})},function(a){return d[74]=new c.Map(),d[74].set("thread_key",d[71]),d[74].set("thread_name",e.threadName==null?"":e.threadName),d[74].set("sync_group",d[72]),d[75]=c.toJSON(d[74]),a=[d[75],[0,32]],d[68]=a[0],d[69]=a[1],a}]))})},function(a){return a=[d[68],d[69]],d[65]=a[0],d[66]=a[1],a}]))})},function(a){return a=[d[65],d[66]],d[63]=a[0],d[64]=a[1],a}])},function(a){return a=[d[63],c.i64.to_string(d[64])],d[61]=a[0],d[62]=a[1],a}]):c.seq([function(a){return d[40]==="362"?c.resolve((a=[f,f],d[65]=a[0],d[66]=a[1],a,a=[d[65],c.i64.to_string(d[66])],d[63]=a[0],d[64]=a[1],a)):c.seq([function(a){return d[40]==="50015"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Beginning execution."),c.db.table(168).fetch().next().then(function(a,e){var h=a.done;a=a.value;return h?(h=[f,f],d[69]=h[0],d[70]=h[1],h):(e=a.item,c.seq([function(a){return d[74]=e.deviceId,c.i64.neq(d[74],f)?c.seq([function(a){return c.db.table(190).fetch([[[d[42]]]]).next().then(function(e,i){var a=e.done;e=e.value;return a?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]No restore payload context found."),a=[f,f],d[75]=a[0],d[76]=a[1],a):(i=e.item,c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Beginning execution."),c.ct(c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])})).then(function(a){return d[82]=a})},function(a){return c.i64.le(d[82],[0,1])?c.seq([function(a){return c.ftr(c.db.table(169).fetch(),function(a){return c.i64.eq(a.epochStatus,[0,1])&&c.i64.eq(a.authorityLevel,[0,80])}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return c.sp(b("LSSyncEpochs"))},function(a){return d[84]=f}]):(i=e.item,d[86]=new c.Map(),d[86].set("epoch_id",i.epochId),d[86].set("epoch_root_key",i.epochRootKeyBlob),d[86].set("epoch_anon_id",i.epochAnonIdBlob),d[84]=d[86])})},function(a){return d[83]=d[84]}]):c.seq([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsSecureEncryptedBackupsEpochsTable]Error! More than 1 open epoch was found. Calling the sync flow and returning empty results"),c.sp(b("LSSyncEpochs"))},function(a){return c.ftr(c.db.table(169).fetch(),function(a){return!1}).next().then(function(e,i){var a=e.done;e=e.value;return a?c.seq([function(a){return c.sp(b("LSSyncEpochs"))},function(a){return d[84]=f}]):(i=e.item,d[86]=new c.Map(),d[86].set("epoch_id",i.epochId),d[86].set("epoch_root_key",i.epochRootKeyBlob),d[86].set("epoch_anon_id",i.epochAnonIdBlob),d[84]=d[86])})},function(a){return d[83]=d[84]}])},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsGetOpenEpochKeysStoredProcedure]Finishing execution."),d[78]=d[83]}])},function(a){return d[78]!==f?(d[82]=d[78].get("epoch_id"),d[78],d[79]=d[82]):d[79]=f,d[80]=new c.Map(),d[80].set("content_type",i.contentType),d[80].set("device_id",d[74]),d[80].set("epoch_id",d[79]),d[80].set("list_id",i.listId),d[80].set("num_items",i.numItems),d[80].set("start_sort_key",i.startSortKey),d[80].set("mailbox_partial_id",i.mailboxPartialId),d[80].set("trace_id",i.traceId),d[81]=c.toJSON(d[80]),a=[d[81],[0,50015]],d[75]=a[0],d[76]=a[1],a}]))})},function(a){return a=[d[75],d[76]],d[72]=a[0],d[73]=a[1],a}]):c.resolve((function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Unexpected error: Device ID is null."),a=[f,f],d[72]=a[0],d[73]=a[1],a))},function(a){return a=[d[72],d[73]],d[69]=a[0],d[70]=a[1],a}]))})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupsRestoreWithSerializerStoredProcedure]Finishing execution."),a=[d[69],d[70]],d[67]=a[0],d[68]=a[1],a}])},function(a){return a=[d[67],c.i64.to_string(d[68])],d[65]=a[0],d[66]=a[1],a}]):c.seq([function(a){return d[40]==="319"?c.seq([function(a){return c.seq([function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Beginning execution."),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,e){var h=a.done;a=a.value;return h?c.seq([function(a){return c.ftr(c.db.table(2).fetch(),function(a){return c.i64.eq(a.taskId,d[42])}).next().then(function(b,e){var a=b.done;b=b.value;return a?(function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Task not found."),d[76]=f):(e=b.item,d[76]=e.dataTraceId)})},function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Pending backup context not found"),d[76]!==f?d[76]!==f?c.sp(b("LSAppendDataTraceAddon"),d[76],[0,84],[0,2],"[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Pending backup context not found",f):c.resolve():c.resolve()},function(a){return d[76]!==f?c.nop(b("LSFlushDataTrace.bs"),d[76]):c.resolve()},function(a){return d[71]=f}]):(e=a.item,d[71]=e.lsTraceId)})},function(a){return d[71]!==f?c.sp(b("LSAppendDataTraceAddon"),d[71],[0,1451],[0,2],f,f):c.resolve()},function(a){return d[71]!==f?0:function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Trace ID is null"),c.db.table(177).fetch([[[d[42]]],"fk_pending_tasks"]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[73]=f:(b=a.item,d[73]=b.echoContent)})},function(a){return c.nop(b("LSSerializeBackupPayloadIndirection.bs"),d[42],d[73],d[71]).then(function(a){return a=a,d[75]=a[0],a})},function(a){return function(a){c.logger(a).info(a)}("[EncryptedBackups][LSEncryptedBackupsTaskSerializerEncryptedBackupActionStoredProcedure]Finishing execution."),a=[d[75],[0,319]],d[69]=a[0],d[70]=a[1],a}])},function(a){return a=[d[69],c.i64.to_string(d[70])],d[67]=a[0],d[68]=a[1],a}]):c.resolve((a=[e.taskValue,d[40]],d[67]=a[0],d[68]=a[1],a))},function(a){return a=[d[67],d[68]],d[65]=a[0],d[66]=a[1],a}])},function(a){return a=[d[65],d[66]],d[63]=a[0],d[64]=a[1],a}])},function(a){return a=[d[63],d[64]],d[61]=a[0],d[62]=a[1],a}])},function(a){return a=[d[61],d[62]],d[59]=a[0],d[60]=a[1],a}])},function(a){return a=[d[59],d[60]],d[57]=a[0],d[58]=a[1],a}])},function(a){return a=[d[57],d[58]],d[53]=a[0],d[54]=a[1],a}])},function(a){return d[31]?(a=[d[53],d[54]],d[55]=a[0],d[56]=a[1],a):(a=[f,f],d[57]=a[0],d[58]=a[1],a,a=[d[57],c.i64.to_string(d[58])],d[55]=a[0],d[56]=a[1],a),a=[d[55],d[56]],d[50]=a[0],d[51]=a[1],a}])},function(a){return d[50]!==f?(d[53]=new c.Map(),d[53].set("label",d[51]),d[53].set("payload",d[50]),d[53].set("queue_name",e.queueName),d[53].set("task_id",d[42]),d[53].set("failure_count",c.i64.eq(d[43],[0,0])?f:d[43]),d[52]=d[53]):d[52]=f,d[49]=d[52]}])},function(a){return d[44]=d[49]}])},function(a){return d[44]?d[45]=!1:d[45]=!0,d[45]?0:d[48]=(d[22].push(d[44]),d[22]),d[46]=c.i64.of_int32(d[22].length),d[40]!==f?d[47]=["90","130","153"].includes(d[40]):d[47]=!1,d[23]=!(c.i64.ge(d[46],[0,5])||d[47])}]):c.resolve()})},function(a){return d[33]=c.i64.of_int32(d[22].length),c.i64.eq(d[33],[0,0])?c.resolve((a=[d[4],f,[0,4],f,f,!1],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a)):c.seq([function(a){return d[40]=c.i64.random(),d[50]=c.i64.and_(c.i64.or_(c.i64.lsl_(c.i64.of_float(Date.now()),c.i64.to_int32([0,22])),c.i64.and_(d[40],[0,4194303])),[2147483647,4294967295]),c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]).next().then(function(a,b){b=a.done;a=a.value;return b?c.db.table(3).add({syncDatabaseId:[-1,4294967295],taskQueueName:d[4],failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:c.i64.of_float(Date.now()),epochId:d[50]}):(a.item,c.fe(c.db.table(3).fetch([[[d[4],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:d[50],lastSyncRequestTimestampMs:c.i64.of_float(Date.now())})}))})},function(a){return c.islc(c.ftr(c.db.table(2).fetch(),function(a){return a.queueName===d[4]}),0,c.i64.to_float([0,1])).next().then(function(a,b){var c=a.done;a=a.value;return c?(c=["",[-1,4294967295],[0,0],[-1,4294967295],f,f],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c):(b=a.item,c=[b.queueName,b.minTimeToSyncTimestampMs,b.pluginType,b.failureCount,b.context,b.httpUrlOverride],d[42]=c[0],d[43]=c[1],d[44]=c[2],d[45]=c[3],d[46]=c[4],d[47]=c[5],c)})},function(a){return d[49]=new c.Map(),d[49].set("tasks",d[22]),d[49].set("epoch_id",d[50]),a=[d[4],f,[0,1],d[49],d[47],!(d[47]===f)||c.i64.gt(d[45],[0,7])],d[34]=a[0],d[35]=a[1],d[36]=a[2],d[37]=a[3],d[38]=a[4],d[39]=a[5],a}])},function(a){return a=[d[34],d[35],d[36],d[37],d[38],d[39]],d[15]=a[0],d[16]=a[1],d[17]=a[2],d[18]=a[3],d[19]=a[4],d[20]=a[5],a}])},function(a){return d[21]=new c.Map(),d[21].set("queue_name",d[15]),d[21].set("next_sync_ms",d[16]),d[21].set("work_item_type",d[17]),d[21].set("network_payload",d[18]),d[21].set("http_url_override",d[19]),d[21].set("skip_realtime_gateway",d[20]),d[3]=d[21]}])}])},function(a){return e[0]=d[3]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingPendingTasks",["LSBeginHandlingPendingTasksForQueue"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[],f;return c.seq([function(g){return c.seq([function(e){return d[0]=c.createArray(),c.gb(c.sb(c.db.table(2).fetch(),[["queueName","ASC"]]),"queueName").forEach(function(e){return c.seq([function(f){return c.sp(b("LSBeginHandlingPendingTasksForQueue"),e.queueName,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return c.gb(c.sb(c.db.table(5).fetch(),[["queueName","ASC"]]),"queueName").forEach(function(a){return d[1]=a.queueName,c.seq([function(a){return d[2]=c.createArray(),c.fe(c.ftr(c.db.table(5).fetch(),function(a){return a.queueName===d[1]}),function(a){a=a.item;return d[5]=new c.Map(),d[5].set("label",a.context),d[5].set("payload",a.taskValue),d[5].set("queue_name",a.queueName),d[5].set("task_id",a.taskId),d[5].set("failure_count",c.i64.eq([0,0],[0,0])?f:[0,0]),d[6]=(d[2].push(d[5]),d[2])})},function(a){return d[3]=new c.Map(),d[3].set("tasks",d[2]),d[3].set("epoch_id",f),d[4]=new c.Map(),d[4].set("queue_name",d[1]),d[4].set("next_sync_ms",f),d[4].set("work_item_type",[0,5]),d[4].set("network_payload",d[3]),d[4].set("http_url_override",f),d[4].set("skip_realtime_gateway",!1),d[5]=(d[0].push(d[4]),d[0])}])})},function(a){return c.fe(c.db.table(5).fetch(),function(a){return a["delete"]()})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSBeginHandlingSyncForSyncGroup",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(f){return b.seq([function(d){return b.db.table(1).fetch([[[a[0]]]]).next().then(function(a,d){var f=a.done;a=a.value;return f?c[0]=e:(d=a.item,c[9]=new b.Map(),c[9].set("group_id",d.groupId),c[9].set("current_cursor",d.currentCursor),c[9].set("sync_status",d.syncStatus),c[9].set("sync_params",d.syncParams),c[9].set("send_sync_params",d.sendSyncParams),c[9].set("min_time_to_sync_timestamp_ms",d.minTimeToSyncTimestampMs),c[9].set("can_ignore_timestamp",d.canIgnoreTimestamp),c[9].set("sync_channel",d.syncChannel),c[9].set("last_sync_request_timestamp_ms",d.lastSyncRequestTimestampMs),c[0]=c[9])})},function(d){return c[0]?c[2]=!1:c[2]=!0,c[2]?b.resolve((d=[a[0],e,[0,4],e,!1],c[3]=d[0],c[4]=d[1],c[5]=d[2],c[6]=d[3],c[7]=d[4],d)):b.seq([function(a){return c[9]=c[0].get("group_id"),c[0],b.ftr(b.db.table(3).fetch(),function(a){return b.i64.neq(a.epochId,e)&&b.i64.eq(a.syncDatabaseId,c[9])}).next().then(function(a,b){b=a.done;a=a.value;return b?c[10]=!1:(a.item,c[10]=!0)})},function(d){return c[10]?b.resolve((c[17]=c[0].get("group_id"),c[0],d=[c[17],e,[0,4],e,!1],c[12]=d[0],c[13]=d[1],c[14]=d[2],c[15]=d[3],c[16]=d[4],d)):b.seq([function(d){return c[27]=b.i64.of_float(Date.now()),c[17]=c[0].get("min_time_to_sync_timestamp_ms"),c[0],c[18]=c[0].get("last_sync_request_timestamp_ms"),c[0],c[19]=c[0].get("can_ignore_timestamp"),c[0],c[19]&&a[1]||b.i64.ge(c[27],c[17])?b.seq([function(d){return a[1]?b.resolve(c[28]=[0,0]):b.seq([function(a){return c[29]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[29]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[30]=[0,0]:(b=a.item,c[30]=b.failureCount)})},function(a){return c[32]=b.i64.mul(b.i64.sub(b.i64.lsl_([0,1],b.i64.to_int32(b.i64.lt([0,15],c[30])?[0,15]:c[30])),[0,1]),[0,500]),c[33]=b.i64.sub(b.i64.add(c[18]==null?[0,0]:c[18],b.i64.lt(c[32],[0,3e4])?c[32]:[0,3e4]),c[27]),c[28]=b.i64.gt(c[33],[0,0])?c[33]:[0,0]}])},function(a){return c[20]=c[28]}]):b.resolve(c[20]=b.i64.sub(c[17],c[27]))},function(a){return c[21]=c[0].get("group_id"),c[0],b.i64.gt(c[20],[0,0])?b.seq([function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastDelayedRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return a=[c[21],c[20],[0,3],e,!1],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}]):b.seq([function(a){return b.fe(b.db.table(1).fetch([[[c[21]]]]),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return b.fe(b.ftr(b.db.table(3).fetch(),function(a){return b.i64.eq(a.syncDatabaseId,c[21])}),function(a){var c=a.update;a.item;return c({lastSyncRequestTimestampMs:b.i64.of_float(Date.now())})})},function(a){return c[28]=c[0].get("group_id"),c[0],c[29]=b.i64.random(),c[42]=b.i64.and_(b.i64.or_(b.i64.lsl_(b.i64.of_float(Date.now()),b.i64.to_int32([0,22])),b.i64.and_(c[29],[0,4194303])),[2147483647,4294967295]),b.db.table(3).fetch([[["",c[28]]]]).next().then(function(a,d){d=a.done;a=a.value;return d?b.db.table(3).add({syncDatabaseId:c[28],taskQueueName:"",failureCount:[0,0],lastSentTimestampMs:[0,0],lastSyncRequestTimestampMs:[0,0],epochId:c[42]}):(a.item,b.fe(b.db.table(3).fetch([[["",c[28]]]]),function(a){var b=a.update;a.item;return b({epochId:c[42]})}))})},function(a){return c[31]=c[0].get("group_id"),c[0],b.db.table(3).fetch([[["",c[31]]]]).next().then(function(a,b){var d=a.done;a=a.value;return d?c[32]=[0,0]:(b=a.item,c[32]=b.failureCount)})},function(a){return c[34]=c[0].get("send_sync_params"),c[0],c[35]=c[0].get("sync_params"),c[0],c[36]=c[0].get("current_cursor"),c[0],c[37]=new b.Map(),c[37].set("database",c[31]),c[37].set("version",[-1,4294967295]),c[37].set("epoch_id",c[42]),c[37].set("last_applied_cursor",c[36]),c[37].set("sync_params",c[34]?c[35]:e),c[37].set("failure_count",b.i64.gt(c[32],[0,0])?c[32]:e),c[38]=c[0].get("current_cursor"),c[0],e===c[38]?c[39]=[0,1]:c[39]=[0,2],c[40]=new b.Map(),c[40].set("type",c[39]),c[40].set("request_payload",c[37]),c[41]=c[0].get("sync_channel"),c[0],a=[c[28],e,[0,1],c[40],b.i64.eq(c[41],[0,2])],c[22]=a[0],c[23]=a[1],c[24]=a[2],c[25]=a[3],c[26]=a[4],a}])},function(a){return a=[c[22],c[23],c[24],c[25],c[26]],c[12]=a[0],c[13]=a[1],c[14]=a[2],c[15]=a[3],c[16]=a[4],a}])},function(a){return a=[c[12],c[13],c[14],c[15],c[16]],c[3]=a[0],c[4]=a[1],c[5]=a[2],c[6]=a[3],c[7]=a[4],a}])},function(a){return c[8]=new b.Map(),c[8].set("sync_group_id",c[3]),c[8].set("next_sync_ms",c[4]),c[8].set("work_item_type",c[5]),c[8].set("network_payload",c[6]),c[8].set("skip_realtime_gateway",c[7]),d[0]=c[8]}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSBeginHandlingSync",["LSBeginHandlingSyncForSyncGroup"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1];c.n;var d=[],e=[];return c.seq([function(f){return c.seq([function(e){return d[0]=c.createArray(),c.fe(c.db.table(1).fetch(),function(e){var f=e.item;return c.seq([function(e){return c.sp(b("LSBeginHandlingSyncForSyncGroup"),f.groupId,a[0]).then(function(a){return a=a,d[1]=a[0],a})},function(a){return d[2]=(d[0].push(d[1]),d[0])}])})},function(a){return e[0]=d[0]}])},function(a){return c.resolve(e)}])}e.exports=a}),null);
__d("LSHandleTaskSendFailureForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d=[],e;return b.seq([function(d){return b.seq([function(d){return b.islc(b.ftr(b.db.table(2).fetch(),function(b){return a[0]===b.queueName}),0,b.i64.to_float([0,1])).next().then(function(a,d){var f=a.done;a=a.value;return f?0:(d=a.item,b.ftr(b.db.table(2).fetch(),function(a){return b.i64.eq(a.taskId,d.taskId)}).next().then(function(d,f){var a=d.done;d=d.value;return a?0:(f=d.item,b.i64.neq(e,e)?c[1]=b.i64.add(b.i64.of_float(Date.now()),e):c[1]=f.minTimeToSyncTimestampMs,b.fe(b.ftr(b.db.table(2).fetch(),function(a){return b.i64.eq(a.taskId,f.taskId)}),function(a){var d=a.update;a.item;return d({failureCount:b.i64.add(f.failureCount,[0,1]),minTimeToSyncTimestampMs:c[1]})}))}))})},function(c){return b.fe(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(a){var c=a.update;a=a.item;return c({failureCount:b.i64.add(a.failureCount,[0,1])})})},function(c){return b.fe(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(a){var b=a.update;a.item;return b({epochId:e,networkTaskIdentifier:e})})}])},function(a){return b.resolve(d)}])}e.exports=a}),null);
__d("LSHandleTaskSendSuccessForQueue",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[],d;return b.seq([function(c){return b.fe(b.ftr(b.db.table(3).fetch([[[a[0],[-1,4294967295]]]]),function(c){return c.taskQueueName===a[0]&&b.i64.eq(c.syncDatabaseId,[-1,4294967295])&&!b.i64.eq(c.epochId,d)}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("LSRemoveError",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1];b.n;var c=[];return b.seq([function(c){return b.fe(b.db.table(6).fetch([[[a[0]]]]),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}e.exports=a}),null);
__d("FriendingCometFriendRequestConfirmSubscription_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5016995998396308"}),null);
__d("FriendingCometFriendRequestConfirmSubscription.graphql",["CometTextWithEntitiesRelay_textWithEntities$normalization.graphql","FriendingCometFriendRequestConfirmSubscription_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"scale"}],c=[{kind:"Variable",name:"data",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"notif_id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"seen_state",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"time_confirmed",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},j={kind:"Variable",name:"scale",variableName:"scale"},k=[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FriendingCometFriendRequestConfirmSubscription",selections:[{alias:null,args:c,concreteType:"FriendRequestConfirmSubscribeResponsePayload",kind:"LinkedField",name:"friend_request_confirm_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:[{kind:"Literal",name:"bookmarkID",value:"2356318349"}],kind:"FragmentSpread",name:"useTopTabBadgeCount_viewer"},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometNotificationsListItem_actor"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"new_friend",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"FriendingCometAcceptedFriendRequestsPanel_user"}],storageKey:null},{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[{args:[{kind:"Literal",name:"isToast",value:!0}],kind:"FragmentSpread",name:"CometNotificationsListItem_notification"},d,e,f,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:[g],storageKey:null}],storageKey:null},h],storageKey:null}],type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FriendingCometFriendRequestConfirmSubscription",selections:[{alias:null,args:c,concreteType:"FriendRequestConfirmSubscribeResponsePayload",kind:"LinkedField",name:"friend_request_confirm_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:[{items:[{kind:"Literal",name:"bookmark_ids.0",value:"2356318349"}],kind:"ListValue",name:"bookmark_ids"},{kind:"Literal",name:"environment",value:"COMET"},{kind:"Literal",name:"folder_id",value:"PRODUCT"},{kind:"Literal",name:"sections",value:["FACEBOOK_APP"]}],concreteType:"BookmarksConnection",kind:"LinkedField",name:"bookmarks",plural:!1,selections:[{alias:null,args:null,concreteType:"BookmarksEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Bookmark",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bookmarked_node",plural:!1,selections:[i,e],storageKey:null},{alias:null,args:[{kind:"Literal",name:"bookmark_render_location",value:"COMET_TOP_TAB"}],kind:"ScalarField",name:"unread_count",storageKey:'unread_count(bookmark_render_location:"COMET_TOP_TAB")'},e],storageKey:null}],storageKey:null}],storageKey:'bookmarks(bookmark_ids:["2356318349"],environment:"COMET",folder_id:"PRODUCT",sections:["FACEBOOK_APP"])'},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[i,{kind:"TypeDiscriminator",abstractKey:"__isActor"},e],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"new_friend",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:60},j,{kind:"Literal",name:"width",value:60}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:k,storageKey:null},e],storageKey:null},{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[e,d,{alias:null,args:null,kind:"ScalarField",name:"notif_type",storageKey:null},f,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"notif_attachments",plural:!0,selections:[i,{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemFriendRequestAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"FriendRequestNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemInlineCTAAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"InlineCTACometNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemPageInviteAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"PageInviteNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemQuickPromotionAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"QuickPromotionNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"StructuredSurveySession",kind:"LinkedField",name:"inline_survey",plural:!1,selections:[i],storageKey:null}],type:"InlineSurveyNotifAttachment",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:[{args:null,fragment:b("CometTextWithEntitiesRelay_textWithEntities$normalization.graphql"),kind:"FragmentSpread"},g],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:56},j,{kind:"Literal",name:"width",value:56}],concreteType:"Image",kind:"LinkedField",name:"notif_image",plural:!1,selections:k,storageKey:null},{alias:null,args:[{kind:"Literal",name:"site",value:"comet"}],kind:"ScalarField",name:"url",storageKey:'url(site:"comet")'},{alias:"creation_time",args:null,concreteType:"CreationTimeWithRelativeText",kind:"LinkedField",name:"creation_time_with_relative_text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"GlyphIconData",kind:"LinkedField",name:"icon_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"reaction_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"glyph_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"glyph_icon_url",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tracking",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null}]}],storageKey:null},h],storageKey:null}]},params:{id:b("FriendingCometFriendRequestConfirmSubscription_facebookRelayOperation"),metadata:{subscriptionName:"friend_request_confirm_subscribe"},name:"FriendingCometFriendRequestConfirmSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("FriendingCometFriendRequestReceiveSubscription_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5076138372476811"}),null);
__d("FriendingCometFriendRequestReceiveSubscription.graphql",["CometTextWithEntitiesRelay_textWithEntities$normalization.graphql","FriendingCometFriendRequestReceiveSubscription_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"scale"}],c=[{kind:"Variable",name:"data",variableName:"input"}],d={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},e={alias:null,args:null,kind:"ScalarField",name:"friendship_status",storageKey:null},f={alias:null,args:null,kind:"ScalarField",name:"time_received",storageKey:null},g={alias:null,args:null,kind:"ScalarField",name:"notif_id",storageKey:null},h={alias:null,args:null,kind:"ScalarField",name:"seen_state",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null},j=[i],k={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},m={kind:"Variable",name:"scale",variableName:"scale"},n=[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],o={alias:null,args:[{kind:"Literal",name:"site",value:"comet"}],kind:"ScalarField",name:"url",storageKey:'url(site:"comet")'};return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FriendingCometFriendRequestReceiveSubscription",selections:[{alias:null,args:c,concreteType:"FriendRequestReceiveSubscribeResponsePayload",kind:"LinkedField",name:"friend_request_receive_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{args:[{kind:"Literal",name:"bookmarkID",value:"2356318349"}],kind:"FragmentSpread",name:"useTopTabBadgeCount_viewer"},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"CometNotificationsListItem_actor"}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"sender",plural:!1,selections:[d,e,{args:null,kind:"FragmentSpread",name:"FriendingCometFriendRequestsListItem_user"}],storageKey:null},f,{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[{args:[{kind:"Literal",name:"isToast",value:!0}],kind:"FragmentSpread",name:"CometNotificationsListItem_notification"},g,d,h,{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:j,storageKey:null}],storageKey:null}],storageKey:null}],type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FriendingCometFriendRequestReceiveSubscription",selections:[{alias:null,args:c,concreteType:"FriendRequestReceiveSubscribeResponsePayload",kind:"LinkedField",name:"friend_request_receive_subscribe",plural:!1,selections:[{alias:null,args:null,concreteType:"Viewer",kind:"LinkedField",name:"viewer",plural:!1,selections:[{alias:null,args:[{items:[{kind:"Literal",name:"bookmark_ids.0",value:"2356318349"}],kind:"ListValue",name:"bookmark_ids"},{kind:"Literal",name:"environment",value:"COMET"},{kind:"Literal",name:"folder_id",value:"PRODUCT"},{kind:"Literal",name:"sections",value:["FACEBOOK_APP"]}],concreteType:"BookmarksConnection",kind:"LinkedField",name:"bookmarks",plural:!1,selections:[{alias:null,args:null,concreteType:"BookmarksEdge",kind:"LinkedField",name:"edges",plural:!0,selections:[{alias:null,args:null,concreteType:"Bookmark",kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"bookmarked_node",plural:!1,selections:[k,d],storageKey:null},{alias:null,args:[{kind:"Literal",name:"bookmark_render_location",value:"COMET_TOP_TAB"}],kind:"ScalarField",name:"unread_count",storageKey:'unread_count(bookmark_render_location:"COMET_TOP_TAB")'},d],storageKey:null}],storageKey:null}],storageKey:'bookmarks(bookmark_ids:["2356318349"],environment:"COMET",folder_id:"PRODUCT",sections:["FACEBOOK_APP"])'},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"actor",plural:!1,selections:[k,{kind:"TypeDiscriminator",abstractKey:"__isActor"},d],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"sender",plural:!1,selections:[d,e,l,{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:60},m,{kind:"Literal",name:"width",value:60}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:n,storageKey:null},{kind:"InlineFragment",selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"social_context",plural:!1,selections:j,storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"social_context_top_mutual_friends",plural:!0,selections:[d,l,o,{alias:null,args:[{kind:"Literal",name:"height",value:20},m,{kind:"Literal",name:"width",value:20}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:n,storageKey:null}],storageKey:null}],type:"User",abstractKey:null}],type:"FriendNode",abstractKey:"__isFriendNode"}],storageKey:null},f,{alias:null,args:null,concreteType:"Notification",kind:"LinkedField",name:"notif",plural:!1,selections:[d,g,{alias:null,args:null,kind:"ScalarField",name:"notif_type",storageKey:null},h,{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"notif_attachments",plural:!0,selections:[k,{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemFriendRequestAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"FriendRequestNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemInlineCTAAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"InlineCTACometNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemPageInviteAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"PageInviteNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometNotificationsListItemAttachment_notification",fragmentName:"CometNotificationsListItemQuickPromotionAttachment_notifAttachments",fragmentPropName:"notifAttachments",kind:"ModuleImport"}],type:"QuickPromotionNotifAttachment",abstractKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"StructuredSurveySession",kind:"LinkedField",name:"inline_survey",plural:!1,selections:[k],storageKey:null}],type:"InlineSurveyNotifAttachment",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"body",plural:!1,selections:[{args:null,fragment:b("CometTextWithEntitiesRelay_textWithEntities$normalization.graphql"),kind:"FragmentSpread"},i],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:56},m,{kind:"Literal",name:"width",value:56}],concreteType:"Image",kind:"LinkedField",name:"notif_image",plural:!1,selections:n,storageKey:null},o,{alias:"creation_time",args:null,concreteType:"CreationTimeWithRelativeText",kind:"LinkedField",name:"creation_time_with_relative_text",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"timestamp",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"GlyphIconData",kind:"LinkedField",name:"icon_data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"reaction_type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"glyph_name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"glyph_icon_url",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"tracking",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"is_hidden",storageKey:null}]}],storageKey:null}],storageKey:null}]},params:{id:b("FriendingCometFriendRequestReceiveSubscription_facebookRelayOperation"),metadata:{subscriptionName:"friend_request_receive_subscribe"},name:"FriendingCometFriendRequestReceiveSubscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("RTWebCometIncomingUnsupportedDialogNameQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5489160574491869"}),null);
__d("RTWebCometIncomingUnsupportedDialogNameQuery$Parameters",["RTWebCometIncomingUnsupportedDialogNameQuery_facebookRelayOperation"],(function(a,b,c,d,e,f){"use strict";a={kind:"PreloadableConcreteRequest",params:{id:b("RTWebCometIncomingUnsupportedDialogNameQuery_facebookRelayOperation"),metadata:{},name:"RTWebCometIncomingUnsupportedDialogNameQuery",operationKind:"query",text:null}};e.exports=a}),null);
__d("CometJSSemPixelsContainerQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="3754744094621167"}),null);
__d("CometJSSemPixelsContainerQuery.graphql",["CometJSSemPixelsContainerQuery_facebookRelayOperation","relay-runtime"],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,concreteType:"SEMUniversalPixel",kind:"LinkedField",name:"sem_universal_pixels",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometJSSemPixelsContainerQuery",selections:a,type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"CometJSSemPixelsContainerQuery",selections:a},params:{id:b("CometJSSemPixelsContainerQuery_facebookRelayOperation"),metadata:{},name:"CometJSSemPixelsContainerQuery",operationKind:"query",text:null}}}();b("relay-runtime").PreloadableQueryRegistry.set(a.params.id,a);e.exports=a}),null);
__d("FBRTCConstants",["$InternalEnum","keyMirror"],(function(a,b,c,d,e,f,g){var h=Object.freeze({OFFER:"offer",ANSWER:"answer",ICE_CANDIDATE:"ice_candidate",OK:"ok",PING:"ping",PING_ACK:"ping_ack",HANGUP:"hang_up",OTHER_DISMISS:"other_dismiss",MSG_ACK:"msg_ack",PRANSWER:"pranswer",ICERESTART_OFFER:"icerestart_offer",ICERESTART_ANSWER:"icerestart_answer",PCRESTART_OFFER:"pcrestart_offer",PCRESTART_ANSWER:"pcrestart_answer",SDP_UPDATE:"sdp_update",OFFER_ACK:"offer_ack",OFFER_NACK:"offer_nack",ANSWER_ACK:"answer_ack",SET_VIDEO:"set_video",VIDEO_REQUEST:"video_request",ACK:"ack",SWITCH_TO_MULTIWAY:"switch_to_multiway",CLIENT_REPORTED_EVENT:"client_reported_event"}),i=Object.freeze({CHILD_WINDOW_READY:"rtc_child_window_ready",CHILD_WINDOW_START_CALL:"rtc_child_window_start_call",CHILD_WINDOW_MESSAGE:"rtc_child_window_message"}),j=Object.freeze({DIRECT_VIDEO:"direct_video",ESCALATED:"escalated",ESCALATION_DECLINED:"escalation_declined",VOIP:"voip"}),k=Object.freeze({LL_NIL:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5});b=b("$InternalEnum").Mirrored(["SCREEN","CAMERA"]);var l=Object.freeze({AUDIO_ONLY:"audio_only",AUDIO_VIDEO:"audio_video",SCREEN_CONTENT:"screen"}),m=Object.freeze({CUSTOM_VIDEO_STREAM_SIZE:"CUSTOM_VIDEO_STREAM_SIZE",CUSTOM_VIDEO:"CUSTOM_VIDEO",FHD_VIDEO:"FHD_VIDEO",HD_VIDEO:"HD_VIDEO",LQ_VIDEO:"LQ_VIDEO",SD_VIDEO:"SD_VIDEO",HD_IDEAL_LQ_REQUIRED_VIDEO:"HD_IDEAL_LQ_REQUIRED_VIDEO",FHD_IDEAL_LQ_REQUIRED_VIDEO:"FHD_IDEAL_LQ_REQUIRED_VIDEO"}),n=Object.freeze({FHD_HEIGHT:1080,HD_HEIGHT:720,LQ_HEIGHT:180,SD_HEIGHT:480,FHD_WIDTH:1920,HD_WIDTH:1280,LQ_WIDTH:320,SD_WIDTH:848,VLQ_FRAME_RATE:5,LQ_FRAME_RATE:15,FRAME_RATE:30}),o=Object.freeze({UNKNOWN:-1,IGNORE_CALL:0,HANGUP_CALL:1,IN_ANOTHER_CALL:2,ACCEPT_AFTER_HANGUP:3,NO_ANSWER_TIMEOUT:4,INCOMING_TIMEOUT:5,OTHER_INSTANCE_HANDLED:6,SIGNALING_MESSAGE_FAILED:7,CONNECTION_DROPPED:8,CLIENT_INTERRUPTED:9,WEBRTC_ERROR:10,CLIENT_ERROR:11,NO_PERMISSION:12,OTHER_NOT_CAPABLE:13,NO_UI_ERROR:14,UNSUPPORTED_VERSION:15,CALLER_NOT_VISIBLE:16,CARRIER_BLOCKED:17,OTHER_CARRIER_BLOCKED:18,CLIENT_ENCRYPTION_ERROR:19,INACTIVE_TIMEOUT:20,KILLED:21,TX_ACK_TIMEOUT:22}),p=["IgnoreCall","HangupCall","InAnotherCall","CallEndAcceptAfterHangUp","NoAnswerTimeout","IncomingTimeout","OtherInstanceHandled","SignalingMessageFailed","ConnectionDropped","ClientInterrupted","WebRTCError","ClientError","NoPermission","OtherNotCapable","NoUIShown","VersionUnsupported","CallerNotVisible","CarrierBlocked","OtherCarrierBlocked","ClientEncryptionError","InactiveTimeout","Killed","TxAckTimeout"],q=Object.freeze({CALL_INITIALIZATION_FAILED:"CollabCallInitializationFailed",CLOSED_AS_STALE:"CollabClosedAsStale",CLOSED_BY_MCU:"CollabClosedByMcu",INVALID_MEETING_ID:"CollabInvalidMeetingId",LOST_MCU_CONNECTION:"CollabLostMcuConnection",LOST_MCU_THRIFT_CONNECTION:"CollabLostMcuThriftConnection",LOST_SIP_ADAPTER_CONNECTION:"CollabLostSipAdapterConnection",MCU_INVALID_STREAM_CONFIGURATION:"CollabMcuInvalidStreamConfiguration",MCU_NO_AUDIO_STREAM:"CollabMcuNoAudioStream",REMOTE_PEER_HANGUP:"CollabRemotePeerHangup",REMOTE_PEER_REJECT:"CollabRemotePeerReject",SIP_CONNECTION_INITIALIZATION_FAILED:"CollabSipConnectionInitializationFailed",AUDIO_ONLY_DISALLOWED:"CollabAudioOnlyDisallowed",UNKNOWN:"CollabUnknown",KILLED_VIA_THRIFT_API:"CollabKilledViaThriftApi"}),r=Object.freeze({TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10}),s=Object.freeze({ONE_HOUR:"1hour",UNTIL_EIGHT_AM:"8am",ALWAYS:"always"});c=c("keyMirror")({AUDIO:null,VIDEO:null});var t=Object.freeze({CUSTOM:"custom",MULTIWAY:"multiway",P2P:"p2p"}),u=Object.freeze({DOMINANT_SPEAKER:"DOMINANT_SPEAKER",GRID:"GRID"}),v=Object.freeze({LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"}),w=Object.freeze({UNKNOWN:0,MEDIA_CONNECTED:1}),x=Object.freeze({PLAN_B:"plan-b",UNIFIED_PLAN:"unified-plan"});function a(a){switch(a){case k.LL_DEBUG:return"d";case k.LL_BASIC:return"b";case k.LL_WARNING:return"w";case k.LL_INFO:return"i";case k.LL_VERBOSE:return"v";case k.LL_NIL:default:return null}}function d(a){switch(a){case"d":return k.LL_DEBUG;case"b":return k.LL_BASIC;case"w":return k.LL_WARNING;case"i":return k.LL_INFO;case"v":return k.LL_VERBOSE;default:return k.LL_NIL}}function e(a){switch(a){case k.LL_BASIC:return"basic";case k.LL_DEBUG:return"debug";case k.LL_WARNING:return"warning";case k.LL_INFO:return"info";case k.LL_VERBOSE:return"verbose";default:return""}}function f(a){return p.indexOf(a)}function y(a){a=p[a];return!a?"Unknown":a}function z(a,b){return y(a)+"_"+(b?"remote":"local")}g.PayloadType=h;g.ChildWindowMessageType=i;g.CallType=j;g.UploadLogLevel=k;g.MediaContentTypes=b;g.StreamType=l;g.VideoQuality=m;g.RTCConstraints=n;g.CallEndReason=o;g.CollabCallEndSubreason=q;g.UIEventType=r;g.CallBlockingConstants=s;g.IncomingCallDialogTypes=c;g.SignalingProtocol=t;g.GroupVideoViewLayout=u;g.Orientation=v;g.ClientReportedEventType=w;g.SDPSemantics=x;g.convertFromUploadLogLevel=a;g.convertToUploadLogLevel=d;g.uploadLogLevelString=e;g.endCallReasonFromString=f;g.callEndReasonString=y;g.fullCallEndReasonString=z}),98);
__d("FBRTCLocalUploadLogLevel",["CurrentUser","FBRTCConstants"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return Math.max(h(),a)}function h(){return c("CurrentUser").isEmployee()||c("CurrentUser").isTestUser()?d("FBRTCConstants").UploadLogLevel.LL_DEBUG:d("FBRTCConstants").UploadLogLevel.LL_NIL}g.getUploadLogLevel=a;g.getLocalUploadLogLevel=h}),98);
__d("logCometTopNavTabPress",["CometHomeProductBadgedNavigationLogger","logCometWatchTabSelectedEvent"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,e){e!=null&&b!=null&&b>0&&d("CometHomeProductBadgedNavigationLogger").markerStartAndAnnotateWithProductID(e);switch(a){case"watch":c("logCometWatchTabSelectedEvent")("tab",b>0,"tab");break;default:break}}g["default"]=a}),98);
__d("CometObjectFitContainerWithMaxHeight.react",["CometObjectFitContainer.react","react","useCometSize_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.contentAspectRatio,d=a.maxHeight;a=babelHelpers.objectWithoutPropertiesLoose(a,["contentAspectRatio","maxHeight"]);var e=c("useCometSize_DO_NOT_USE")(),f=e[0];e=e[1];var g=16/9;b=b!=null&&isFinite(b)&&b>0?b:g;if(d!=null&&d>0&&e!=null){g=e.width/b;g>d&&(b=e.width/d)}return h.jsx(c("CometObjectFitContainer.react"),babelHelpers["extends"]({contentAspectRatio:b,objectFitMode:"CONTAINER_WIDTH_BASED_ASPECT_RATIO",ref:f},a))}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("FriendingCometFriendRequestConfirmSubscription",["CometRelay","FriendingCometFriendRequestConfirmSubscription.graphql","WebPixelRatio","cr:1723177","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("FriendingCometFriendRequestConfirmSubscription.graphql");function a(a,c,e,f,g,h){var j=function(a){var b=a.getRootField("friend_request_confirm_subscribe");if(b==null)return;var c=a.get(d("relay-runtime").VIEWER_ID);if(c==null)return;var e=b.getLinkedRecord("new_friend");if(e==null)return;b=b.getValue("time_confirmed");c=d("relay-runtime").ConnectionHandler.getConnection(c,"FriendingCometAcceptedFriendRequestsPanel_friend_confirmed_notifications");if(c==null)return;a=d("relay-runtime").ConnectionHandler.createEdge(a,c,e,"FriendConfirmedNotificationsEdge");a.setValue(b,"time_sent");d("relay-runtime").ConnectionHandler.insertEdgeBefore(c,a);e=parseInt(c.getValue("count"),0);c.setValue(e+1,"count")},k=function(a){a!=null&&b("cr:1723177")!=null&&f!==!0&&b("cr:1723177").pushFriendingConfirmedCometToast(a,e)};return d("CometRelay").requestSubscription(c,{onCompleted:g,onError:h,onNext:k,subscription:i,updater:j,variables:{input:{requester_id:a},scale:d("WebPixelRatio").get()}})}g.subscribe=a}),98);
__d("FriendingCometFriendRequestReceiveSubscription",["CometRelay","FriendingCometFriendRequestReceiveSubscription.graphql","WebPixelRatio","cr:1723177","relay-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h!==void 0?h:h=b("FriendingCometFriendRequestReceiveSubscription.graphql");function a(a,c,e,f,g,h){var j=function(a){var b=a.getRootField("friend_request_receive_subscribe");if(b==null)return;var c=a.get(d("relay-runtime").VIEWER_ID);if(c==null)return;var e=b.getLinkedRecord("sender");if(e==null)return;b=b.getValue("time_received");c=d("relay-runtime").ConnectionHandler.getConnection(c,"FriendingCometFriendRequestsPanel_friending_possibilities",{friending_channel:"REQUESTS_JEWEL"});if(c==null)return;var f=c.getLinkedRecords("edges");if(f!=null){f=f==null?void 0:f.filter(function(a){a=a==null?void 0:a.getLinkedRecord("node");return(a==null?void 0:a.getValue("id"))!==e.getValue("id")});c.setLinkedRecords(f,"edges");c.setValue(f.length,"count")}f=d("relay-runtime").ConnectionHandler.createEdge(a,c,e,"FriendingPossibilitiesEdge");f.setValue(b,"time");f.setValue(!1,"is_seen");d("relay-runtime").ConnectionHandler.insertEdgeBefore(c,f);a=parseInt(c.getValue("count"),10);c.setValue(a+1,"count")},k=function(a){a!=null&&b("cr:1723177")!=null&&f!==!0&&b("cr:1723177").pushFriendingCometToast(a,e)};return d("CometRelay").requestSubscription(c,{onCompleted:g,onError:h,onNext:k,subscription:i,updater:j,variables:{input:{receiver_id:a},scale:d("WebPixelRatio").get()}})}g.subscribe=a}),98);
__d("SketchBase",["Alea","Base64","Promise","md5","performanceNow","regeneratorRuntime","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h=10,i=16,j=function(){return new(b("Promise"))(function(a){c("setTimeout")(a)})},k=function(){function a(a,b,d){this.seed=a,this.rounds=b,this.rng=c("Alea")(a),this.ctx=d.getContext("2d"),this.width=d.width,this.height=d.height}var d=a.prototype;d.solveAllRoundsAsync=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=Date.now()+h,d=0;case 2:if(!(d<this.rounds)){e.next=11;break}a(d);if(!(Date.now()>c)){e.next=8;break}e.next=7;return b("regeneratorRuntime").awrap(j());case 7:c=Date.now()+h;case 8:d++;e.next=2;break;case 11:case"end":return e.stop()}},null,this)};d.solveAsync=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(this.solveAllRoundsAsync(this.pickPrimitiveAndDraw.bind(this)));case 2:case"end":return a.stop()}},null,this)};d.solveOnePrimitiveAsync=function(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.solveAllRoundsAsync(this.getDrawFunction(a)));case 2:case"end":return c.stop()}},null,this)};d.getDrawFunction=function(a){switch(a){case"text":return this.drawText.bind(this);case"bezier":return this.drawBezier.bind(this);case"circle":return this.drawCircle.bind(this);case"emoji":return this.drawEmoji.bind(this);default:return function(){return void 0}}};d.pickPrimitive=function(a){var b=["emoji","circle","bezier","text"];return b[a%b.length]};d.pickPrimitiveAndDraw=function(a){a=this.getDrawFunction(this.pickPrimitive(a));a()};d.drawText=function(){var a=Math.floor(this.rng()*50+100);this.ctx.font=a+"px Arial";var b=Math.floor(this.rng()*100).toString(),c=Math.floor(this.rng()*this.width/2);a=this.rngRange(a*2,this.height-a);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fillText(b,c,a)};d.drawEmoji=function(){var a=Math.floor(this.rng()*50+100);this.ctx.font=a+"px Arial";var b="\ud83d\ude03",c=Math.floor(this.rng()*this.width/2);a=this.rngRange(a*2,this.height-a);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fillText(b,c,a)};d.drawBezier=function(){this.ctx.beginPath();var a=this.rng()*this.width,b=this.rng()*this.height,c=this.rng()*this.width,d=this.rng()*this.height,e=this.rng()*this.width,f=this.rng()*this.height;this.ctx.moveTo(a,b);this.ctx.bezierCurveTo(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width,this.rng()*this.height,c,d);this.ctx.bezierCurveTo(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width,this.rng()*this.height,e,f);this.ctx.bezierCurveTo(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width,this.rng()*this.height,a,b);this.ctx.fillStyle=this.makeRadialGradient();this.applyShadow();this.ctx.fill()};d.drawCircle=function(){this.ctx.beginPath(),this.ctx.arc(this.rng()*this.width,this.rng()*this.height,this.rng()*this.width/5,0,2*Math.PI),this.ctx.fillStyle=this.makeRadialGradient(),this.applyShadow(),this.ctx.fill(),this.ctx.lineWidth=2,this.ctx.strokeStyle=this.makeRadialGradient(),this.ctx.stroke()};d.makeRadialGradient=function(){var a=this.ctx.createRadialGradient(this.rng()*this.width,this.rng()*this.height,0,this.rng()*this.width,this.rng()*this.height,this.width*2);a.addColorStop(0,this.makeColor());a.addColorStop(.5,this.makeColor());a.addColorStop(1,this.makeColor());return a};d.makeColor=function(){var a=Math.floor(this.rng()*255),b=Math.floor(this.rng()*255),c=Math.floor(this.rng()*255);return"rgb("+a+","+b+","+c+")"};d.applyShadow=function(){this.ctx.shadowColor=this.makeColor(),this.ctx.shadowBlur=this.rng()*50,this.ctx.shadowOffsetX=this.rng()*15,this.ctx.shadowOffsetY=this.rng()*15};d.rngRange=function(a,b){var c=Math.min(a,b);a=Math.max(a,b);return this.rng()*(a-c)+c};return a}();function a(a,c,d){var e,f,g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:e=document.createElement("canvas");e.width=200;e.height=200;e.style.display="none";f={hash:"",hash_bezier:"",hash_circle:"",hash_emoji:"",hash_text:"",hash2:"",rounds:d,seed:a,seed2:c,time_taken:0};document.body&&document.body.appendChild(e);i.next=8;return b("regeneratorRuntime").awrap(m(e,a,d));case 8:g=i.sent;i.next=11;return b("regeneratorRuntime").awrap(m(e,c,d));case 11:h=i.sent;f.hash=g.hash;f.hash2=h.hash;f.time_taken=g.time_taken+h.time_taken;i.next=17;return b("regeneratorRuntime").awrap(n(e,a,d,"text"));case 17:f.hash_text=i.sent;i.next=20;return b("regeneratorRuntime").awrap(n(e,a,d,"bezier"));case 20:f.hash_bezier=i.sent;i.next=23;return b("regeneratorRuntime").awrap(n(e,a,d,"circle"));case 23:f.hash_circle=i.sent;i.next=26;return b("regeneratorRuntime").awrap(n(e,a,d,"emoji"));case 26:f.hash_emoji=i.sent;document.body&&document.body.removeChild(e);return i.abrupt("return",f);case 29:case"end":return i.stop()}},null,this)}function d(a){return c("Base64").encode(JSON.stringify(a))}function l(a){return new(b("Promise"))(function(b){c("setTimeout")(function(){b(c("md5")(a.toDataURL()))},i)})}function m(a,d,e){var f,g,h,i,j,m;return b("regeneratorRuntime").async(function(n){while(1)switch(n.prev=n.next){case 0:f=new k(d,e,a);f.ctx.clearRect(0,0,f.width,f.height);g=c("performanceNow")();n.next=5;return b("regeneratorRuntime").awrap(f.solveAsync());case 5:h=c("performanceNow")();i=parseInt((h-g)*1e3,10);n.next=9;return b("regeneratorRuntime").awrap(l(a));case 9:j=n.sent;m={hash:j,time_taken:i};return n.abrupt("return",m);case 12:case"end":return n.stop()}},null,this)}function n(a,c,d,e){var f,g;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:f=new k(c,d,a);f.ctx.clearRect(0,0,f.width,f.height);h.next=4;return b("regeneratorRuntime").awrap(f.solveOnePrimitiveAsync(e));case 4:h.next=6;return b("regeneratorRuntime").awrap(l(a));case 6:g=h.sent;return h.abrupt("return",g);case 8:case"end":return h.stop()}},null,this)}g.createCanvasAndSolveAllPrimitives=a;g.encode=d;g.getHash=l;g.solveAsync=m;g.solvePrimitive=n}),98);
__d("XSISketchResultsControllerRouteBuilder",["jsRouteBuilder"],(function(a,b,c,d,e,f,g){a=c("jsRouteBuilder")("/sketch_results/",Object.freeze({}),void 0);b=a;g["default"]=b}),98);
__d("SketchComet",["JSScheduler","SketchBase","XSISketchResultsControllerRouteBuilder","cometAsyncFetch","recoverableViolation","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a){c("recoverableViolation")("Sketch."+a+" called unexpectedly. This is not supported in Comet!","comet_infra")}var i={createCanvasAndSolve:function(a,c,e){var f,g,h,i;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:f=document.createElement("canvas");f.width=200;f.height=200;f.style.display="none";document.body&&document.body.appendChild(f);j.next=7;return b("regeneratorRuntime").awrap(d("SketchBase").solveAsync(f,a,e));case 7:g=j.sent;j.next=10;return b("regeneratorRuntime").awrap(d("SketchBase").solveAsync(f,c,e));case 10:h=j.sent;i={hash:g.hash,hash2:h.hash,rounds:e,seed:a,seed2:c,time_taken:g.time_taken+h.time_taken};document.body&&document.body.removeChild(f);return j.abrupt("return",i);case 14:case"end":return j.stop()}},null,this)},solveAllPrimitivesAndCallAsyncController:function(a,e,f){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(d("SketchBase").createCanvasAndSolveAllPrimitives(a,e,f));case 2:g=i.sent,d("JSScheduler").scheduleLoggingPriCallback(function(){h=d("SketchBase").encode(g),d("JSScheduler").scheduleLoggingPriCallback(function(){var a=c("XSISketchResultsControllerRouteBuilder").buildURL({});c("cometAsyncFetch")(a,{data:{skstamp:h},method:"POST",retryCount:2})})});case 4:case"end":return i.stop()}},null,this)},solveAndCallAsyncController:function(a,c,d){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:h("solveAndCallAsyncController");case 1:case"end":return a.stop()}},null,this)},solveAndEncode:function(a,c,e,f){var g,h;return b("regeneratorRuntime").async(function(j){while(1)switch(j.prev=j.next){case 0:j.next=2;return b("regeneratorRuntime").awrap(i.createCanvasAndSolve(a,c,e));case 2:g=j.sent;h=babelHelpers["extends"]({},g,{surface:f});return j.abrupt("return",d("SketchBase").encode(h));case 5:case"end":return j.stop()}},null,this)},solveAndUpdateForm:function(a,c,d,e){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:h("solveAndUpdateForm");case 1:case"end":return a.stop()}},null,this)},solveIntern:function(a,c,d,e){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:h("solveIntern");case 1:case"end":return a.stop()}},null,this)}};a=i;g["default"]=a}),98);
__d("MWChatOpenTabCount.bs",["MWChatStateV2.bs","MWChatStateV2MaxTabCount.bs","MWChatStateV2TabGroups.bs","bs_caml_option","useMWIsTopLevelRouteMediaViewerExperiment"],(function(a,b,c,d,e,f){"use strict";function a(a){a=b("MWChatStateV2.bs").useState(function(a){return a.tabs});var c=b("MWChatStateV2.bs").useState(function(a){return a.focusedTabId}),d=b("MWChatStateV2.bs").useState(function(a){return a.mediaViewerOpenWatermark}),e=b("MWChatStateV2MaxTabCount.bs").useHook(void 0),f=b("useMWIsTopLevelRouteMediaViewerExperiment")();f=f?d.mediaViewerOpenWatermark:void 0;d=b("MWChatStateV2TabGroups.bs").getTabGroups(b("bs_caml_option").some(f),a.tabs,c.focusedTabId,e);return d[0].length}f.useHook=a}),null);
__d("MWChatOpenTabCount.re",["MWChatOpenTabCount.bs"],(function(a,b,c,d,e,f){a=b("MWChatOpenTabCount.bs").useHook;f.useHook=a}),null);
__d("LSErrorHandler.bs",["ix","BaseToasterStateManager","CometToast.react","LS.bs","LSRemoveError","LSTransaction.bs","ReQL.bs","SortedAsyncIterable.bs","TetraIcon.react","bs_caml_option","bs_curry","fbicon","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||b("react"),j={contents:!1},k=b("BaseToasterStateManager").getInstance();function a(a){if(j.contents)return;j.contents=!0;var c=b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("user_visible_errors")),function(c,d){if(typeof d==="number")return;if(d.TAG!==0)return;var e=d._0,f={contents:void 0};f.contents=b("bs_caml_option").some(k.push(i.jsx(b("CometToast.react"),{onDismiss:function(c){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSRemoveError")(e.errorId,b("LS.bs").make(a))},"readWrite"),void 0,void 0);c=f.contents;if(c!==void 0){k.expire(b("bs_caml_option").valFromOption(c));return}},message:e.errorTitleText,icon:i.jsx(b("TetraIcon.react"),{icon:b("fbicon")._(g("502062"),20),color:"warning"})}),2750))});return function(a){j.contents=!1;return b("bs_curry")._1(c,void 0)}}f.subscribeToErrorTableAndShowToast=a}),null);
__d("LSAppState.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;f.background=a;f.foreground=c}),null);
__d("LSFireForgetLabel.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").zero;c=b("bs_caml_int64").one;d=[0,2];e=[0,3];b=[0,4];var g=[0,5],h=[0,6],i=[0,7],j=[0,8],k=[0,9],l=[0,10],m=[0,11],n=[0,99];f.test=a;f.presenceReport=c;f.availabilitySettings=d;f.typing=e;f.liveLocationDeprecated=b;f.liveLocation=g;f.markFolderSeen=h;f.secureTemplateClientEvent=i;f.sendPlatformReferral=j;f.liveLocationPing=k;f.generativeGroupRanking=l;f.coplayEndGame=m;f.debugLogDatascriptInternalUse=n}),null);
__d("MWPReportPresence.bs",["LS.bs","LSDict","LSFireForgetLabel.bs","LSIssueNewFireAndForgetTask","LSJson","LSTransaction.bs","MsgrPresenceUpdateFalcoEvent","bs_caml_int64","gkx","promiseDone","react","useReStore","uuid"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useReStore")();return h.useCallback(function(d){var e=b("uuid")();b("gkx")("6050")&&b("MsgrPresenceUpdateFalcoEvent").log(function(){return{event_type:"app_state_update",is_foregrounded:a===b("bs_caml_int64").one,client_request_id:e}});d=b("LSTransaction.bs").run(c,function(c){return b("LSIssueNewFireAndForgetTask")("presence",b("LSFireForgetLabel.bs").presenceReport,b("LSJson").stringify(new(b("LSDict"))([["app_state",a],["request_id",e]])),b("LS.bs").make(c))},"readWrite");b("promiseDone")(d,void 0,void 0)},[c,a])}f.useReportPresence=a}),null);
__d("MWPPresenceManager.bs",["LSAppState.bs","MWPReportPresence.bs","Run","bs_curry","react","useGlobalEventListener"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=h.useRef(0),d=b("MWPReportPresence.bs").useReportPresence(b("LSAppState.bs").foreground),e=b("MWPReportPresence.bs").useReportPresence(b("LSAppState.bs").background);a=h.useCallback(function(a){a=c.current;if(a){b("bs_curry")._1(d,void 0);c.current=0;return}},[d]);var f=h.useCallback(function(a){a=c.current;if(a)return;else{b("bs_curry")._1(e,void 0);c.current=1;return}},[e]);b("useGlobalEventListener")("focus",a,{});b("useGlobalEventListener")("blur",f,{});h.useEffect(function(){b("bs_curry")._1(d,void 0);var a=b("Run").onBeforeUnload(function(a){b("bs_curry")._1(e,void 0)},!1);return function(b){return a.remove()}},[d,e])}f.useWatchFocusChanges=a}),null);
__d("MWPSetupPresenceReporting.bs",["MWPPresenceManager.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){b("MWPPresenceManager.bs").useWatchFocusChanges(void 0);return null}c=a;f.make=c}),null);
__d("MWPSetupPresenceReporting.re",["MWPSetupPresenceReporting.bs"],(function(a,b,c,d,e,f){a=b("MWPSetupPresenceReporting.bs").make;f.make=a}),null);
__d("MWSetupPresenceReporting.react",["MWPSetupPresenceReporting.re"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=d("MWPSetupPresenceReporting.re").make}),98);
__d("MWV2ChatCloseTabs.bs",["MWChatStateActions.bs","MWChatStateV2.bs","MessengerWebEvent","MessengerWebEventsFalcoEvent.bs","bs_curry","react","useCometFeedNoRoutingNavigationEventLogger"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useCometFeedNoRoutingNavigationEventLogger")();a=b("MWChatStateV2.bs").useState(function(a){return a.tabs});var d=a.tabs,e=b("MWChatStateV2.bs").useDispatch(void 0);return h.useCallback(function(a){c(Date.now(),"","messenger");b("MessengerWebEventsFalcoEvent.bs").log(function(){return{event_name:b("MessengerWebEvent").CLOSE_ALL_CHAT_TABS}});var f=Date.now();return b("bs_curry")._1(e,Array.from(d.values()).flatMap(function(a){return b("MWChatStateActions.bs").closeTab(f,a.tabId)}))},[e,d,c])}f.useHook=a}),null);
__d("MWV2ChatCloseTabs.re",["MWV2ChatCloseTabs.bs"],(function(a,b,c,d,e,f){a=b("MWV2ChatCloseTabs.bs").useHook;f.useHook=a}),null);
__d("MWV2ChatMinimizeTabs.bs",["MWChatStateActions.bs","MWChatStateV2.bs","MWChatStateV2IsOpen.bs","MessengerWebEvent","MessengerWebEventsFalcoEvent.bs","bs_curry","react","useCometFeedNoRoutingNavigationEventLogger"],(function(a,b,c,d,e,f){"use strict";var g,h=g||b("react");function a(a){var c=b("useCometFeedNoRoutingNavigationEventLogger")();a=b("MWChatStateV2.bs").useState(function(a){return a.tabs});var d=a.tabs,e=b("MWChatStateV2.bs").useDispatch(void 0);return h.useCallback(function(a){c(Date.now(),"","messenger");b("MessengerWebEventsFalcoEvent.bs").log(function(){return{event_name:b("MessengerWebEvent").MINIMIZE_ALL_CHAT_TABS}});var f=Date.now();return b("bs_curry")._1(e,Array.from(d.values()).filter(function(a){return b("MWChatStateV2IsOpen.bs").isOpen(void 0,a)}).flatMap(function(a){return b("MWChatStateActions.bs").minimizeTab(f,a.tabId)}))},[e,d,c])}f.useHook=a}),null);
__d("MWV2ChatMinimizeTabs.re",["MWV2ChatMinimizeTabs.bs"],(function(a,b,c,d,e,f){a=b("MWV2ChatMinimizeTabs.bs").useHook;f.useHook=a}),null);
__d("MWV2ChatOptionsHeadPopover.react",["fbt","ix","CometMenu.react","CometMenuItem.react","MWV2ChatCloseTabs.re","MWV2ChatMinimizeTabs.re","fbicon","react"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=d("react");function a(a){var b=d("MWV2ChatCloseTabs.re").useHook(),e=d("MWV2ChatMinimizeTabs.re").useHook();return j.jsxs(c("CometMenu.react"),{withArrow:!0,children:[j.jsx(c("CometMenuItem.react"),{icon:d("fbicon")._(i("491584"),20),onClick:function(a){return b()},primaryText:h._(/*FBT_CALL*/"\u00cenchide toate conversa\u0163iile"/*FBT_CALL*/),testid:void 0}),a.hasOpenTabs&&j.jsx(c("CometMenuItem.react"),{icon:d("fbicon")._(i("518013"),20),onClick:function(a){return e()},primaryText:h._(/*FBT_CALL*/"Minimizeaz\u0103 conversa\u0163iile deschise"/*FBT_CALL*/),testid:void 0})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("LSDataScriptDirect.bs",["LS.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","bs_belt_Option","bs_caml_js_exceptions","bs_caml_option","bs_curry","bs_js_dict","createTrustedFunction","createTrustedScriptWithoutValidation_DO_NOT_USE","killswitch","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return b("bs_belt_Option").getExn(b("bs_js_dict").get(b("bs_belt_Option").getExn(b("bs_belt_Option").getExn(a).gk),c))}function h(a){var c=function(c,d){var e;return(e=b("bs_belt_Option")).getExn(b("bs_js_dict").get(e.getExn(b("bs_js_dict").get(e.getExn(e.getExn(a).qe),c)),d))};return{getBool:c,getString:c,getNumber:c}}function i(a,c){return b("bs_curry")._2(b("createTrustedFunction")(b("createTrustedScriptWithoutValidation_DO_NOT_USE")("gkx"),b("createTrustedScriptWithoutValidation_DO_NOT_USE")("qex"),b("createTrustedScriptWithoutValidation_DO_NOT_USE")("return "+c)),function(b){return g(a,b)},h(a))}function a(a){return function(c,d){var e=d.syncScript,f=c!==void 0?c:function(a){},g=b("killswitch")("MESSENGER_WEB_DISABLE_LS_EVAL")?function(a){return b("Promise").resolve(void 0)}:i(b("bs_belt_Option").map(d.experiments,function(a){return JSON.parse(a)}),e);return b("Promise.bs").$$catch(b("LSTransaction.bs").run(a,function(a){b("bs_curry")._1(f,void 0);return b("bs_curry")._1(g,b("LS.bs").make(a))},"readWrite"),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform","eval_datascript_failure");var c=a.RE_EXN_ID===b("Promise.bs").JsError?b("bs_caml_option").some(a._1):b("bs_caml_js_exceptions").caml_as_js_exn(a);if(c!==void 0){c=b("bs_caml_option").valFromOption(c);b("recoverableViolation")("Error executing sync script: "+b("bs_belt_Option").getWithDefault(c.message,""),"messenger_web_product",{error:b("bs_caml_option").some(c)})}throw a;return b("Promise").resolve(void 0)})}}f.makeGkx=g;f.makeQex=h;f.make=a}),null);
__d("LSDataTraceFlushDeferred.bs",["bs_curry","gkx","killswitch","requireDeferred"],(function(a,b,c,d,e,f){"use strict";var g=b("requireDeferred")("LSDataTraceFlush.bs").__setRef("LSDataTraceFlushDeferred.bs");function a(a){if(!b("killswitch")("MESSENGER_WEB_DATA_TRACE_ID")&&b("gkx")("1951030")){g.onReady(function(c){return b("bs_curry")._1(c.flushExpiredDataTraces,a)});return}}f.$LSDataTraceFlush$Deferred=g;f.watchForExpiredTraces=a}),null);
__d("LSClearEpochBeforeResumeSync.bs",["LSTransaction.bs","Promise","ReQL.bs","gkx","killswitch"],(function(a,b,c,d,e,f){"use strict";function a(a){if(!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174"))return b("LSTransaction.bs").run(a,function(a){var c;return(c=b("ReQL.bs")).toArray(c.mergeJoin(c.fromTableAscending(a.table("sync_groups")),c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(b){var c=b[1];b=b[0].currentCursor;if(b!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:c.failureCount,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return window.Promise.resolve(void 0)}))}).then(function(c){return b("ReQL.bs").toArray(b("ReQL.bs").filter(b("ReQL.bs").fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""})).then(function(c){return b("Promise").all(c.map(function(b){return a.table("network_requests").put({taskQueueName:b.taskQueueName,syncDatabaseId:b.syncDatabaseId,epochId:void 0,networkTaskIdentifier:b.networkTaskIdentifier,lastSentTimestampMs:b.lastSentTimestampMs,failureCount:b.failureCount,lastSyncRequestTimestampMs:b.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:b.lastDelayedRequestTimestampMs})}))})})},"readWrite").then(function(a){return b("Promise").resolve(void 0)});else return b("Promise").resolve(void 0)}f.call=a}),null);
__d("LSPlatformDevtoolsHelpers.bs",["CometDevToolsLightspeedEvents.bs","LSDict","bs_curry","bs_int64","cr:1489419"],(function(a,b,c,d,e,f){"use strict";function a(a){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").task,a.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return{status:"sending",queueName:a.queue_name,payload:a.payload,failureCount:a.failure_count,taskId:b("bs_int64").to_string(a.task_id),startTime:Date.now()}})])}function c(a){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").armadilloBridge,a])}function d(a,c){if(!(b("cr:1489419")==null))return b("bs_curry")._1(b("cr:1489419").sendMessageToDevTools,[b("CometDevToolsLightspeedEvents.bs").task,a.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return{status:"sent",queueName:a.queue_name,response:c,failureCount:a.failure_count,taskId:b("bs_int64").to_string(a.task_id),endTime:Date.now()}})])}function e(a){if(!(b("cr:1489419")==null)){b("bs_curry")._1(b("cr:1489419").registerStorage,a);return}}function g(a){if(b("cr:1489419")==null)return a;else return b("bs_curry")._1(b("cr:1489419").registerDatascriptExec,a)}f.$CometDevToolsLightspeedInterop$OR$null$requireCond=b("cr:1489419");f.recordTaskSending=a;f.recordBridgeUIEvent=c;f.recordTaskSent=d;f.registerDb=e;f.$CometDevToolsLightspeedInterop$requireCond=b("cr:1489419");f.evalWithDevtoolSupport=g}),null);
__d("LSPlatformGraphQLTransport.bs",["FBLogger","LS.bs","LSClientDependencies","LSLogHistory.bs","Promise","Promise.bs","RelayFBModuleLoader","bs_belt_Option","bs_caml_array","bs_caml_exceptions","bs_caml_int64","bs_caml_option","bs_int64","bs_js_dict"],(function(a,b,c,d,e,f){"use strict";var g=b("bs_caml_exceptions").create("LSPlatformGraphQLTransport.ServerError");b("LSClientDependencies");function h(a){if(a==null)return;var c=a.reduce(function(a,c){b("bs_js_dict").get(b("LS.bs").modules,b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(c.name)))===void 0&&a.push(c);return a},[]),d=b("Promise").all(c.map(function(a){return b("RelayFBModuleLoader").load(b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(a.value)))})).then(function(d){for(var e=0,a=d.length;e<a;++e)b("LS.bs").modules[b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(b("bs_caml_array").get(c,e).name))]=b("bs_caml_array").get(d,e)});for(var a=0,e=c.length;a<e;++a){var f=b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(b("bs_caml_array").get(c,a).name));b("LS.bs").modules[f]={load:function(a){return function(c){return d.then(function(c){return b("bs_js_dict").get(b("LS.bs").modules,a)})}}(f)}}}function a(a,c,d,e,f){return b("Promise.bs").$$catch(f(a,c,e,b("bs_caml_int64").to_int32(d)),function(a){if(a.RE_EXN_ID===b("Promise.bs").JsError){a=a._1;var c=a.message;b("LSLogHistory.bs").log("Error sending Graphql Request. Type: "+b("bs_int64").to_string(d)+" Message: "+(c!==void 0?c:"None"),"error");b("FBLogger")("messenger_web_product").catching(a).debug("Relay or Graphql Server error in LSPlatformGraphqlTransport")}throw{RE_EXN_ID:g,Error:new Error()}}).then(function(c){c=b("bs_belt_Option").getExn(c==null?void 0:b("bs_caml_option").some(c));var a=b("bs_belt_Option").getExn(b("bs_caml_option").nullable_to_opt(c.payload));h(c.dependencies);return[a,b("bs_caml_option").nullable_to_opt(c.experiments)]})}f.ServerError=g;f.publish=a}),null);
__d("LSPlatformHardcodedInitSync.bs",["IntlCurrentLocale","LSDatabaseType.bs","LSDict","LSJson","LSPlatformGraphQLTransport.bs","LSRequestType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","QPLUserFlow","ReQL.bs","bs_belt_Option","bs_caml_format","bs_caml_int64","bs_caml_option","bs_curry","qpl","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function g(a){return b("LSTransaction.bs").run(a,function(a){var c;return b("Promise").all([a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").mailbox,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:(c=b("bs_caml_int64")).zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0}),a.table("network_requests").put({taskQueueName:"",syncDatabaseId:b("LSDatabaseType.bs").contact,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:c.zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0})])},"readWrite").then(function(a){return b("Promise").resolve(void 0)})}function a(a,c,d){var e;b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_graphql","init_sync.success");b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_ls","init_sync.success");b("QPLUserFlow").addPoint(b("qpl")._(25305590,"1127"),"initial_sync_received",void 0);var f=b("bs_caml_int64").zero;return b("Promise.bs").$$catch(b("Promise").all([(e=b("ReQL.bs")).first(e.getKeyRange(e.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").mailbox,tl:0})),e.first(e.getKeyRange(e.fromTableAscending(d.table("sync_groups")),{hd:b("LSDatabaseType.bs").contact,tl:0}))]).then(function(c){var d,e=(d=b("bs_belt_Option")).mapWithDefault(c[0],void 0,function(a){return a.currentCursor});c=d.mapWithDefault(c[1],void 0,function(a){return a.currentCursor});var g=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").mailbox).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({scale:1,preview_height:200,preview_width:a.previewWidth,preview_height_large:400,preview_width_large:a.previewWidthLarge,full_height:200,snapshot_num_threads_per_page:a.numThreads,locale:b("IntlCurrentLocale").code}))).set("epoch_id",f).set("last_applied_cursor",e);d=new(b("LSDict"))().set("database",b("LSDatabaseType.bs").contact).set("version",b("bs_caml_format").caml_int64_of_string(a.schemaVersion)).set("sync_params",d.getExn(JSON.stringify({locale:b("IntlCurrentLocale").code}))).set("epoch_id",f).set("last_applied_cursor",c);return b("Promise").all([b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,0,b("bs_belt_Option").isSome(e)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(g),a.executeGraphQLLightSpeedRequest),b("LSPlatformGraphQLTransport.bs").publish(a.deviceId,1,b("bs_belt_Option").isSome(c)?b("LSRequestType.bs").resumeSync:b("LSRequestType.bs").initSync,b("LSJson").stringify(d),a.executeGraphQLLightSpeedRequest)])}).then(function(a){var d=a[1],e=d[1],f=d[0];d=a[0];return b("bs_curry")._2(c,void 0,{experiments:d[1],syncScript:d[0]}).then(function(a){return b("bs_curry")._2(c,void 0,{experiments:e,syncScript:f})})}).then(function(a){b("QPLUserFlow").endSuccess(b("qpl")._(25305590,"1127"),"success_with_init_sync")}),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("mw_ls","init_sync.fail");b("QPLUserFlow").endFailure(b("qpl")._(25305590,"1127"),"failure_during_init_sync",void 0);a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError||a.RE_EXN_ID!==b("Promise.bs").JsError||b("recoverableViolation")("Encountered an error while performining preloaded init sync request via graphql","messenger_web_product",{error:b("bs_caml_option").some(a._1)});return g(d)})}d={taskQueueName:"",syncDatabaseId:(c=b("bs_caml_int64")).zero,epochId:void 0,networkTaskIdentifier:void 0,lastSentTimestampMs:c.zero,failureCount:c.zero,lastSyncRequestTimestampMs:c.zero,lastDelayedRequestTimestampMs:void 0};f.defaultNetworkRequest=d;f.handlePreloadedSyncFailure=g;f.sendHardcodedInitSync=a}),null);
__d("LSPlatformRequestId.bs",[],(function(a,b,c,d,e,f){"use strict";var g={contents:2};function a(a){a=g.contents;g.contents=g.contents+1|0;return a}f.generate=a}),null);
__d("LSPlatformRequestScheduler.bs",["bs_curry","clearTimeout","setTimeout"],(function(a,b,c,d,e,f){"use strict";function a(a){return new Map()}function c(a,c,d,e){var f=a.get(d);f==null||b("clearTimeout")(f);f=b("setTimeout")(function(a){return b("bs_curry")._1(c,void 0)},e);a.set(d,f)}f.make=a;f.schedule=c}),null);
__d("LSTaskWorkItemType.bs",["bs_caml_int64"],(function(a,b,c,d,e,f){"use strict";a=b("bs_caml_int64").one;c=[0,2];d=[0,3];e=[0,4];b=[0,5];f.workItemTypeSendToServer=a;f.workItemTypeHandleNative=c;f.workItemTypeDelayHandling=d;f.workItemTypeNone=e;f.workItemTypeSendToServerFireAndForget=b}),null);
__d("LSPlatformSyncSystem.bs",["LS.bs","LSBeginHandlingSync","LSBeginHandlingSyncForSyncGroup","LSCookie.bs","LSDict","LSJson","LSLogHistory.bs","LSPlatformGraphQLTransport.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId.bs","LSPlatformRequestScheduler.bs","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Option","bs_caml","bs_caml_format","bs_caml_int64","bs_caml_obj","bs_caml_option","bs_curry","bs_int64","bs_js_dict","gkx","killswitch","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f,g){var h=function(a,c){return b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{hd:"",tl:{hd:c,tl:0}})).then(function(c){if(c!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:b("bs_caml_int64").add(c.failureCount,b("bs_caml_int64").one),lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return b("Promise").resolve(void 0)})},"readWrite")},i=b("LSPlatformRequestScheduler.bs").make(void 0),j=function(a,h,i){i=b("LSDict").shapeToRecord(i);var j=b("LSDict").shapeToRecord(i.request_payload),k=i.type,l=b("LSPlatformRequestId.bs").generate(void 0),m=b("LSJson").stringify(b("LSDict").fromObject({database:j.database,version:b("bs_caml_format").caml_int64_of_string(e),epoch_id:j.epoch_id,last_applied_cursor:j.last_applied_cursor,failure_count:j.failure_count,sync_params:j.sync_params}));if(h.skip_realtime_gateway)return b("LSPlatformGraphQLTransport.bs").publish(f,l,k,m,g).then(function(a){return b("bs_curry")._1(d,{experiments:a[1],syncScript:a[0]}).then(function(a){return b("Promise").resolve(void 0)})});else return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),{hd:h.sync_group_id,tl:0})).then(function(a){a=a!==void 0?a.syncChannel:b("LSSyncChannel.bs").mqtt;return b("bs_curry")._5(c.publish,a,void 0,l,k,m).then(function(a){return b("Promise").resolve(void 0)})})},k=function a(c,d){var e=function(d){return b("LSTransaction.bs").run(c,function(a){return b("LSBeginHandlingSyncForSyncGroup")(d,!1,b("LS.bs").make(a))},"readWrite").then(function(b){return a(c,b[0])})},f=function(a,c){return b("LSPlatformRequestScheduler.bs").schedule(i,function(c){b("promiseDone")(e(a),void 0,void 0)},b("bs_int64").to_string(a),b("bs_caml_int64").to_float(c))},g=b("LSDict").shapeToRecord(d);d=g.work_item_type;if(b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)||b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget)){var k=g.network_payload;if(k!==void 0)return b("Promise.bs").$$catch(j(c,g,b("bs_caml_option").valFromOption(k)),function(a){a.RE_EXN_ID===b("LSPlatformGraphQLTransport.bs").ServerError?b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_graphql_error"):a.RE_EXN_ID===b("Promise.bs").JsError?(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_js_error"),b("recoverableViolation")("Encountered an JS error while publishing a LS sync request","messenger_web_product",{error:b("bs_caml_option").some(a._1)})):a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").NotConnected?b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_timeout_or_disc"):(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","send_sync_request_other_error"),b("recoverableViolation")("Encountered an error while publishing a LS sync request with non JS error error","messenger_web_product"));return h(c,g.sync_group_id).then(function(a){return e(g.sync_group_id)})});else{b("recoverableViolation")("Expected networkpayload for sync request but didn't get any","messenger_web_product");return b("Promise").resolve(void 0)}}if(!b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling))if(b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeNone)||!b("bs_caml").i64_eq(d,b("LSTaskWorkItemType.bs").workItemTypeHandleNative))return b("Promise").resolve(void 0);else{b("recoverableViolation")("Native handling for sync group not implemented yet","messenger_web_product");return b("Promise").resolve(void 0)}k=g.next_sync_ms;if(k!==void 0){f(g.sync_group_id,k);return b("Promise").resolve(void 0)}else{b("recoverableViolation")("Expected delay for delayed sync request but didn't get any","messenger_web_product");return b("Promise").resolve(void 0)}},l=function(c){return b("Promise").all(c[0].map(function(b){return k(a,b)}))},m=function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingSync")(!1,b("LS.bs").make(a))},"readWrite").then(l),void 0,void 0)},n=function(){return b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,b){return m()})},o=function(){return c.subscribeToNonTaskResponses(function(a){b("promiseDone")(b("bs_curry")._1(d,{experiments:a.ex,syncScript:a.payload}),function(a){return m()},function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","handle_sync_response_failure"),a.RE_EXN_ID===b("Promise.bs").JsError?b("recoverableViolation")("Error encountered handling response from MQTT","messenger_web_product",{error:b("bs_caml_option").some(a._1)}):b("recoverableViolation")("Error encountered handling response from MQTT with unknown error","messenger_web_product")})})},p=function(a){var c=b("SortedAsyncIterable.bs").subscribe(b("ReQL.bs").fromTableAscending(a.table("sync_groups")),function(a,c){a=a.hd;var d=b("LSCookie.bs").get(void 0),e=d.c,f,g;if(typeof c==="number")f=1;else if(c.TAG===0){var h=c._0.currentCursor;h!==void 0?(g=h,f=2):f=1}else{h=c._0.currentCursor;h!==void 0?(g=h,f=2):f=1}switch(f){case 1:if(!b("bs_belt_Option").isSome(b("bs_js_dict").get(e,b("bs_int64").to_string(a))))return;b("bs_js_dict").unsafeDeleteKey(e,b("bs_int64").to_string(a));c=b("LSCookie.bs").writeCookie(d);b("promiseDone")(c,void 0,void 0);return;case 2:if(!b("bs_caml_obj").caml_notequal(b("bs_js_dict").get(e,b("bs_int64").to_string(a)),g))return;e[b("bs_int64").to_string(a)]=g;h=b("LSCookie.bs").writeCookie(d);b("promiseDone")(h,void 0,void 0);return}});return function(a){return b("bs_curry")._1(c,void 0)}},q=function(){return c.onReconnect(function(){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_sync","resume_sync_reconnect"),b("LSLogHistory.bs").log("LS Sync System reconnecting","debug"),b("promiseDone")(b("LSTransaction.bs").run(a,function(a){var c;return(c=b("ReQL.bs")).toArray(c.mergeJoin(c.fromTableAscending(a.table("sync_groups")),c.getKeyRange(c.fromTableAscending(a.table("network_requests")),{hd:"",tl:0}))).then(function(c){return b("Promise").all(c.map(function(b){var c=b[1];b=b[0].currentCursor;if(b!==void 0)return a.table("network_requests").put({taskQueueName:c.taskQueueName,syncDatabaseId:c.syncDatabaseId,epochId:void 0,networkTaskIdentifier:c.networkTaskIdentifier,lastSentTimestampMs:c.lastSentTimestampMs,failureCount:c.failureCount,lastSyncRequestTimestampMs:c.lastSyncRequestTimestampMs,lastDelayedRequestTimestampMs:c.lastDelayedRequestTimestampMs});else return window.Promise.resolve(void 0)}))}).then(function(c){return b("LSBeginHandlingSync")(!1,b("LS.bs").make(a))})},"readWrite").then(l),void 0,void 0)})},r=n(),s=o(),t=q(),u=!b("killswitch")("MESSENGER_WEB_PERSISTED_DB")&&b("gkx")("3174")?p(a):function(a){};m();return{cleanup:function(){var a;(a=b("bs_curry"))._1(r,void 0);a._1(t,void 0);a._1(s,void 0);return a._1(u,void 0)}}}f.make=a}),null);
__d("LSPlatformTaskSystem.bs",["LS.bs","LSBeginHandlingPendingTasks","LSBeginHandlingPendingTasksForQueue","LSDict","LSHandleTaskSendFailureForQueue","LSHandleTaskSendSuccessForQueue","LSJson","LSPlatformDevtoolsHelpers.bs","LSPlatformRealtimeTransport.bs","LSPlatformRequestId.bs","LSPlatformRequestScheduler.bs","LSRequestType.bs","LSSyncChannel.bs","LSTaskWorkItemType.bs","LSTransaction.bs","MWPBumpEntityKey.bs","Promise","Promise.bs","ReQL.bs","SortedAsyncIterable.bs","bs_belt_Array","bs_belt_Option","bs_caml","bs_caml_int64","bs_caml_option","bs_curry","bs_int64","gkx","promiseDone","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e){var f=b("LSPlatformRequestScheduler.bs").make(void 0),g=function(c){if(!b("gkx")("1951030"))return b("Promise").resolve(void 0);c=b("bs_belt_Option").map(c.network_payload,function(a){return b("LSDict").shapeToRecord(a)});if(c!==void 0)return b("bs_belt_Option").mapWithDefault(b("bs_belt_Array").get(c.tasks,0),b("Promise").resolve(void 0),function(c){c=b("LSDict").shapeToRecord(c).task_id;return b("ReQL.bs").first(b("ReQL.bs").getKeyRange(b("ReQL.bs").fromTableAscending(a.table("pending_tasks")),{hd:c,tl:0})).then(function(a){return b("Promise").resolve(a!==void 0?a.dataTraceId:void 0)})});else return b("Promise").resolve(void 0)},h=function(c){return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendFailureForQueue")(c,b("LS.bs").make(a))},"readWrite")},i=function j(i){var k=function(c,d){return b("LSPlatformRequestScheduler.bs").schedule(f,function(d){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingPendingTasksForQueue")(c,!1,b("LS.bs").make(a))},"readWrite").then(function(a){return j(b("LSDict").shapeToRecord(a[0]))}),void 0,void 0)},c,b("bs_caml_int64").to_float(d))},l=b("LSPlatformRequestId.bs").generate(void 0),m=b("bs_belt_Option").map(i.network_payload,function(a){return b("LSDict").shapeToRecord(a)}),n=i.work_item_type;if(m!==void 0){if(b("bs_caml").i64_eq(n,b("LSTaskWorkItemType.bs").workItemTypeSendToServer)){var o=m.epoch_id,p=m.tasks,q=i.queue_name;b("LSPlatformDevtoolsHelpers.bs").recordTaskSending(p);return b("Promise.bs").$$catch(g(i).then(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,q,l,b("LSRequestType.bs").taskBatch,b("LSJson").stringify(b("LSDict").fromObject({version_id:e,tasks:p,epoch_id:o,data_trace_id:a})))}).then(function(c){if(c){var e=c._0;return b("Promise.bs").$$catch(b("bs_curry")._1(d,{experiments:e.ex,syncScript:e.payload}).then(function(c){b("LSPlatformDevtoolsHelpers.bs").recordTaskSent(p,e.payload);return b("LSTransaction.bs").run(a,function(a){return b("LSHandleTaskSendSuccessForQueue")(q,b("LS.bs").make(a))},"readWrite")}),function(a){b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","handle_task_failure");a.RE_EXN_ID===b("Promise.bs").JsError?b("recoverableViolation")("Encountered an error while processing a task response via realtime transport","messenger_web_product",{error:b("bs_caml_option").some(a._1)}):b("recoverableViolation")("Encountered an error while processing a task response via realtime transport","messenger_web_product",{error:a});return h(q)})}b("recoverableViolation")("Expected a response for a non fire forget task","messenger_web_product");return b("Promise").resolve(void 0)}),function(a){a.RE_EXN_ID===b("Promise.bs").JsError?(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_timeout"),b("recoverableViolation")("Encountered an error while publishing a LS task payload via realtime transport","messenger_web_product",{error:b("bs_caml_option").some(a._1)})):a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").Timeout||a.RE_EXN_ID===b("LSPlatformRealtimeTransport.bs").NotConnected||(b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","send_fail_generic"),b("recoverableViolation")("Encountered an error while publishing a LS task payload via realtime transport","messenger_web_product",{error:a}));return h(q)})}if(b("bs_caml").i64_eq(n,b("LSTaskWorkItemType.bs").workItemTypeSendToServerFireAndForget))return b("Promise.bs").$$catch(b("Promise").all(m.tasks.map(function(a){return b("LSDict").shapeToRecord(a)}).map(function(a){return b("bs_curry")._5(c.publish,b("LSSyncChannel.bs").mqtt,void 0,l,b("LSRequestType.bs").fireForget,b("LSJson").stringify(b("LSDict").fromObject({label:a.label,payload:a.payload,version:e})))})).then(function(a){return b("Promise").resolve(void 0)}),function(a){return b("Promise").resolve(void 0)})}if(b("bs_caml").i64_eq(n,b("LSTaskWorkItemType.bs").workItemTypeDelayHandling)){k(i.queue_name,i.next_sync_ms);return b("Promise").resolve(void 0)}else if(b("bs_caml").i64_eq(n,b("LSTaskWorkItemType.bs").workItemTypeNone))return b("Promise").resolve(void 0);else if(b("bs_caml").i64_eq(n,b("LSTaskWorkItemType.bs").workItemTypeHandleNative)){b("recoverableViolation")("Native tasks not supported so far","messenger_web_product");return b("Promise").resolve(void 0)}else{b("recoverableViolation")("Unknown Task type of "+b("bs_int64").to_string(n),"messenger_web_product");return b("Promise").resolve(void 0)}},j=function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("LSBeginHandlingPendingTasks")(!1,b("LS.bs").make(a))},"readWrite").then(function(a){return b("Promise").all(a[0].map(function(a){return b("LSDict").shapeToRecord(a)}).map(i))}),void 0,void 0)},k=function(){var c,d={contents:!1},e=b("SortedAsyncIterable.bs").subscribe((c=b("ReQL.bs")).fromTableAscending(a.table("pending_tasks")),function(a,c){d.contents=!0;if(typeof c==="number"||c.TAG===0||!b("bs_caml").i64_gt(c._0.failureCount,b("bs_caml_int64").one))return;else return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","tasks_failure_count_gt_one")}),f=b("SortedAsyncIterable.bs").subscribe(c.fromTableAscending(a.table("pending_fire_and_forget_tasks")),function(a,b){return j()}),g=b("SortedAsyncIterable.bs").subscribe(c.filter(c.fromTableAscending(a.table("network_requests")),function(a){return a.taskQueueName!==""}),function(a,c){if(typeof c==="number"){d.contents=!0;return}else if(c.TAG===0||!b("bs_caml").i64_gt(c._0.failureCount,b("bs_caml_int64").one))return;else return b("MWPBumpEntityKey.bs").bumpEntityKeyWithAppId("lsplatform_tasks","network_failure_count_gt_one")}),h=a.subscribeToCommit(function(a){if(d.contents){d.contents=!1;return j()}});return function(){var a;(a=b("bs_curry"))._1(e,void 0);a._1(f,void 0);a._1(g,void 0);return a._1(h,void 0)}},l=function(){return c.onReconnect(function(){b("promiseDone")(b("LSTransaction.bs").run(a,function(a){return b("ReQL.bs").toArray(b("ReQL.bs").bounds(b("ReQL.bs").fromTableAscending(a.table("network_requests")),{NAME:"greaterThan",VAL:{hd:"",tl:0}})).then(function(c){return b("Promise").all(c.map(function(c){return b("LSHandleTaskSendFailureForQueue")(c.taskQueueName,b("LS.bs").make(a))}))})},"readWrite"),void 0,void 0)})},m=k(),n=l();j();return{cleanup:function(){m();return b("bs_curry")._1(n,void 0)}}}f.make=a}),null);
__d("LSPlatformClient.bs",["ExecutionEnvironment","LSClearEpochBeforeResumeSync.bs","LSDataTraceFlushDeferred.bs","LSJSInMemoryStorage.bs","LSPlatformDevtoolsHelpers.bs","LSPlatformHardcodedInitSync.bs","LSPlatformRealtimeTransport.bs","LSPlatformSyncSystem.bs","LSPlatformTaskSystem.bs","MPWLSDBCreateSchema.bs","Promise","bs_curry","cr:3238"],(function(a,b,c,d,e,f){"use strict";function a(a){var c={contents:0};if(b("ExecutionEnvironment").canUseDOM)return a.getDb().then(function(d){return b("bs_curry")._1(a.getEval,void 0).then(function(e){b("LSPlatformDevtoolsHelpers.bs").registerDb(d);var f=b("LSPlatformDevtoolsHelpers.bs").evalWithDevtoolSupport(b("bs_curry")._1(e.make,d));return b("LSClearEpochBeforeResumeSync.bs").call(d).then(function(c){return b("LSPlatformHardcodedInitSync.bs").sendHardcodedInitSync(a,f,d)}).then(function(e){e=function(e){e=c.contents;if(typeof e!=="number")return b("Promise").resolve(void 0);e=c.contents===1?b("LSClearEpochBeforeResumeSync.bs").call(d):b("Promise").resolve(void 0);return e.then(function(e){var g=b("LSPlatformRealtimeTransport.bs").make(a.realtimeUnderylingTransport,a.appId),h=b("LSPlatformTaskSystem.bs").make(d,g,function(a){return b("bs_curry")._2(f,void 0,a)},a.schemaVersion),i=b("LSPlatformSyncSystem.bs").make(d,g,function(a){return b("bs_curry")._2(f,void 0,a)},a.schemaVersion,a.deviceId,a.executeGraphQLLightSpeedRequest);e=function(a){h.cleanup(),i.cleanup(),g.cleanup(),c.contents=1};c.contents={_0:e,_1:g.onConnectionStatusChange}})};return b("Promise").resolve({start:e,cleanup:function(a){a=c.contents;if(typeof a==="number")return;else return b("bs_curry")._1(a._0,void 0)},db:d,onConnectionStatusChange:function(a){var b=c.contents;if(typeof b==="number")return;else return b._1(a)}})})})}).then(function(a){b("LSDataTraceFlushDeferred.bs").watchForExpiredTraces(a.db);b("cr:3238")==null||b("bs_curry")._1(b("cr:3238").listenForChangesToBackupState,a.db);return a});else return b("Promise").resolve({start:function(a){return b("Promise").resolve(void 0)},cleanup:function(a){},db:b("LSJSInMemoryStorage.bs").make(b("MPWLSDBCreateSchema.bs").metadata),onConnectionStatusChange:function(a){}})}f.$MWEncryptedBackupsListenForChangesToBackupStateInitPath$requireCond=b("cr:3238");f.make=a}),null);
__d("RTWebCometCallDialog.react",["CometControlledUserBlockingDialog.react","TetraButtonGroup.react","react","useCometUniqueID"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b,d=a.acceptIcon,e=a.acceptLabel,f=a.acceptTestid,g=a.body,i=a.declineLabel;i=i===void 0?null:i;var j=a.onClose;a=a.title;a=a===void 0?null:a;var k=function(){j(!0)},l=function(){j(!1)},m=c("useCometUniqueID")();return h.jsxs(c("CometControlledUserBlockingDialog.react"),{disableClosingWithMask:!0,labelledBy:m,onDismiss:l,title:(b=a)!=null?b:void 0,withCloseButton:!0,children:[h.jsx("div",{className:"dati1w0a f10w8fjw hv4rvrfc pybr56ya taijpn5t cbu4d94t",id:a==null?m:void 0,children:g}),h.jsx("div",{className:"a8nywdso ihqw7lf3 dflh9lhu jb3vyjys",children:h.jsx(c("TetraButtonGroup.react"),{align:"end",direction:"backward",primary:{icon:d,label:e,onPress:k,testid:f,type:"primary"},secondary:i!==null?{label:i,onPress:l,reduceEmphasis:!0}:null})})]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("RTWebCometCallMessageLayout.react",["CometEntityHeaderFacepile.react","CometImageIcon_DEPRECATED.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react"),i="/images/chat/webrtc/no_profile_pic.png";function a(a){var b=a.caller,d=a.mainMessage,e=a.participants;a=a.subMessage;var f=j(e);e=e.length>1;return h.jsxs("div",{className:"jifvfom9 btwxx1t3 j83agx80",children:[h.jsx(c("CometImageIcon_DEPRECATED.react"),{size:60,src:k(b),style:"circle"}),h.jsxs("div",{className:"gu00c43d taijpn5t cbu4d94t j83agx80",children:[h.jsx("div",{className:"qzhwtbm6 n3ffmt46 a5q79mjw oo9gr5id",children:d}),h.jsxs("div",{className:"linoseic e9vueds3 m9osqain",children:[e?h.jsx(c("CometEntityHeaderFacepile.react"),{profiles:f}):null,h.jsx("div",{children:a})]})]})]})}a.displayName=a.name+" [from "+f.id+"]";function j(a){return a.length>0?a.map(function(a){return{name:a.name,pictureURI:k(a),profileURL:"#",size:32}}):[]}function k(a){return(a=a.profilePictureUrl)!=null?a:i}g["default"]=a}),98);
__d("RTWebCometIncomingUnsupportedDialog.entrypoint",["JSResourceForInteraction","RTWebCometIncomingUnsupportedDialogNameQuery$Parameters"],(function(a,b,c,d,e,f,g){"use strict";a={getPreloadProps:function(a){a=a.id;return{queries:{queryReference:{parameters:b("RTWebCometIncomingUnsupportedDialogNameQuery$Parameters"),variables:{id:a}}}}},root:c("JSResourceForInteraction")("RTWebCometIncomingUnsupportedDialog.react").__setRef("RTWebCometIncomingUnsupportedDialog.entrypoint")};g["default"]=a}),98);
__d("RTWebUnsupportedUpsellDialogWrapper.react",["CometPlaceholder.react","RTWebCometIncomingUnsupportedDialog.entrypoint","RelayHooks","react","useCometRelayEntrypointContextualEnvironmentProvider"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");function a(a){var b=a.inviterID,e=a.onClose;a=a.threadType;var f=c("useCometRelayEntrypointContextualEnvironmentProvider")();f=d("RelayHooks").loadEntryPoint(f,c("RTWebCometIncomingUnsupportedDialog.entrypoint"),{id:b});return h.jsx(c("CometPlaceholder.react"),{fallback:null,children:h.jsx(d("RelayHooks").EntryPointContainer,{entryPointReference:f,props:{onClose:e,threadType:a}})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("useSearchCometGlobalTypeaheadInitializeDataSource",["CometRelay","CometSearchEventEmitterContext","SearchCometGlobalTypeaheadDataSource","qex","react","searchCometGlobalTypeahead.config","useSearchCometRecentSearchDataSource"],(function(a,b,c,d,e,f,g){"use strict";b=d("react");var h=b.useContext,i=b.useEffect;function a(){var a=d("CometRelay").useRelayEnvironment(),b=c("useSearchCometRecentSearchDataSource")({fetchSTS:Boolean(c("qex")._("1563")),filter:"all"}),e=c("SearchCometGlobalTypeaheadDataSource").getInstance({config:c("searchCometGlobalTypeahead.config"),recentDataSource:b,relayEnvironment:a});b=h(c("CometSearchEventEmitterContext"));var f=b.subscribeToClearGlobalRecentSearches,g=b.subscribeToRecentSearchEntryAdded;i(function(){return g(function(a){e.addRecentEntry(a)})},[e,g]);i(function(){return f(function(){e.clearRecentSearches()})},[e,f]);i(function(){e.bootstrap()},[e])}g["default"]=a}),98);
__d("SearchCometGlobalTypeaheadDataSourceLoader.react",["useSearchCometGlobalTypeaheadInitializeDataSource"],(function(a,b,c,d,e,f,g){"use strict";function a(){c("useSearchCometGlobalTypeaheadInitializeDataSource")();return null}g["default"]=a}),98);
__d("XRefererFrameController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/common/referer_frame.php",{})}),null);
__d("isWhatsAppBlogURI",[],(function(a,b,c,d,e,f){var g=new RegExp("^blog\\.whatsapp\\.com$","i"),h=["https"];function a(a){if(a.isEmpty()&&a.toString()!=="#")return!1;return!a.getDomain()&&!a.getProtocol()?!1:h.indexOf(a.getProtocol())!==-1&&g.test(a.getDomain())}f["default"]=a}),66);
__d("ControlledReferer",["Bootloader","CookieConsent","XRefererFrameController","getRequestConstUri","isInstagramURI","isMessengerDotComURI","isOculusDotComURI","isWhatsAppBlogURI","isWorkplaceDotComURI","justknobx","lowerFacebookDomain"],(function(a,b,c,d,e,f,g){function h(a,b,d){if(!c("CookieConsent").isThirdPartyIframeAllowed(a)){c("Bootloader").loadModules(["ODS"],function(a){a.bumpEntityKey(2966,"defer_cookies","block_controlled_referer_iframe")},"ControlledReferer");return}var e=!1;function f(){if(e)return;var c=a.contentWindow.location.pathname;if(c!=="/intern/common/referer_frame.php"&&c!=="/common/referer_frame.php"&&c!=="/common/referer_frame.php/")return;e=!0;a.contentWindow.document.body.style.margin=0;b()}var g;c("isMessengerDotComURI")(c("getRequestConstUri")())||c("justknobx")._("186")&&c("isInstagramURI")(c("getRequestConstUri")())||c("isWhatsAppBlogURI")(c("getRequestConstUri")())?g=c("XRefererFrameController").getURIBuilder().getURI().toString():c("isOculusDotComURI")(c("getRequestConstUri")())?g="/common/referer_frame.php":!c("lowerFacebookDomain").isValidDocumentDomain()?g="/intern/common/referer_frame.php":g=c("XRefererFrameController").getURIBuilder().getURI().toString();d==null&&c("isWorkplaceDotComURI")(c("getRequestConstUri")())&&(d="workplace");d&&(g+="?fb_source="+d);a.onload=f;a.src=g}function a(a,b,c){h(a,function(){a.contentWindow.document.body.innerHTML=b},c)}g.shouldUseFacebookReferer=h;g.useFacebookRefererHtml=a}),98);
__d("StaticContainer.react",["React"],(function(a,b,c,d,e,f,g){var h=d("React");a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.shouldComponentUpdate=function(a){return!!a.shouldUpdate};c.render=function(){var a=this.props.children;return a===null||a===!1?null:h.Children.only(a)};return b}(h.Component);g["default"]=a}),98);
__d("ControlledRefererIFrame.react",["ControlledReferer","ControlledRefererIFrameConfig","SecurePostMessage","StaticContainer.react","URI","react"],(function(a,b,c,d,e,f){"use strict";var g,h,i=g||b("react");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.mountFrameRef=function(a){this.frame=a};d.updateFrame=function(){var a=this,c=this.frame;if(!c)return;this.props.onBeforeFrameRender&&this.props.onBeforeFrameRender(this.props);b("ControlledReferer").shouldUseFacebookReferer(c,function(){var d=c.contentWindow.document;d.body.innerHTML='\n        <form method="GET" id="theform"></form>\n        '+b("ControlledRefererIFrameConfig").additional_markup+"\n      ";var e=new(h||(h=b("URI")))(a.props.src).qualify(),f=d.getElementById("theform");f.action=e.toString();e=e.getQueryData();for(var g in e)if(Object.prototype.hasOwnProperty.call(e,g)){var i=d.createElement("input");i.name=g;i.setAttribute("value",e[g]);i.autocomplete="off";i.type="hidden";f.appendChild(i)}d.body.innerHTML+='\n        <iframe\n          frameborder="0"\n          width="1"\n          height="1"\n          onload="document.getElementById(\'theform\').submit()"\n        />\n      ';a.props.onFrameRender&&a.props.onFrameRender(a.props)})};d.componentDidMount=function(){this.updateFrame()};d.componentDidUpdate=function(a){a.src!==this.props.src&&this.updateFrame()};d.UNSAFE_componentWillReceiveProps=function(a){var b=this.frame;b&&(a.width!==this.props.width||a.height!==this.props.height)&&(a.width!=null&&(b.width=""+a.width),a.height!=null&&(b.height=""+a.height))};d.render=function(){var a=this,c=this.props;c.src;c.onFrameRender;c.onBeforeFrameRender;c=babelHelpers.objectWithoutPropertiesLoose(c,["src","onFrameRender","onBeforeFrameRender"]);return i.jsx(b("StaticContainer.react"),{children:i.jsx("iframe",babelHelpers["extends"]({},c,{ref:function(b){return a.mountFrameRef(b)}}))})};d.postMessage=function(a,c){this.frame&&b("SecurePostMessage").sendMessageToSpecificOrigin(this.frame.contentWindow,a,c)};return c}(i.PureComponent);e.exports=a}),null);
__d("CometJSSemPixelsContainer.react",["CometJSSemPixelsContainerQuery.graphql","CometRelay","ControlledRefererIFrame.react","ODS","gkx","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react"),j=h!==void 0?h:h=b("CometJSSemPixelsContainerQuery.graphql");function k(a){d("ODS").bumpEntityKey(3423,"paid_ads.pixel",a)}function a(){var a=d("CometRelay").useLazyLoadQuery(j,{});if(a==null||a.sem_universal_pixels==null)return null;var b=c("gkx")("1763940");return i.jsx("div",{children:a.sem_universal_pixels.map(function(a){var d=a.name;return d==null||a.url==null?null:i.jsx(c("ControlledRefererIFrame.react"),{hidden:!0,onBeforeFrameRender:b?function(){return k("before_fire."+d)}:void 0,onFrameRender:b?function(){return k("after_fire."+d)}:void 0,src:a.url},a.url)})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("ZenonParentQPLLogProcessor",["QPLUserFlow","qpl","regeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){this.$1=a.callID}var d=a.prototype;d.processEvent=function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:b.t0=a.name;b.next=b.t0==="inviteReceived"?3:b.t0==="callEnded"?5:b.t0==="callAccepted"?7:b.t0==="inviteResponded"?9:b.t0==="popupOpened"?11:13;break;case 3:c("QPLUserFlow").start(c("qpl")._(64225282,"3408"),{instanceKey:+this.$1});return b.abrupt("break",13);case 5:c("QPLUserFlow").endCancel(c("qpl")._(64225282,"3408"),{instanceKey:+this.$1});return b.abrupt("break",13);case 7:c("QPLUserFlow").addPoint(c("qpl")._(64225282,"3408"),"call_accepted",{instanceKey:+this.$1});return b.abrupt("break",13);case 9:c("QPLUserFlow").addPoint(c("qpl")._(64225282,"3408"),"invite_responded",{instanceKey:+this.$1});return b.abrupt("break",13);case 11:c("QPLUserFlow").endSuccess(c("qpl")._(64225282,"3408"),{instanceKey:+this.$1});return b.abrupt("break",13);case 13:case"end":return b.stop()}},null,this)};return a}();g["default"]=a}),98);
__d("getBrowserGMTOffsetAdjustedForSkew",["DateConsts","FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b=d("DateConsts").MIN_PER_HOUR*d("DateConsts").HOUR_PER_DAY,e=new Date(),f=e.getTimezoneOffset();e=e.getTime()/d("DateConsts").MS_PER_SEC;var g=15;a=a-e;e=Math.round(a/(g*d("DateConsts").SEC_PER_MIN))*g;e!=0&&c("FBLogger")("TimezoneAutoset").info("Adjusting timezone offset for clock skew. Browser offset: %s. Raw skew %s. Rounded skew %s",f,a,e);g=Math.round(f+e)%b;g>12*d("DateConsts").MIN_PER_HOUR?g-=b:g<-14*d("DateConsts").MIN_PER_HOUR&&(g+=b);return g}g["default"]=a}),98);
__d("FBRTCConsoleLogger",["Log","LogHistory","cr:1112656","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h=null;a=function(){a.getInstance=function(){h||(h=new a());return h};function a(){this.$1=d("LogHistory").getInstance(a.MODULE_NAME)}var b=a.prototype;b.getLogHistory=function(){return this.$1};b.log=function(a,b,c,d,e){d===void 0&&(d="Console");e===void 0&&(e="DEBUG");e=" "+JSON.stringify({conferenceName:b,callID:c});this.$1.log(d||"Console",a+e);return this};return a}();a.MODULE_NAME="webrtc";g["default"]=a}),98);
__d("RTWebLoggingSharedInstance",["ChannelClientID"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$1=d("ChannelClientID").getID()}var b=a.prototype;b.getDeviceID=function(){return this.$1};return a}();b=new a();g["default"]=b}),98);
__d("RTWebUserActionLogger",["CurrentUser","FBRTCConsoleLogger","RTWebLoggingSharedInstance","RtcWebUserActionsDebugFalcoEvent","RtcWebUserActionsFalcoEvent","ZenonBrowsers","ZenonSDESKeyDetector","immutable","performanceNow","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(){this.$2=c("immutable").Map(),this.$3=new Set(),this.$4=new Set(),this.$5=c("RTWebLoggingSharedInstance").getDeviceID(),this.$6=this.$7(),this.clearCache()}var b=a.prototype;b.clearCache=function(){this.$1={callID:void 0,callType:void 0,mediaType:void 0,conferenceName:void 0,conferenceState:void 0}};b.logImpression=function(a){this.logEvent(babelHelpers["extends"]({eventName:"impression"},a))};b.logPreCallImpression=function(a){this.clearCache(),this.logImpression(a)};b.logPreCallClick=function(a){this.clearCache(),this.logClick(a)};b.logClick=function(a){this.logEvent(babelHelpers["extends"]({eventName:"tap"},a))};b.logError=function(a){this.logEvent(babelHelpers["extends"]({eventName:"error"},a))};b.startTimer=function(a){var b=c("performanceNow")();this.$2=this.$2.set(a,b);this.logCheckpoint({checkpoint:a+"_timerStart"});this.$8(a,{startTime:b})};b.logStopTimer=function(a){var b=a.checkpointName===void 0?a.timerName:a.checkpointName,c=a.event||{};c.timeElapsed=this.$9(a.timerName);this.logCheckpoint(babelHelpers["extends"]({checkpoint:b+"_timerEnd"},c));return c.timeElapsed};b.logCheckpoint=function(a){this.logEvent(babelHelpers["extends"]({eventName:"checkpoint"},a))};b.$10=function(a){return a==null};b.logEvent=function(a){if(c("ZenonSDESKeyDetector")(a))throw c("unrecoverableViolation")("RTWebUserActionLogger event contains SDES crypto key! This log entry must be removed!","rtc_www");var b=this.$1;b.callID=this.$10(a.callID)?b.callID:a.callID;b.callType=a.callType||b.callType;b.conferenceState=a.conferenceState||b.conferenceState;b.conferenceName=this.$10(a.conferenceName)?b.conferenceName:a.conferenceName;b.isCaller=a.isCaller==null?b.isCaller:a.isCaller;b.mediaType=a.mediaType||b.mediaType;this.$11(a,b);b=this.$12(a,b);this.$8(a.eventName,b)};b.$12=function(a,b){var d={call_type:b.callType,client_time:Date.now().toString(),device_id:this.$5,error_domain:a.errorDomain,error_type:a.errorType,component:a.component,conference_state:b.conferenceState,event:a.eventName,media_type:b.mediaType,page:this.$6,call_id:b.callID,conference_name:b.conferenceName,surface:a.surface,checkpoint:a.checkpoint,event_time_elapsed:(a=a.timeElapsed)==null?void 0:a.toString(),is_caller:b.isCaller,codebase_version:"Old Codebase"};c("RtcWebUserActionsFalcoEvent").log(function(){return d});return d};b.$11=function(a,b){var d={call_type:b.callType,client_time:Date.now().toString(),device_id:this.$5,error_domain:a.errorDomain,error_type:a.errorType,component:a.component,conference_state:b.conferenceState,event:a.eventName,media_type:b.mediaType,page:this.$6,call_id:b.callID,conference_name:b.conferenceName,surface:a.surface,checkpoint:a.checkpoint,event_time_elapsed:(a=a.timeElapsed)==null?void 0:a.toString(),is_caller:b.isCaller,codebase_version:"Old Codebase"};c("RtcWebUserActionsDebugFalcoEvent").log(function(){return d});return d};b.getCallType=function(a,b){b===void 0&&(b=!1);if(a==null)return null;if(a)return"mw";else if(b)return"escalated";else return"p2p"};b.getAudioVideoComponent=function(a){return a==null?null:a?"audio_button":"video_button"};b.getMediaType=function(a,b){b===void 0&&(b=!1);if(b)return"escalated";else if(a)return"audio";else return"video"};b.logErrorOnceforDomain=function(a,b){this.$3.has(a)||(this.$3.add(a),this.logError({errorDomain:a,errorType:b.toString()}))};b.logCheckpointOnceForDomain=function(a){var b=a.checkpoint;this.$4.has(b)||(this.$4.add(b),this.logCheckpoint(a))};b.clearLoggedDomains=function(){this.$3.clear(),this.$4.clear()};b.getWebLoggerInfoFromStore=function(a){a=a.callInfo;var b=a.callID,c=a.conferenceName;a=a.conferenceState;return{callID:b,conferenceName:c,conferenceState:a}};b.$7=function(){if(d("ZenonBrowsers").isMobileDevice())return"mweb";else if(c("CurrentUser").isWorkUser())return"workplace";var a=window.location.hostname;if(a.search("facebook")!==-1)return"facebook";else if(a.search("messenger")!==-1)return"messenger_dot_com";return a};b.$9=function(a){var b=this.$2.get(a);if(b){this.$2=this.$2.remove(a);return parseInt(c("performanceNow")()-b,10)}return null};b.$8=function(a,b){a=a==null?"null":a;c("FBRTCConsoleLogger").getInstance().getLogHistory().log(a,JSON.stringify(b))};return a}();b=new a();g["default"]=b}),98);
__d("FBRTCIceStatsParser",[],(function(a,b,c,d,e,f){var g=null;a=function(){function a(){}a.getInstance=function(){g||(g=new a());return g};var b=a.prototype;b.extractIceInfo=function(a){var b=[];a=a.split("\r\n");for(var c=0;c<a.length;c++){var d=a[c];this.$1(d)&&b.push({gen:this.$2(d),type:this.$3(d)})}return b};b.$1=function(a){return a.indexOf("candidate:")>-1};b.$2=function(a){var b=0;a=a.match(/generation (\d+)/);a&&(b=parseInt(a[1],10));return b};b.$3=function(a){a=a.match(/typ (host|relay|srflx|prflx)/);if(a)return a[1];else return"unknown"};return a}();f["default"]=a}),66);
__d("FBRTCMessageType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,PING:18,P2P_PROTOCOL:19,UPDATE:20,NOTIFY:21,CONNECT:22,CLIENT_EVENT:23,UNSUBSCRIBE:25,APPROVAL:26,TRANSFER:27,WAKEUP:28})}),null);
__d("FBRTCRtcResponseStatusCode",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONFLICT:409,CONDITIONAL_REQUEST_FAILED:412,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503})}),null);
__d("P2pReliabilityFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1848277");c=b("FalcoLoggerInternal").create("p2p_reliability",a);e.exports=c}),null);
__d("RtcCallActionFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744335");c=b("FalcoLoggerInternal").create("rtc_call_action",a);e.exports=c}),null);
__d("RtcTslogFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1825919");c=b("FalcoLoggerInternal").create("rtc_tslog",a);e.exports=c}),null);
__d("FBRTCLogger",["CurrentUser","FBLogger","FBRTCConsoleLogger","FBRTCMessageType","FBRTCRtcResponseStatusCode","FacebookAppIDs","MarauderLogger","ODS","P2pReliabilityFalcoEvent","RTWebLoggingSharedInstance","RTWebUserActionLogger","RtcCallActionFalcoEvent","RtcInfraReliabilityFalcoEvent","RtcTslogFalcoEvent","UserAgentData","gkx","pageID"],(function(a,b,c,d,e,f,g){var h="rtc_client_call_summary",i="client_error",j="client_event",k="info",l="received_message",m="send_failed",n="send_succeeded",o="sent_message",p="RECEIVED_RESPONSE",q="RECEIVED_REQUEST",r="PROCESSING_REQUEST",s="PROCESSED_REQUEST",t="PROCESSING_REQUEST_FAILED",u="PROCESSED_RESPONSE",v="START_PROCESSING_RESPONSE",w="SENDING_RESPONSE",x="RELAY_CONNECTED",y="BEGIN_SET_REMOTE_DESCRIPTION",z="END_SET_REMOTE_DESCRIPTION",A="BEGIN_REMOTE_SDP_MUNGING",B="END_REMOTE_SDP_MUNGING",C="SENDING_REQUEST",D="SENT_REQUEST",E="SENT_RESPONSE",F="SEND_REQUEST_FAILED",G="SEND_RESPONSE_FAILED",H=null;a=function(){a.getInstance=function(){H==null&&(H=new a());return H};a.multiwayMessageTypeName=function(a){switch(a){case c("FBRTCMessageType").JOIN:return"JOIN";case c("FBRTCMessageType").SERVER_MEDIA_UPDATE:return"SERVER_MEDIA_UPDATE";case c("FBRTCMessageType").HANGUP:return"HANGUP";case c("FBRTCMessageType").ICE_CANDIDATE:return"ICE_CANDIDATE";case c("FBRTCMessageType").RING:return"RING";case c("FBRTCMessageType").DISMISS:return"DISMISS";case c("FBRTCMessageType").CONFERENCE_STATE:return"CONFERENCE_STATE";case c("FBRTCMessageType").ADD_PARTICIPANTS:return"ADD_PARTICIPANTS";case c("FBRTCMessageType").SUBSCRIPTION:return"SUBSCRIPTION";case c("FBRTCMessageType").CLIENT_MEDIA_UPDATE:return"CLIENT_MEDIA_UPDATE";case c("FBRTCMessageType").DATA_MESSAGE:return"DATA_MESSAGE";case c("FBRTCMessageType").REMOVE_PARTICIPANTS:return"REMOVE_PARTICIPANTS";case c("FBRTCMessageType").CONNECT:return"CONNECT";case c("FBRTCMessageType").PING:return"PING";case c("FBRTCMessageType").P2P_PROTOCOL:return"P2P_PROTOCOL";case c("FBRTCMessageType").UPDATE:return"UPDATE";case c("FBRTCMessageType").NOTIFY:return"NOTIFY";case c("FBRTCMessageType").CLIENT_EVENT:return"CLIENT_EVENT";case c("FBRTCMessageType").UNSUBSCRIBE:return"UNSUBSCRIBE"}return a.toString()};function a(){var a=this;this.logError=function(b,d,e){var f,g={call_id:d,content:e,peer_id:b};f=c("FBLogger")("rtweb").addMetadata("RT_WEB","CALL_ID",""+((f=d)!=null?f:"null")).addMetadata("RT_WEB","PEER_ID",""+((f=b)!=null?f:"null"));if(typeof e==="string")f.warn(e);else{var h=JSON.stringify(e);f.warn((f=h)!=null?f:"Unknown error")}a.$9(i,g);a.$5(b,d,"Error",JSON.stringify(e))};this.$2=JSON.stringify({version:2,device:c("UserAgentData").deviceName,os:c("UserAgentData").platformName,os_version:c("UserAgentData").platformFullVersion,browser:c("UserAgentData").browserName,browser_version:c("UserAgentData").browserFullVersion});this.$3=JSON.stringify({version:2,device:c("UserAgentData").deviceName,os:c("UserAgentData").platformName,os_version:c("UserAgentData").platformFullVersion,browser:c("UserAgentData").browserName,browser_version:c("UserAgentData").browserFullVersion,msg_source:"web"});this.$1=c("RTWebLoggingSharedInstance").getDeviceID();this.$4=c("FacebookAppIDs").MQTT_WEB}var b=a.prototype;b.logToConsole=function(a){this.$5(null,null,"Console",a)};b.$6=function(a,b,d,e,f,g,h){var i=this;c("P2pReliabilityFalcoEvent").log(function(){return{app_id:i.$4.toString(),call_id:a,device_id:i.$1,result_code:h==null?void 0:h.toString(),event_name:b,extra:i.$2,msg_id:e,msg_type:d.toUpperCase(),raw_time:String(Date.now()),receiver_id:g,sender_id:f,service_name:"WEB_CLIENT"}})};b.logMultiwayMessageReceived=function(b,c){var d=a.multiwayMessageTypeName(b.type());this.$5(b.conferenceName(),c,"Received MW",d+", "+b.transactionId(),d==="EXPERIMENT"?"DEBUG":"INFO");b.isRequest()&&this.$7(q,b.conferenceName(),b.serverInfoData(),b.transactionId(),a.multiwayMessageTypeName(b.type()),b.header().retryCount,c?c.toString():null)};b.$8=function(b,c,d,e){if(!c.isRequest())return;this.$7(b,c.conferenceName(),c.serverInfoData(),c.transactionId(),a.multiwayMessageTypeName(c.type()),c.header().retryCount,d?d.toString():null,e?e:null)};b.logServerRequestStartProcessing=function(a,b){this.$8(r,a,b)};b.logServerRequestDoneProcessing=function(a,b){this.$8(s,a,b)};b.logServerRequestFailedProcessing=function(a,b,c){this.$8(t,a,b,c)};b.logMultiwayResponseReceived=function(b,d){try{var e=b.header.responseStatusCode;e===c("FBRTCRtcResponseStatusCode").OK&&this.$7(p,b.header.conferenceName,b.header.serverInfoData,b.header.transactionId,a.multiwayMessageTypeName(b.header.type),b.header.retryCount,d)}catch(a){this.logErrorWithoutID(a)}};b.logMultiwayResponseStartProcessing=function(b,c,d){this.$7(v,b.conferenceName,b.serverInfoData,b.transactionId,a.multiwayMessageTypeName(b.type),b.retryCount,c,d)};b.logMultiwayResponseProcessed=function(b,d,e){try{var f=b.responseStatusCode;f===c("FBRTCRtcResponseStatusCode").OK&&this.$7(u,b.conferenceName,b.serverInfoData,b.transactionId,a.multiwayMessageTypeName(b.type),b.retryCount,d,e)}catch(a){this.logErrorWithoutID(a)}};b.logMultiwayResponseProcessedFromResponsePayload=function(a,b,d){try{var e=a.header.responseStatusCode;e===c("FBRTCRtcResponseStatusCode").OK&&this.logMultiwayResponseProcessed(a.header,b,d)}catch(a){this.logErrorWithoutID(a)}};b.logSendingMultiwayMessage=function(b){this.$7(b.isRequest()?C:w,b.conferenceName(),b.serverInfoData(),b.transactionId(),a.multiwayMessageTypeName(b.type()),b.header().retryCount,b.header().clientSessionId)};b.logSentMultiwayMessage=function(b){this.$7(b.isRequest()?D:E,b.conferenceName(),b.serverInfoData(),b.transactionId(),a.multiwayMessageTypeName(b.type()),b.header().retryCount,b.header().clientSessionId)};b.logSendMultiwayMessageFailed=function(b){this.$7(b.isRequest()?F:G,b.conferenceName(),b.serverInfoData(),b.transactionId(),a.multiwayMessageTypeName(b.type()),b.header().retryCount,b.header().clientSessionId)};b.logSendMultiwayMessageFailure=function(a){d("ODS").bumpEntityKey(4083,"scotch_multiway","send_message_failure"),d("ODS").flush(),c("RTWebUserActionLogger").logCheckpoint({checkpoint:"Failed to send MW message, error: "+a})};b.logMultiwayRelayConnected=function(a,b,c){this.$7(x,a,b,null,null,null,c)};b.logMultiwayBeginSetRemoteDescription=function(b){this.$7(y,b.conferenceName,b.serverInfoData,b.transactionId,a.multiwayMessageTypeName(b.type),b.retryCount,b.clientSessionId)};b.logMultiwayEndSetRemoteDescription=function(b){this.$7(z,b.conferenceName,b.serverInfoData,b.transactionId,a.multiwayMessageTypeName(b.type),b.retryCount,b.clientSessionId)};b.logMultiwayBeginRemoteSdpMunging=function(b){this.$7(A,b.conferenceName,b.serverInfoData,b.transactionId,a.multiwayMessageTypeName(b.type),b.retryCount,b.clientSessionId)};b.logMultiwayEndRemoteSdpMunging=function(b){this.$7(B,b.conferenceName,b.serverInfoData,b.transactionId,a.multiwayMessageTypeName(b.type),b.retryCount,b.clientSessionId)};b.$7=function(a,b,d,e,f,g,h,i){var j=this;c("RtcInfraReliabilityFalcoEvent").log(function(){return{event_name:a,client_session_id:h,data:{extra_data:i},tc:Date.now(),conference_name:b,server_info_data:d,message_type:f,transaction_id:e,retry_count:g,web_device_id:j.$1,web_app_id:j.$4,version:"0"}})};b.logReceivedMessage=function(a,b,d){var e=b?b.toString():null,f={call_id:b,from:a,msg_id:d.msg_id,type:d.type};d.sdp&&(f.content=d.sdp);d.ack_id&&(f.ack_msg_id=d.ack_id);var g=d.type||d.msgType;this.$6(e,"CLIENT_RECEIVED_MESSAGE",g,d.msg_id,a,c("CurrentUser").getID());this.$9(l,f);this.$5(a,b,"Received P2P",d.type+", "+d.msg_id)};b.logSentMessage=function(a,b,d){var e=b?b.toString():null,f={call_id:b,msg_id:d.msg_id,to:a,type:d.type};d.sdp&&(f.content=d.sdp);d.ack_id&&(f.ack_msg_id=d.ack_id);this.$6(e,"CLIENT_SENDING_MESSAGE",d.type,d.msg_id,c("CurrentUser").getID(),a);this.$9(o,f);this.$5(a,b,"Sent",d.type+", "+d.msg_id)};b.logSentMessageSuccess=function(a,b,d,e){var f={call_id:b,msg_id:e,peer_id:a,type:d};b=b?b.toString():null;this.$6(b,"CLIENT_TRANSPORT_SUCCESS",d,e.toString(),c("CurrentUser").getID(),a);this.$9(n,f)};b.logSentMessageFailure=function(a,b,d,e,f){var g={call_id:b,error_code:f,msg_id:e,peer_id:a,type:d},h=b?b.toString():null;this.$6(h,"CLIENT_TRANSPORT_ERROR",d,e.toString(),c("CurrentUser").getID(),a,f);this.$9(m,g);this.$5(a,b,"Send Failed",d+", "+f)};b.logCallAction=function(a,b,d,e,f){var g={call_action:d,call_id:b,content:e,peer_id:a};f&&(g.trigger=f);c("RtcCallActionFalcoEvent").logImmediately(function(){return{action_name:d,call_id:"",audio_output_name:"UNKNOWN",rownum:-1,logging_instance_id:-1,logger_schema_version:-1,caller_id:"",call_type:"UNKNOWN",session_type:"UNKNOWN",seconds_since_call_start:-1,ms_since_epoch:-1,ms_steady:-1,device_orientation:"UNKNOWN",interface_orientation:"UNKNOWN",battery_level:-1,battery_plugged_state:"UNKNOWN",battery_charge_state:"UNKNOWN",battery_mode:"UNKNOWN",camera_facing:"UNKNOWN"}});this.$5(a,b,"CallAction",d+", "+JSON.stringify(e))};b.logEvent=function(a,b,c){var d={call_id:b,content:c,peer_id:a};this.$9(j,d);this.$5(a,b,"Event",JSON.stringify(c))};b.logInfo=function(a,b,c){var d={call_id:b,content:c,peer_id:a};this.$9(k,d);this.$5(a,b,"Info",JSON.stringify(c))};b.logErrorWithoutID=function(a){this.logError(null,null,a)};b.logEndCallSummary=function(a,b){b===void 0&&(b=!1);if(!a)return;c("RTWebUserActionLogger").logCheckpoint({checkpoint:"Attempting to upload CallSummary",callID:a.callID});var d={call_id:a.callID,channel_session_id:a.deviceID,content:a.toString(),local_call_id:a.localCallID,peer_id:a.peerID,tag:"endcallstats"},e=babelHelpers["extends"]({},d,a.getExtraInfo());this.$9(h,e,b);this.$5(a.peerID,a.callID,"Call Summary",JSON.stringify(d));c("RTWebUserActionLogger").logCheckpoint({checkpoint:"Complete uploading CallSummary",callID:a.callID})};b.logTsLogData=function(a,b,d,e,f){f===void 0&&(f=null);if(!b||!d||a.streams.length===0)return;c("RTWebUserActionLogger").logCheckpoint({checkpoint:"Attempting to upload tslog",callID:d});var g=b;f&&(g=null);var h=JSON.stringify(a);c("RtcTslogFalcoEvent").logImmediately(function(){return{call_id:d,conf_name:e,time_series1:h,serv_info:f,peer_id:g}});this.$5(b,d,"TSLog Data",h);c("RTWebUserActionLogger").logCheckpoint({checkpoint:"Complete uploading tslog",callID:d})};b.doesContainSensitiveData=function(a){return String(a).indexOf("crypto")>-1};b.redactSensitiveData=function(a,b){if(a!==h){a=JSON.stringify(b);if(this.doesContainSensitiveData(a))return{redacted:!0}}return b};b.$9=function(a,b,e){e===void 0&&(e=!1);var f="basic";e&&(f=c("gkx")("1488912")?"vital":"signal");b.page_id=c("pageID");e=this.redactSensitiveData(a,b);c("FBRTCConsoleLogger").getInstance().getLogHistory().log(a,e);d("MarauderLogger").log(a,c("FBRTCConsoleLogger").MODULE_NAME,e,void 0,void 0,void 0,void 0,f)};b.$5=function(a,b,d,e,f){f===void 0&&(f="DEBUG"),c("FBRTCConsoleLogger").getInstance().log(this.doesContainSensitiveData(e)?"redacted":e,a,b,d,f)};return a}();a.CallAction=Object.freeze({ANSWER_CALL:"answer_call",AUTO_DISABLE_VIDEO:"auto_disable_video",DENIED_PERMISSION:"denied_permission",END_CALL:"end_call",FAILED_GETTING_URI:"failed_getting_uri",OLD_URI:"old_uri",OPEN_POPUP:"open_popup",POPUP_OPENED:"popup_opened",RECEIVED_CALL:"received_call",SET_FULLSCREEN_ON:"set_fullscreen_on",SET_MUTE:"set_mute",SET_SELF_VIEW_ON:"set_self_view_on",SET_VIDEO_ON:"set_video_on",START_CALL:"start_call",START_SKYPE:"start_skype",TRY_NEW:"try_new",USER_SETTINGS_CHANGED:"user_settings_changed"});a.Trigger=Object.freeze({ADMIN_MESSAGE:"admin_message",CHAT_TAB_ICON_TOUR:"chat_tab_icon_tour",CHAT_TAB_ICON:"chat_tab_icon",CHAT_TAB_VOICE_ICON:"chat_tab_voice_icon",MULTIWAY_ADMIN_MESSAGE_JOIN_AUDIO_CALL_BUTTON:"multiway_admin_message_join_audio_call_button",MULTIWAY_ADMIN_MESSAGE_JOIN_VIDEO_CALL_BUTTON:"multiway_admin_message_join_video_call_button",MULTIWAY_ADMIN_MESSAGE_START_AUDIO_CALL_BUTTON:"multiway_admin_message_start_audio_call_button",MULTIWAY_ADMIN_MESSAGE_START_VIDEO_CALL_BUTTON:"multiway_admin_message_start_video_call_button",MULTIWAY_CHAT_TAB_SHEET_JOIN_CALL_BUTTON:"multiway_chat_tab_sheet_join_call_button",MULTIWAY_POPUP_START_CALL_BUTTON:"multiway_popup_start_call_button",MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:"multiway_thread_header_audio_button",MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:"multiway_thread_header_join_audio_call_audio_button",MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:"multiway_thread_header_join_audio_call_video_button",MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:"multiway_thread_header_join_video_call_audio_button",MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON:"multiway_thread_header_join_video_call_video_button",MULTIWAY_THREAD_HEADER_VIDEO_BUTTON:"multiway_thread_header_video_button",MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON:"multiway_thread_list_join_call_button",POPUP_CALL_START_BUTTON:"popup_start_call_button",REDIAL_BUTTON:"redial_button",RESET_CALL:"install_screen_sharing_ext_dialog",RETURN_CALL:"return_call",SKYPE_DEPRECATION_DIALOG:"skype_deprecation_dialog",TIMELINE_PROFILE:"timeline_profile",VC_PRECALL_SETUP:"vc_precall_setup",WORKPLACE_GROUP_CALL:"workplace_group_call",WORKPLACE_P2P_CALL:"workplace_p2p_call",UNKNOWN:"unknown",WEB_MESSENGER:"web_messenger",TEAMWORK_USER_VIDEO_CALL_ITEM:"teamwork_user_video_call_item",TEAMWORK_USER_AUDIO_CALL_ITEM:"teamwork_user_audio_call_item"});a.Key=Object.freeze({BATTERY_START:"battery_start",BATTERY_END:"battery_end",CALL_TYPE:"call_type",CONNECTION_EFFECTIVE_TYPE:"conn_effective_type",CPU_CORES:"cpu_cores",DEVICE_INFO:"device_info",DEVICE_MEMORY:"device_memory",DEVICE_PIXEL_RATIO:"device_pixel_ratio",INITIATED_BY_PAGE_ID:"initiated_by_page_id",INITIATED_BY_APP_ID:"initiated_by_app_id",PEER_IS_MOBILE:"peer_is_mobile",RATING_SHOWN:"rating_shown",RATING:"rating5",ROOM_SURFACE:"room_surface",EFFECT_COUNT:"rtc_effect_count",EFFECT_TOTAL_DURATION:"rtc_effect_total_duration",VIDEO_DURATION_WITH_FILTER:"rtc_video_duration_with_filter_enabled",SCREEN_DURATION:"screen_duration",SURVEY_CHOICE:"survey_choice",SURVEY_DETAILS:"survey_details",SURVEY_SHOWN:"survey_shown",MEDIA_INPUTS:"media_inputs",VIDEO_CAPABILITIES:"video_capabilities",CB_ACTIVE:"cb_active",YEAR_CLASS:"year_class",DESKTOP_DEVICE_CLASS:"desktop_device_class",IS_BACKGROUNDED:"is_backgrounded",APPLICATION_STATE:"application_state",MAX_CONCURRENT_CONNECTED_PARTICIPANTS:"max_concurrent_connected_participants"});g["default"]=a}),98);
__d("FBRTCMediaMetricTracker",["performanceNow"],(function(a,b,c,d,e,f,g){"use strict";var h={count:0,current:-1,first:-1,min:-1,max:-1,mean:-1,median:-1,startedTime:-1,total:-1,updatedTime:-1};a=function(){function a(){this.$2={},this.$3={},this.$4={},this.$1={},this.$5=null}var b=a.prototype;b.getVideoStreamReportKeys=function(){return Object.keys(this.$4)};b.getJitterStreamReportKey=function(){return Object.keys(this.$2)};b.getAudioStreamReportKeys=function(){return Object.keys(this.$3)};b.addJitterBufferDelay=function(a,b){b!=null&&(this.$2[a]||(this.$2[a]=[]),this.$2[a].push(b))};b.setHistResScale=function(a,b,c){this.$1[a]||(this.$1[a]={contentType:b,histogram:[]}),this.$1[a]={contentType:b,histogram:c}};b.getHistResScale=function(a){return this.$1[a]?{contentType:this.$1[a].contentType,histogram:this.$1[a].histogram}:null};b.setVideoContentType=function(a,b){this.$4[a]||(this.$4[a]={}),this.$4[a].contentType=b};b.getVideoContentType=function(a){return this.$4[a].contentType};b.setVideoMetric=function(a,b,c){c!=null&&(this.$4[a]||(this.$4[a]={}),this.$4[a][b]=this.$6(this.$4[a][b],c))};b.$6=function(a,b){if(a!=null){a.current=b;a.updatedTime=c("performanceNow")();a.total+=b;a.count+=1;a.min=Math.min(a.min,b);a.max=Math.max(a.max,b);a.mean=a.total/a.count;return a}else return{min:b,max:b,total:b,count:1,mean:b,first:b,startedTime:c("performanceNow")(),current:b,updatedTime:c("performanceNow")()}};b.getVideoStreamDuration=function(a,b){return this.$4[a]!=null&&this.$4[a][b]!=null?this.$4[a][b].count:0};b.getAudioStreamDuration=function(a,b){return this.$3[a]!=null&&this.$3[a][b]!=null?this.$3[a][b].count:0};b.getVideoMetric=function(a,b){return this.$4[a]?this.$4[a][b]:null};b.addMetricStat=function(a,b,c){c!=null&&(this.$3[a]||(this.$3[a]={}),this.$3[a][b]=this.$6(this.$3[a][b],c))};b.getMetricStats=function(a,b){return!this.$3[a]?null:this.$3[a][b]};b.getJitterBufferStats=function(a){if(!this.$2[a])return h;var b=this.$2[a].length;if(b===0)return h;this.$2[a].sort(function(a,b){return a-b});var c=this.$2[a].reduce(function(a,b){return a+b});if(b%2===0){var d=Math.floor((b-1)/2),e=Math.ceil((b-1)/2);d=(this.$2[a][d]+this.$2[a][e])/2}else d=this.$2[a][(b-1)/2];return{max:this.$2[a][b-1],min:this.$2[a][0],mean:c/b,median:d,total:c,count:b,first:-1,startedTime:-1,current:-1,updatedTime:-1}};b.toJsonString=function(){return JSON.stringify({stats:this.$3,jitterBufferDelays:this.$2,videoMetric:this.$4,histResScale:this.$1})};a.getPercentMediaKey=function(a,b,c){return a.concat("_",b,"_p",String(c))};a.getAvgMediaKey=function(a,b){return a.concat("_",b,"_avg")};a.fromJsonString=function(b){var c=new a(),d;try{d=JSON.parse(b),d=d}catch(a){return c}d.stats&&(c.$3=d.stats);d.jitterBufferDelays&&(c.$2=d.jitterBufferDelays);d.videoMetric&&(c.$4=d.videoMetric);d.histResScale&&(c.$1=d.histResScale);return c};return a}();g["default"]=a}),98);
__d("FBRTCMediaMetricsConst",[],(function(a,b,c,d,e,f){"use strict";a="jitter";b="accelerate_rate";c="decoding_cng";d="decoding_normal";e="decoding_plc";var g="decoding_plc_cng",h="decoding_neteq_call",i="discard_rate",j="encode_bitrate",k="expand_rate",l="speech_expand_rate",m="preemptive_rate",n="audio_send_total_energy",o="audio_receive_total_energy",p="audio_send_log_level",q="audio_send_log_level_count",r="audio_send_loudness_level",s="audio_receive_log_level",t="audio_receive_log_level_count",u="audio_receive_loudness_level",v="audio_packets_received",w="audio_fec_packets_received",x="audio_fec_packets_discarded",y="audio_packets_received_lost",z="audio_packets_sent",A="audio_packets_sent_lost",B="video_bytes_received",C="video_bytes_sent",D="inbound_qp",E="outbound_qp",F="frames_encoded",G="frames_decoded",H="frames_received",I="frames_sent",J="keyframes_decoded",K="picture_less_indication_received",L="full_intra_request_received",M="videobwe_send_bandwidth",N="videobwe_transmit_bitrate",O="videobwe_retransmit_bitrate",P="audio_bytes_sent",Q="audio_bytes_received",R="video_pkts_sent",S="video_pkts_send_lost",T="video_pkts_received",U="video_fec_pkts_received",V="video_fec_pkts_discarded",W="video_pkts_receive_lost",X="audio_rtt_received",Y="audio_rtt_sent",Z="audio_dev_rec_stalls",$="audio_dev_total_stalls",aa="audio_dev_is_stalled",ba="audio_dev_stall_duration",ca="video_freeze_cnt",da="video_freeze_duration",ea="video_freeze_duration_500ms",fa="video_pause_cnt",ga="video_pause_duration",ha="video_capture_width",ia="video_capture_height",ja="video_sum_capture_pixel",ka="video_capture_frame_count",la="video_decoded_width",ma="video_decoded_height",na="video_encoded_width",oa="video_encoded_height",pa="audio_total_packet_send_delay",qa="video_total_packet_send_delay",ra="audio_total_encode_time",sa="video_total_encode_time",ta="audio_total_decode_time",ua="video_total_decode_time",va="audio_jitter_buffer_delay",wa="video_jitter_buffer_delay",xa="audio_jitter_buffer_emitted_count",ya="video_jitter_buffer_emitted_count",za="audio_e2e_latency",Aa="video_e2e_latency",Ba="av_sync",Ca="av_sync_abs",Da="av_sync_count",Ea="av_sync_oob",Fa="video_sum_decoded_pixel",Ga="video_sum_encoded_pixel",Ha="audio_neteq_wait_time",Ia="audio_packet_loss_rate",Ja="audio_plc_cng_rate",Ka="audio_plc_rate",La="global_audio_bitrate",Ma="global_battery_usage",Na="global_cpu_usage",Oa="global_video_bitrate",Pa="video_av_sync_abs",Qa="video_av_sync_oob",Ra="video_frame_rate",Sa="video_freeze_count_per_min",Ta="video_freeze_duration_per_min",Ua="video_neteq_wait_time",Va="video_packet_loss_rate",Wa="video_render_scale_ratio",Xa="video_cropping_ratio",Ya="video_rtt_received",Za="video_rtt_sent",$a="simulcast_layer_changes",ab="video_quality_sent",bb="video_encoded_frame_rate",cb="video_qp_sent",db="video_decode_time";f.JITTER=a;f.ACCELERATE_RATE=b;f.DECODING_CNG=c;f.DECODING_NORMAL=d;f.DECODING_PLC=e;f.DECODING_PLC_CNG=g;f.DECODING_NETEQ_CALL=h;f.DISCARD_RATE=i;f.ENCODE_BITRATE=j;f.EXPAND_RATE=k;f.SPEECH_EXPAND_RATE=l;f.PREEMPTIVE_RATE=m;f.AUDIO_SEND_TOTAL_ENERGY=n;f.AUDIO_RECEIVE_TOTAL_ENERGY=o;f.AUDIO_SEND_LOG_LEVEL=p;f.AUDIO_SEND_LOG_LEVEL_COUNT=q;f.AUDIO_SEND_LOUDNESS_LEVEL=r;f.AUDIO_RECEIVE_LOG_LEVEL=s;f.AUDIO_RECEIVE_LOG_LEVEL_COUNT=t;f.AUDIO_RECEIVE_LOUDNESS_LEVEL=u;f.AUDIO_PACKETS_RECEIVED=v;f.AUDIO_FEC_PACKETS_RECEIVED=w;f.AUDIO_FEC_PACKETS_DISCARDED=x;f.AUDIO_PACKETS_RECEIVED_LOST=y;f.AUDIO_PACKETS_SENT=z;f.AUDIO_PACKETS_SENT_LOST=A;f.VIDEO_BYTES_RECEIVED=B;f.VIDEO_BYTES_SENT=C;f.INBOUND_QP=D;f.OUTBOUND_QP=E;f.FRAMES_ENCODED=F;f.FRAMES_DECODED=G;f.FRAMES_RECEIVED=H;f.FRAMES_SENT=I;f.KEYFRAMES_DECODED=J;f.PICTURE_LOSS_INDICAION_RECEIVED=K;f.FULL_INTRA_REQUEST_RECEIVED=L;f.VIDEOBWE_SEND_BANDWIDTH=M;f.VIDEOBWE_TRANSMIT_BITRATE=N;f.VIDEOBWE_RETRANSMIT_BITRATE=O;f.AUDIO_BYTES_SENT=P;f.AUDIO_BYTES_RECEIVED=Q;f.VIDEO_PKTS_SENT=R;f.VIDEO_PKTS_SEND_LOST=S;f.VIDEO_PKTS_RECEIVED=T;f.VIDEO_FEC_PKTS_RECEIVED=U;f.VIDEO_FEC_PKTS_DISCARDED=V;f.VIDEO_PKTS_RECV_LOST=W;f.AUDIO_RTT_RECEIVED=X;f.AUDIO_RTT_SENT=Y;f.AUDIO_DEV_REC_STALLS=Z;f.AUDIO_DEV_TOTAL_STALLS=$;f.AUDIO_DEV_IS_STALLED=aa;f.AUDIO_DEV_STALL_DURATION=ba;f.VIDEO_FREEZE_COUNT=ca;f.VIDEO_FREEZE_DURATION=da;f.VIDEO_FREEZE_DURATION_500MS=ea;f.VIDEO_PAUSE_COUNT=fa;f.VIDEO_PAUSE_DURATION=ga;f.VIDEO_CAPTURE_WIDTH=ha;f.VIDEO_CAPTURE_HEIGHT=ia;f.VIDEO_SUM_CAPTURE_PIXEL=ja;f.VIDEO_CAPTURE_FRAME_COUNT=ka;f.VIDEO_DECODED_WIDTH=la;f.VIDEO_DECODED_HEIGHT=ma;f.VIDEO_ENCODED_WIDTH=na;f.VIDEO_ENCODED_HEIGHT=oa;f.AUDIO_TOTAL_PACKET_SEND_DELAY=pa;f.VIDEO_TOTAL_PACKET_SEND_DELAY=qa;f.AUDIO_TOTAL_ENCODE_TIME=ra;f.VIDEO_TOTAL_ENCODE_TIME=sa;f.AUDIO_TOTAL_DECODE_TIME=ta;f.VIDEO_TOTAL_DECODE_TIME=ua;f.AUDIO_JITTER_BUFFER_DELAY=va;f.VIDEO_JITTER_BUFFER_DELAY=wa;f.AUDIO_JITTER_BUFFER_EMITTED_COUNT=xa;f.VIDEO_JITTER_BUFFER_EMITTED_COUNT=ya;f.AUDIO_E2E_LATENCY=za;f.VIDEO_E2E_LATENCY=Aa;f.AV_SYNC=Ba;f.AV_SYNC_ABS=Ca;f.AV_SYNC_COUNT=Da;f.AV_SYNC_OOB=Ea;f.VIDEO_SUM_DECODED_PIXEL=Fa;f.VIDEO_SUM_ENCODED_PIXEL=Ga;f.AUDIO_NETEQ_WAIT_TIME=Ha;f.AUDIO_PACKET_LOSS_RATE=Ia;f.AUDIO_PLC_CNG_RATE=Ja;f.AUDIO_PLC_RATE=Ka;f.GLOBAL_AUDIO_BITRATE=La;f.GLOBAL_BATTERY_USAGE=Ma;f.GLOBAL_CPU_USAGE=Na;f.GLOBAL_VIDEO_BITRATE=Oa;f.VIDEO_AV_SYNC_ABS=Pa;f.VIDEO_AV_SYNC_OOB=Qa;f.VIDEO_FRAME_RATE=Ra;f.VIDEO_FREEZE_COUNT_PER_MIN=Sa;f.VIDEO_FREEZE_DURATION_PER_MIN=Ta;f.VIDEO_NETEQ_WAIT_TIME=Ua;f.VIDEO_PACKET_LOSS_RATE=Va;f.VIDEO_RENDER_SCALE_RATIO=Wa;f.VIDEO_CROPPING_RATIO=Xa;f.VIDEO_RTT_RECEIVED=Ya;f.VIDEO_RTT_SENT=Za;f.SIMULCAST_LAYER_CHANGES=$a;f.VIDEO_QUALITY_SENT=ab;f.VIDEO_ENCODED_FRAME_RATE=bb;f.VIDEO_QP_SENT=cb;f.VIDEO_DECODE_TIME=db}),66);
__d("FBRTCCallSummary",["ChannelClientID","ErrorMetadata","FBRTCConstants","FBRTCIceStatsParser","FBRTCLocalUploadLogLevel","FBRTCLogger","FBRTCMediaMetricTracker","FBRTCMediaMetricsConst","RTWebUserActionLogger","SiteData","UserAgentData","WebPerformanceDeviceInfo","gkx","performanceNow","uuid"],(function(a,b,c,d,e,f,g){var h=5*60*1e3,i=1e5,j=[5,50,95],k={CALL_STARTED:"started",SENT_OFFER:"s_o",RECV_OFFER:"r_o",SENT_OFFER_ACK:"s_oack",RECV_OFFER_ACK:"r_oack",SENT_RETRIED_OFFER:"s_o2",RECV_RETRIED_OFFER:"r_o2",SENT_RETRIED_OFFER_ACK:"s_oack2",RECV_RETRIED_OFFER_ACK:"r_oack2",SENT_PRANSWER:"s_pr",RECV_PRANSWER:"r_pr",NETWORK_READY:"network_ready",SENT_ANSWER:"s_a",RECV_ANSWER:"r_a",SENT_ANSWER_ACK:"s_aack",RECV_ANSWER_ACK:"r_aack",SENT_RETRIED_ANSWER:"s_a2",RECV_RETRIED_ANSWER:"r_a2",SENT_RETRIED_ANSWER_ACK:"s_aack2",RECV_RETRIED_ANSWER_ACK:"r_aack2",SENT_OK:"s_ok",RECV_OK:"r_ok",CALL_CONNECTED:"connected",CALL_ENDED:"ended",SENT_JOIN_REQUEST:"s_jreq",RECV_JOIN_RESPONSE:"r_jresp",PROC_JOIN_RESPONSE:"p_jresp",RECV_RING_REQUEST:"r_rreq",SENT_RING_RESPONSE:"s_rresp"},l={FELLBACK_TO_AUDIO:"f_a",MEDIA_REQUESTED:"m_r",MEDIA_SUCCEEDED:"m_s",POPUP_OPENED:"opened",PRESSED_ANSWER:"p_a"},m={ESCALATION_IS_AVAILABLE:"esc_available",USER_INITIATED_REQUEST:"out_started",RECEIVED_INCOMING_REQUEST:"inc_started",REJECTED_INVALID_P2P_STATE:"rej_invalid_state",CONNECTING_TO_MULTIWAY:"u_connecting_mw",CONNECTED_TO_MULTIWAY:"u_connected_mw",PEER_CONNECTING_TO_MULTIWAY:"p_connecting_mw",PEER_CONNECTED_TO_MULTIWAY:"p_connected_mw",READY_TO_ESCALATE:"ready_esc",PEER_FAILED_TO_CONNECT_TO_MULTIWAY:"p_fail_conn",MULTIWAY_CALL_ENDED:"mw_call_ended",TIMED_OUT:"timed_out",PEER_ABORTED:"p_aborted",INTERNAL_ERROR:"internal_err"},n={ESCALATION_INITIATION_BUTTON_CLICKED:"esc_init_button",ESCALATION_APPROVED_BUTTON_CLICKED:"esc_appr_button",ESCALATION_DECLINED_BUTTON_CLICKED:"esc_decl_button",USERMEDIA_REQUEST:"media_req",USERMEDIA_SUCCESS:"media_success",USERMEDIA_FAILURE:"media_fail",SENT_ESC_REQUEST:"s_esc_req",RECV_ESC_REQUEST:"r_esc_req",SENT_ESC_REQUEST_ACK:"s_esc_req_ack",RECV_ESC_REQUEST_ACK:"s_esc_req_ack",SENT_ESC_RESPONSE:"s_esc_rep",RECV_ESC_ACCEPT:"r_esc_accept",RECV_ESC_DECLINE:"r_esc_decl",RECV_ESC_TIMEOUT:"r_esc_timeout"},o=[d("FBRTCMediaMetricsConst").ACCELERATE_RATE,d("FBRTCMediaMetricsConst").DISCARD_RATE,d("FBRTCMediaMetricsConst").EXPAND_RATE,d("FBRTCMediaMetricsConst").PREEMPTIVE_RATE,d("FBRTCMediaMetricsConst").SPEECH_EXPAND_RATE],p=[{key:d("FBRTCMediaMetricsConst").AUDIO_NETEQ_WAIT_TIME,field:"nwt",scale:1},{key:d("FBRTCMediaMetricsConst").AUDIO_PACKET_LOSS_RATE,field:"plr",scale:1e4},{key:d("FBRTCMediaMetricsConst").AUDIO_PLC_CNG_RATE,field:"plccngr",scale:1e4},{key:d("FBRTCMediaMetricsConst").AUDIO_PLC_RATE,field:"plcr",scale:1e4}],q=[{key:d("FBRTCMediaMetricsConst").VIDEO_AV_SYNC_ABS,field:"avabs",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_FRAME_RATE,field:"fr",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_NETEQ_WAIT_TIME,field:"nwt",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_PACKET_LOSS_RATE,field:"plr",scale:1e4},{key:d("FBRTCMediaMetricsConst").VIDEO_RENDER_SCALE_RATIO,field:"rsr",scale:100},{key:d("FBRTCMediaMetricsConst").VIDEO_CROPPING_RATIO,field:"cr",scale:100}],r=[{key:d("FBRTCMediaMetricsConst").VIDEO_FREEZE_COUNT_PER_MIN,field:"vfmin",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION_PER_MIN,field:"vfdur",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_AV_SYNC_OOB,field:"avoob",scale:1e4}],s=[{key:d("FBRTCMediaMetricsConst").GLOBAL_CPU_USAGE,field:"proc",scale:100},{key:d("FBRTCMediaMetricsConst").GLOBAL_BATTERY_USAGE,field:"bat",scale:1},{key:d("FBRTCMediaMetricsConst").GLOBAL_AUDIO_BITRATE,field:"tadb",scale:1},{key:d("FBRTCMediaMetricsConst").GLOBAL_VIDEO_BITRATE,field:"tvdb",scale:1}],t=[{key:d("FBRTCMediaMetricsConst").AUDIO_RTT_SENT,field:"artt",scale:1}],u=[{key:d("FBRTCMediaMetricsConst").VIDEO_RTT_SENT,field:"vrtt",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_QUALITY_SENT,field:"vqs",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_ENCODED_FRAME_RATE,field:"efr",scale:1},{key:d("FBRTCMediaMetricsConst").VIDEO_QP_SENT,field:"qp",scale:1}],v="globalStatsTrackId",w="grid",x="pinned",y="thumbnail",z="pinnedAudioStatsTrackId",A="pinnedVideoStatsTrackId",B="outboundAudioStatsTrackId",C="outboundScreenStatsTrackId",D="outboundVideoStatsTrackId",E=[v,z,A,B,C,D];function F(a){return"ZenonPlatform"}a=function(){a.nullSummary=function(){return new a({peerID:"0",callID:"0",isCaller:!1,callTrigger:"NULL_SUMMARY"})};function a(b){var e;this.$41={};this.peerID=String(b.peerID);this.callID=String(b.callID);this.localCallID=(e=b.localCallID)!=null?e:c("uuid")();this.deviceID=d("ChannelClientID").getID();this.$2=b.isCaller;this.$1=b.version||a.CURRENT_SUMMARY_VERSION;this.$3=d("FBRTCLocalUploadLogLevel").getLocalUploadLogLevel();this.$15=new Date().valueOf();this.$43={};this.$4=b.callTrigger||null;this.$6={};this.$8={};this.$9={};this.$14={};this.$34=null;this.$35=null;this.$36=null;this.$17=0;this.$18=0;this.$33=!1;this.$10={};this.$11={};this.$12={};this.$13={};this.$39=null;this.$38=null;this.$37=null;this.$5=F(this.peerID);this.$20=c("performanceNow")();this.$16=0;this.$7={};this.$19=this.$20;this.$21=0;this.$22={};this.addExtraInfo(c("FBRTCLogger").Key.DEVICE_INFO,this.$56());this.$57();this.$58();this.$59();this.$60();this.$24=c("FBRTCIceStatsParser").getInstance();this.$50=new(c("FBRTCMediaMetricTracker"))();this.$23=c("FBRTCLogger").getInstance()}var b=a.prototype;b.toJsonString=function(){this.$18=new Date().valueOf();return JSON.stringify({version:this.$1,peerID:this.peerID,callID:this.callID,localCallID:this.localCallID,deviceID:this.deviceID,isCaller:this.$2,uploadLogLevel:this.$3,callType:this.$29,conferenceName:this.$26,joinWithSID:this.$27,activeConn:this.$25,escP2PCallID:this.$28,serverInfoData:this.$30,localVideoDuration:this.$31,remoteVideoDuration:this.$32,startTime:this.$15,trigger:this.$4,signalingTime:this.$6,escStateTimes:this.$8,applicationEventTime:this.$9,videoEscTimes:this.$14,endCallReason:this.$34,endCallSubreason:this.$35,isRemoteEnded:this.$36,lastUpdatedTime:this.$17,lastSerializedTime:this.$18,unsetOnRetrieve:this.$33,openCount:this.$21,extraInfo:this.$22,gen0IceSentCount:this.$10,gen0IceReceivedCount:this.$11,iceSentCount:this.$12,iceReceivedCount:this.$13,connectionType:this.$39,mediaMetricStats:this.$50.toJsonString(),newSignalingTime:this.$7,accumulatedCallTime:this.$61(),deviceCharged:this.$42,ehist:this.getEhist(),videoReceivedCodec:this.$44,videoSentCodec:this.$45,videoDevice:this.$46,audioDevice:this.$47,audioDeviceHist:this.$48,audioSentCodec:this.$49,relayIP:this.$40,clientVersion:this.$5,pcConnectionStates:this.$41,pcIsConnected:this.$37,endIsConnected:this.$38,maxTotalDecodeTime:this.$51,totalDecodeTime:this.$52,totalEncodeTime:this.$53,keyFramesEncoded:this.$54,avSyncAbsHist:this.$55})};a.fromJsonString=function(b){var d,e;try{e=JSON.parse(b)}catch(a){return null}if(e.version<a.OLDEST_SUPPORTED_SUMMARY_VERSION)return null;if(!Object.prototype.hasOwnProperty.call(e,"peerID")||!Object.prototype.hasOwnProperty.call(e,"callID")||!Object.prototype.hasOwnProperty.call(e,"isCaller")||!Object.prototype.hasOwnProperty.call(e,"startTime")||!Object.prototype.hasOwnProperty.call(e,"trigger")||!Object.prototype.hasOwnProperty.call(e,"signalingTime")||!Object.prototype.hasOwnProperty.call(e,"endCallReason")||!Object.prototype.hasOwnProperty.call(e,"isRemoteEnded")||!Object.prototype.hasOwnProperty.call(e,"lastUpdatedTime")||!Object.prototype.hasOwnProperty.call(e,"lastSerializedTime"))return null;b=new a({peerID:e.peerID,callID:e.callID,isCaller:e.isCaller,localCallID:e.localCallID});b.deviceID=e.deviceID;b.$1=e.version;b.$3=e.uploadLogLevel;b.$15=e.startTime;b.$4=e.trigger;b.$5=e.clientVersion;b.$6=e.signalingTime;b.$34=e.endCallReason;b.$35=e.endCallSubreason;b.$36=e.isRemoteEnded;b.$17=e.lastUpdatedTime;b.$18=e.lastSerializedTime;b.$27=e.joinWithSID;b.$38=(d=e.endIsConnected)!=null?d:null;b.$37=(d=e.pcIsConnected)!=null?d:null;e.callType&&(b.$29=e.callType);e.conferenceName&&(b.$26=e.conferenceName);e.escP2PCallID&&(b.$28=e.escP2PCallID);e.activeConn&&(b.$25=e.activeConn);e.serverInfoData&&(b.$30=e.serverInfoData);e.localVideoDuration&&(b.$31=e.localVideoDuration);e.remoteVideoDuration&&(b.$32=e.remoteVideoDuration);e.unsetOnRetrieve&&(b.$33=e.unsetOnRetrieve);e.openCount&&(b.$21=e.openCount);e.extraInfo&&(b.$22=e.extraInfo);e.gen0IceSentCount&&(b.$10=e.gen0IceSentCount);e.gen0IceReceivedCount&&(b.$11=e.gen0IceReceivedCount);e.iceSentCount&&(b.$12=e.iceSentCount);e.iceReceivedCount&&(b.$13=e.iceReceivedCount);e.newSignalingTime&&(b.$7=e.newSignalingTime);e.pcConnectionStates&&(b.$41=e.pcConnectionStates);e.accumulatedCallTime&&(b.$16=e.accumulatedCallTime);e.escStateTimes&&(b.$8=e.escStateTimes);e.applicationEventTime&&(b.$9=e.applicationEventTime);e.videoEscTimes&&(b.$14=e.videoEscTimes);e.mediaMetricStats&&(b.$50=c("FBRTCMediaMetricTracker").fromJsonString(e.mediaMetricStats));e.connectionType&&(b.$39=e.connectionType);e.deviceCharged&&(b.$42=e.deviceCharged);e.ehist!==null&&(b.$43=e.ehist);e.videoReceivedCodec!==null&&(b.$44=e.videoReceivedCodec);e.videoSentCodec!==null&&(b.$45=e.videoSentCodec);e.videoDevice!==null&&(b.$46=e.videoDevice);e.audioDevice!==null&&(b.$47=e.audioDevice);e.audioDeviceHist!==null&&(b.$48=e.audioDeviceHist);e.audioSentCodec!==null&&(b.$49=e.audioSentCodec);e.relayIP!=null&&(b.$40=e.relayIP);e.maxTotalDecodeTime!=null&&(b.$51=e.maxTotalDecodeTime);e.totalDecodeTime!=null&&(b.$52=e.totalDecodeTime);e.totalEncodeTime!=null&&(b.$53=e.totalEncodeTime);e.keyFramesEncoded!=null&&(b.$54=e.keyFramesEncoded);e.avSyncAbsHist!==null&&(b.$55=e.avSyncAbsHist);return b};a.restoreOrInitialize=function(b,d,e,f,g,h){d=String(d);e=String(e);b=b.retrieveCallSummary(d,e);!b?(b=new a({peerID:d,callID:e,isCaller:f}),g?(b.onFullMessageReceived({msg:g}),b.onOfferAckSent(g)):b.onCallStarted(h||c("FBRTCLogger").Trigger.UNKNOWN),h!==c("FBRTCLogger").Trigger.REDIAL_BUTTON&&c("FBRTCLogger").getInstance().logError(d,e,"Missing call summary from storage")):b.$33&&(b.$38=null,b.$34=null,b.$35=null,b.$36=null,delete b.$6[k.CALL_ENDED],delete b.$7[k.CALL_ENDED],b.$20=0,b.$33=null);return b};a.logSavedSummaries=function(a){var b=a.getLoggableSummaries(),d=b.length;if(d<=0)return;var e=c("FBRTCLogger").getInstance(),f=[];for(var g=0;g<d;g++){var h=b[g];e.logEndCallSummary(h);f.push({peerID:h.peerID,callID:h.callID})}a.removeCallSummaries(f);e.logToConsole("Logged pending summaries: "+d)};b.logThisSummary=function(a,b){b===void 0&&(b=!1);var d=c("FBRTCLogger").getInstance();a.retrieveCallSummary(this.peerID,this.callID)!=null?(d.logEndCallSummary(this,b),a.removeCallSummary(this.peerID,this.callID),d.logToConsole("Logged active summary"),c("RTWebUserActionLogger").logCheckpoint({checkpoint:"FBRTCCallSummary_logThisSummary: Logged call summary "+JSON.stringify({peerID:this.peerID,callID:this.callID})})):c("RTWebUserActionLogger").logCheckpoint({checkpoint:"FBRTCCallSummary_logThisSummary: Unable to retrieve call summary "+JSON.stringify({peerID:this.peerID,callID:this.callID})})};b.isNull=function(){var b=a.CANONICAL_NULL_SUMMARY;return this.peerID===b.peerID&&this.callID===b.callID&&this.isCaller()===b.isCaller()&&this.getCallTrigger()===b.getCallTrigger()};b.save=function(a){var b=c("performanceNow")(),d=b-this.$19;if(d>h){this.$23.logInfo(this.peerID,this.callID,"Summary too old: "+d);return}a.storeCallSummary(this.peerID,this.callID,this);this.$19=b};b.getVersion=function(){return this.$1};b.getLastUpdatedTime=function(){return this.$17};b.setLastUpdatedTime=function(a){this.$17=a};b.getExtraInfo=function(){return this.$22};b.getCallTrigger=function(){return this.$4};b.addExtraInfo=function(a,b){this.$22[a]=b,this.$60()};b.isCaller=function(){return this.$2};b.isNetworkReady=function(){if(this.$6[k.NETWORK_READY])return!0;else return!1};b.isAnswerReceived=function(){if(this.$6[k.RECV_ANSWER])return!0;else return!1};b.onCallStarted=function(a){this.$4=a,this.$62(k.CALL_STARTED),this.$60(),c("ErrorMetadata").addGlobalMetadata("RT_WEB","TYPE","CallStarted")};b.setCallTrigger=function(a){this.$4=a,this.$60()};b.setPCIsConnected=function(a){this.$37!==a&&(this.$37=a,this.$41[this.$61()]=a)};b.onPopupOpened=function(){this.deviceID=d("ChannelClientID").getID(),this.$63(l.POPUP_OPENED),this.$21++,this.$60()};b.onPressedAnswer=function(){this.$63(l.PRESSED_ANSWER),this.$60()};b.onMediaRequested=function(){this.$63(l.MEDIA_REQUESTED),this.$60()};b.onMediaSucceeded=function(){this.$63(l.MEDIA_SUCCEEDED),this.$60()};b.onFellbackToAudio=function(){this.$63(l.FELLBACK_TO_AUDIO),this.$60()};b.setConnectionType=function(a){this.$39=a,this.$60()};b.setUploadLogLevel=function(a){this.$3=a,this.$60()};b.getCallType=function(){return this.$29};b.setCallType=function(a){this.$29=a,this.addExtraInfo(c("FBRTCLogger").Key.CALL_TYPE,a),this.$60()};b.setLinkSurface=function(a){this.addExtraInfo(c("FBRTCLogger").Key.ROOM_SURFACE,a)};b.setVideoDurations=function(a,b){this.$31=a,this.$32=b,this.$60()};b.setAudioDevice=function(a){var b;this.$47=a;this.$48=(b=this.$48)!=null?b:new Array(0);this.$48.length===0?this.$48.push(a):a!==this.$48[this.$48.length-1]&&this.$48.push(a)};b.setVideoDevice=function(a){this.$46=a};b.setScreenDuration=function(a){this.addExtraInfo(c("FBRTCLogger").Key.SCREEN_DURATION,a)};b.setConferenceName=function(a){this.$26=a,this.$60()};b.setTotalVideoFilterDuration=function(a){this.addExtraInfo(c("FBRTCLogger").Key.VIDEO_DURATION_WITH_FILTER,Math.ceil(a).toString())};b.setCoExperienceEffectDuration=function(a){this.addExtraInfo(c("FBRTCLogger").Key.EFFECT_TOTAL_DURATION,Math.ceil(a).toString())};b.setEffectCount=function(a){this.addExtraInfo(c("FBRTCLogger").Key.EFFECT_COUNT,a.toString())};b.setJoinWithSID=function(a){this.$27=a,this.$60()};b.setServerInfoData=function(a){this.$30=a,this.$60()};b.setActiveConnection=function(a){this.$25=a,this.$60()};b.setEscalationP2PCallID=function(a){this.$28=a,this.$60()};b.onOfferAckSent=function(a){this.onMessageSent({type:d("FBRTCConstants").PayloadType.OFFER_ACK,flag:a.flag})};b.onMessageSent=function(a){var b=a.flag===1;switch(a.type){case d("FBRTCConstants").PayloadType.OFFER:this.$64(b,k.SENT_OFFER,k.SENT_RETRIED_OFFER);this.$65(a,this.$10,this.$12);break;case d("FBRTCConstants").PayloadType.ANSWER:this.$64(b,k.SENT_ANSWER,k.SENT_RETRIED_ANSWER);this.$65(a,this.$10,this.$12);break;case d("FBRTCConstants").PayloadType.OK:this.$62(k.SENT_OK);break;case d("FBRTCConstants").PayloadType.PRANSWER:this.$62(k.SENT_PRANSWER);break;case d("FBRTCConstants").PayloadType.OFFER_ACK:this.$64(b,k.SENT_OFFER_ACK,k.SENT_RETRIED_OFFER_ACK);break;case d("FBRTCConstants").PayloadType.ANSWER_ACK:this.$64(b,k.SENT_ANSWER_ACK,k.SENT_RETRIED_ANSWER_ACK);break;case d("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$65(a,this.$10,this.$12);break;case d("FBRTCConstants").PayloadType.ACK:a.ack_type===d("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$66(n.SENT_ESC_REQUEST_ACK);break;case d("FBRTCConstants").PayloadType.VIDEO_REQUEST:a.ack_id?this.$66(n.SENT_ESC_RESPONSE):this.$66(n.SENT_ESC_REQUEST);break;default:}this.$60()};b.$65=function(a,b,c){var d,e=null;a=this.$24.extractIceInfo(a.sdp);for(var f=0;f<a.length;f++)d=a[f].gen,e=a[f].type,d===0&&this.$67(b,e),this.$67(c,e)};b.$67=function(a,b){!a[b]?a[b]=1:a[b]+=1};b.$68=function(a){this.addExtraInfo(c("FBRTCLogger").Key.PEER_IS_MOBILE,a.isFromMobile()?"1":"0")};b.onFullMessageReceived=function(a){var b=a.msg,c=b.flag===1;switch(b.type){case d("FBRTCConstants").PayloadType.OFFER:this.$68(a);this.$64(c,k.RECV_OFFER,k.RECV_RETRIED_OFFER);this.$65(b,this.$11,this.$13);break;case d("FBRTCConstants").PayloadType.ANSWER:this.$68(a);this.$64(c,k.RECV_ANSWER,k.RECV_RETRIED_ANSWER);this.$65(b,this.$11,this.$13);break;case d("FBRTCConstants").PayloadType.OK:this.$62(k.RECV_OK);break;case d("FBRTCConstants").PayloadType.PRANSWER:this.$62(k.RECV_PRANSWER);break;case d("FBRTCConstants").PayloadType.OFFER_ACK:this.$64(c,k.RECV_OFFER_ACK,k.RECV_RETRIED_OFFER_ACK);break;case d("FBRTCConstants").PayloadType.ANSWER_ACK:this.$64(c,k.RECV_ANSWER_ACK,k.RECV_RETRIED_ANSWER_ACK);break;case d("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$65(b,this.$11,this.$13);break;case d("FBRTCConstants").PayloadType.ACK:b.ack_type===d("FBRTCConstants").PayloadType.VIDEO_REQUEST&&this.$66(n.RECV_ESC_REQUEST_ACK);break;case d("FBRTCConstants").PayloadType.VIDEO_REQUEST:b.ack_id?b.videoon||b.reqVideoOn?this.$66(n.RECV_ESC_ACCEPT):this.$66(n.RECV_ESC_DECLINE):b.videoon||b.reqVideoOn?this.$66(n.RECV_ESC_REQUEST):this.$66(n.RECV_ESC_TIMEOUT);break;default:}this.$60()};b.onMsgAckReceived=function(a,b){a=a.msg.flag===1;b?this.$64(a,k.RECV_OFFER_ACK,k.RECV_RETRIED_OFFER_ACK):this.$64(a,k.RECV_ANSWER_ACK,k.RECV_RETRIED_ANSWER_ACK)};b.onNetworkReady=function(){this.$62(k.NETWORK_READY),this.$60()};b.onCallConnected=function(){this.$62(k.CALL_CONNECTED),this.$60()};b.onCallEnded=function(a,b,c,d){this.$33=c,this.$34=a,this.$35=d,this.$36=b,this.$38===null&&(this.$38=this.$37),this.$62(k.CALL_ENDED),this.$60()};b.setOfferSentTime=function(){this.$62(k.SENT_OFFER)};b.setOfferAckReceivedTime=function(){this.$62(k.RECV_OFFER_ACK)};b.setAnswerSentTime=function(){this.$62(k.SENT_ANSWER)};b.setAnswerReceivedTime=function(){this.$62(k.RECV_ANSWER)};b.setJoinRequestSent=function(){this.$62(k.SENT_JOIN_REQUEST),this.$60()};b.setJoinResponseReceived=function(){this.$62(k.RECV_JOIN_RESPONSE),this.$60()};b.setJoinResponseProcessed=function(){this.$62(k.PROC_JOIN_RESPONSE),this.$60()};b.setRingRequestReceived=function(){this.$62(k.RECV_RING_REQUEST),this.$60()};b.setRingResponseSent=function(){this.$62(k.SENT_RING_RESPONSE),this.$60()};b.setEscalationAvailable=function(){this.$69(m.ESCALATION_IS_AVAILABLE)};b.setEscalationInitiated=function(){this.$69(m.USER_INITIATED_REQUEST)};b.setReceivedEscalationRequest=function(){this.$69(m.RECEIVED_INCOMING_REQUEST)};b.setInvalidP2PEscalationState=function(){this.$69(m.REJECTED_INVALID_P2P_STATE)};b.setEscalationConnectingToMultiway=function(){this.$69(m.CONNECTING_TO_MULTIWAY)};b.setEscalationConnectedToMultiway=function(){this.$69(m.CONNECTED_TO_MULTIWAY)};b.setEscalationPeerConnectingToMultiway=function(){this.$69(m.PEER_CONNECTING_TO_MULTIWAY)};b.setEscalationPeerConnectedToMultiway=function(){this.$69(m.PEER_CONNECTED_TO_MULTIWAY)};b.setReadyToEscalate=function(){this.$69(m.READY_TO_ESCALATE)};b.setEscalationPeerFailedToConnectToMultiway=function(){this.$69(m.PEER_FAILED_TO_CONNECT_TO_MULTIWAY)};b.setEscalationTimedOut=function(){this.$69(m.TIMED_OUT)};b.setVidEscalationInitClick=function(){this.$66(n.ESCALATION_INITIATION_BUTTON_CLICKED)};b.setVidEscalationAcceptedClick=function(){this.$66(n.ESCALATION_APPROVED_BUTTON_CLICKED)};b.setVidEscalationDeclinedClick=function(){this.$66(n.ESCALATION_DECLINED_BUTTON_CLICKED)};b.setVidEscalationMediaRequested=function(){this.$66(n.USERMEDIA_REQUEST)};b.setVidEscalationMediaSuccess=function(){this.$66(n.USERMEDIA_SUCCESS)};b.setVidEscalationMediaFailed=function(){this.$66(n.USERMEDIA_FAILURE)};b.setVideoCapabilities=function(a){this.addExtraInfo(c("FBRTCLogger").Key.VIDEO_CAPABILITIES,a)};b.setMediaInputs=function(a){this.addExtraInfo(c("FBRTCLogger").Key.MEDIA_INPUTS,a)};b.getVideoReceivedCodec=function(){return this.$44};b.setVideoReceivedCodec=function(a){this.$44=a};b.getVideoSentCodec=function(){return this.$45};b.setVideoSentCodec=function(a){this.$45=a};b.getEhist=function(){return this.$43};b.setEhist=function(a){this.$43=a};b.getAudioSentCodec=function(){return this.$49};b.setAudioSentCodec=function(a){this.$49=a};b.setVideoMaxTotalDecodeTime=function(a){var b;this.$51=Math.max((b=this.$51)!=null?b:0,a)};b.getTotalDecodeTime=function(){return this.$52};b.setTotalDecodeTime=function(a){this.$52=a};b.getTotalEncodeTime=function(){return this.$53};b.setTotalEncodeTime=function(a){this.$53=a};b.getKeyFramesEncoded=function(){return this.$54};b.setKeyFramesEncoded=function(a){this.$54=a};b.$70=function(){return this.$55};b.setAvSyncAbsHist=function(a){var b;b=(b=a)!=null?b:[];b=b.some(function(a){return a>0});b&&(this.$55=a)};b.toString=function(){var a={core_metrics:this.$71(),time_series:null};return JSON.stringify(a)};b.$71=function(){var a={ver:this.$1,log_level:d("FBRTCConstants").uploadLogLevelString(this.$3),caller:this.$2,call_type:this.$29,active_conn:this.$25,app_event_times:this.$9,conf_name:this.$26,CoreAudioMetrics:this.$72(),join_with_sid:this.$27,esc_p2p_call_id:this.$28,esc_state_times:this.$8,vid_esc_times:this.$14,serv_info:this.$30,conn:this.$73(),peer_id:this.peerID,has_video:!0,open_count:this.$21,signaling:this.$74(),sender:this.$75(),receiver:this.$76(),end:this.$77(),video:this.$78(),push_phase:c("SiteData").push_phase,DebugAudioMetrics:this.$79(),device_charged:this.$42,client_version:this.$5,perf:this.$80(),grid:this.$81(),pinned:this.$82(),thumbnail:this.$83(),sys_pct:this.$84(),sender_pct:this.$85()};return a};b.$79=function(){return{NetworkReceive:{jb_nm:this.$86()}}};b.$87=function(a,b,c){var d=this,e=0,f=0;b==null&&(b=1);var g=this.$50.getVideoStreamReportKeys();g.forEach(function(b){if(c==null||d.$50.getVideoContentType(b)===c){b=d.$50.getVideoMetric(b,a);b&&(e+=b.total,f+=b.count)}});return f===0?null:Math.round(e*b/f)};b.$88=function(a,b,c){var d=this,e=0,f=0;b==null&&(b=1);var g=this.$50.getVideoStreamReportKeys();g.forEach(function(b){if(c==null||d.$50.getVideoContentType(b)===c){b=d.$50.getVideoMetric(b,a);b&&(e+=b.current,f+=1)}});return f===0?null:Math.round(e*b)};b.$89=function(a,b){var c=this,d=0,e=0;b==null&&(b=1);var f=this.$50.getAudioStreamReportKeys();f.forEach(function(b){b=c.$50.getMetricStats(b,a);b&&(d+=b.current,e+=1)});return e===0?null:Math.round(d*b)};b.$86=function(){var a=this,b={},c=this.$50.getAudioStreamReportKeys();if(c.length<1)return b;o.forEach(function(d){var e=0,f=0,g=-Infinity,h=Infinity;c.forEach(function(b){b=a.$50.getMetricStats(b,d);b!=null&&b.total!=null&&(e+=b.count,f+=b.total,g=Math.max(g,b.max),h=Math.min(h,b.min))});e>0&&(b[d]={m:Math.round(1e4*h),M:Math.round(1e4*g),avg:Math.round(f*1e4/e)})});b.neteq={meanWait:this.$90()};return b};b.$90=function(){var a=this.$89(d("FBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_DELAY),b=this.$89(d("FBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_EMITTED_COUNT);return a!=null&&b!=null&&b>0?Math.round(a*1e3/b):-1};b.$72=function(){var a=this,b=this.$50.getAudioStreamReportKeys();b=b.reduce(function(b,c){c=a.$50.getMetricStats(c,d("FBRTCMediaMetricsConst").AUDIO_DEV_IS_STALLED);return!c||c.updatedTime==null||c.current==null?b:c.updatedTime>b.timeStamp?{val:c.current,timeStamp:c.updatedTime}:b},{val:-1,timeStamp:-Infinity}).val>0?1:0;var c=this.$89(d("FBRTCMediaMetricsConst").AUDIO_DEV_REC_STALLS),e=this.$89(d("FBRTCMediaMetricsConst").AUDIO_DEV_TOTAL_STALLS),f=this.$89(d("FBRTCMediaMetricsConst").AUDIO_DEV_STALL_DURATION),g=this.$91();g=g.count===0?0:Math.round(g.levelSum/g.count);e={astall:e,audio_device:this.$47,audio_device_hist:this.$48,isstall:b,rstall:c,rx_chan_proc_lvl:g,sdur:f};return e};b.$73=function(){var a={dtls:1},b=this.$75();b.avgrtt&&(a.avgrtt=b.avgrtt,a.maxrtt=b.maxrtt,a.minrtt=b.minrtt);this.$40!==null&&(a.relay_ip=this.$40);a.ctd=this.$41;return a};b.$74=function(){var a={};this.$4&&(a.trigger=this.$4);a.start_time=this.$15;a.time_from_start=this.$6;a.new_time_from_start=this.$7;var b=this.$92();b>0&&(a.duration=b);return a};b.$92=function(a){var b=this.$7[k.CALL_CONNECTED]||this.$7[k.NETWORK_READY];if(!b)return 0;a=this.$7[k.CALL_ENDED]||!(a==null?void 0:a.assumeOngoing)&&this.$16||this.$61();return Math.max(0,a-b)};b.$75=function(){var a=this,b={},c=this.$50.getAudioStreamReportKeys(),e=0,f=0,g=0;c.forEach(function(b){b=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_BYTES_SENT);b!=null&&(e+=b.current,f+=b.current-b.first,g+=b.updatedTime-b.startedTime)});g>0&&(b.ube_avg=Math.round(f*8e3/g));b.bytes=e;b.plost=this.$89(d("FBRTCMediaMetricsConst").AUDIO_PACKETS_SENT_LOST);b.psent=this.$89(d("FBRTCMediaMetricsConst").AUDIO_PACKETS_SENT);var h=this.$50.getMetricStats(B,d("FBRTCMediaMetricsConst").AUDIO_SEND_LOUDNESS_LEVEL),i=this.$50.getMetricStats(B,d("FBRTCMediaMetricsConst").AUDIO_SEND_LOG_LEVEL_COUNT);h&&i&&(b.tx_sum_lvl=h.current,b.taulc=i.current);var j=0,k=0,l=null,m=null;c.forEach(function(b){b=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_RTT_SENT);b&&(k+=b.count,j+=b.total,l=l==null?b.min:Math.min(l,b.min),m=m==null?b.max:Math.max(m,b.max))});k>0&&(b.avgrtt=Math.round(j/k),b.maxrtt=m,b.minrtt=l);this.$10&&(b.ice_g0=this.$10);this.$12&&(b.ice=this.$12);this.$49!=null&&this.$49!==""&&(b.codec={www:this.$49});return b};b.$76=function(){var a=this,b={},c=this.$50.getAudioStreamReportKeys();b.jbd=this.$89(d("FBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_DELAY,1e3);b.jbec=this.$89(d("FBRTCMediaMetricsConst").AUDIO_JITTER_BUFFER_EMITTED_COUNT);var e=new Map([[d("FBRTCMediaMetricsConst").DECODING_PLC,0],[d("FBRTCMediaMetricsConst").DECODING_PLC_CNG,0],[d("FBRTCMediaMetricsConst").DECODING_CNG,0],[d("FBRTCMediaMetricsConst").DECODING_NORMAL,0],[d("FBRTCMediaMetricsConst").DECODING_NETEQ_CALL,0]]);c.forEach(function(b){if(E.includes(b))return;e.forEach(function(c,d){c=a.$50.getMetricStats(b,d);if(c!=null){var f;f=(f=e.get(d))!=null?f:0;e.set(d,f+c.current)}})});b.dec_plc=e.get(d("FBRTCMediaMetricsConst").DECODING_PLC);b.dec_plc_cng=e.get(d("FBRTCMediaMetricsConst").DECODING_PLC_CNG);b.dec_cng=e.get(d("FBRTCMediaMetricsConst").DECODING_CNG);b.dec_normal=e.get(d("FBRTCMediaMetricsConst").DECODING_NORMAL);b.neteq_calls=e.get(d("FBRTCMediaMetricsConst").DECODING_NETEQ_CALL);var f=this.$50.getMetricStats(v,d("FBRTCMediaMetricsConst").AUDIO_SEND_LOUDNESS_LEVEL),g=this.$50.getMetricStats(v,d("FBRTCMediaMetricsConst").AUDIO_SEND_LOG_LEVEL_COUNT);f&&g&&(b.rx_sum_lvl=f.current,b.taulc=g.current);b.fecpd=this.$89(d("FBRTCMediaMetricsConst").AUDIO_FEC_PACKETS_DISCARDED);b.fecpr=this.$89(d("FBRTCMediaMetricsConst").AUDIO_FEC_PACKETS_RECEIVED);var h=0;c.forEach(function(b){b=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_BYTES_RECEIVED);b&&(h+=b.current)});b.bytes=h;var j=0,k=0;c.forEach(function(b){b=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_BYTES_RECEIVED);if(b){var c=b.updatedTime-b.startedTime;c>0&&(j+=b.current-b.first,k+=c)}});k>0&&(b.dbe_avg=Math.round(j*8e3/k));var l=0;c.forEach(function(b){b=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED_LOST);b&&(l+=b.current)});b.plost=l;var m=0,n,o,p,q=0,r=0;c.forEach(function(b){var c=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_PACKETS_RECEIVED),e=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_RTT_RECEIVED);b=a.$50.getMetricStats(b,d("FBRTCMediaMetricsConst").AUDIO_RECEIVE_TOTAL_ENERGY);b!=null&&(q+=b.current,r+=b.updatedTime-b.startedTime);c!=null&&(m+=c.current,e!=null&&e.mean!=null&&(n=n==null?c.current*e.mean:n+c.current*e.mean,p=p==null?e.max:Math.max(p,e.max),o=o==null?e.min:Math.min(o,e.min)))});b.taue=Math.round(q*i);b.taut=Math.round(r);m>0&&n!=null&&(b.avgrtt=Math.round(n/m),b.maxrtt=p,b.minrtt=o);b.precv=m;this.$11&&(b.ice_g0=this.$11);this.$13&&(b.ice=this.$13);return b};b.$77=function(){var a={};this.$34!=null&&(a.end_call_reason_string=d("FBRTCConstants").callEndReasonString(this.$34),this.$35!==null&&(a.end_call_subreason_string=this.$35),a.remote_ended=this.$36,a.end_ctd=this.$38);this.$39&&(a.conn_type=this.$39);return a};b.$78=function(){var a={ch:null,cw:null,ah:null,aw:null,efrate:this.$93(),ehist:this.getEhist(),eipxl:null,ename:this.$45,eopxl:null,fcap:this.$88(d("FBRTCMediaMetricsConst").VIDEO_CAPTURE_FRAME_COUNT),eqps:this.$88(d("FBRTCMediaMetricsConst").OUTBOUND_QP),frames:this.$88(d("FBRTCMediaMetricsConst").FRAMES_ENCODED),kframes:this.$54,fcsn:this.$88(d("FBRTCMediaMetricsConst").FRAMES_SENT),histResScale:null,psent:this.$88(d("FBRTCMediaMetricsConst").VIDEO_PKTS_SENT),plost:this.$88(d("FBRTCMediaMetricsConst").VIDEO_PKTS_SEND_LOST),ss:{avbr:null,avbw:this.$87(d("FBRTCMediaMetricsConst").VIDEOBWE_SEND_BANDWIDTH,1,"screen"),dur:null,eiframes:null,eipxl:null,eopxl:null,eqps:this.$88(d("FBRTCMediaMetricsConst").OUTBOUND_QP,1,"screen"),frames:this.$88(d("FBRTCMediaMetricsConst").FRAMES_ENCODED,1,"screen")},sim_l_chg:this.$88(d("FBRTCMediaMetricsConst").SIMULCAST_LAYER_CHANGES,1),tet:this.$88(d("FBRTCMediaMetricsConst").VIDEO_TOTAL_ENCODE_TIME,1e3),tpsd:this.$88(d("FBRTCMediaMetricsConst").VIDEO_TOTAL_PACKET_SEND_DELAY,1e3),video_device:this.$46};return{sender:this.$94(a),receiver:this.$95(),ld:this.$31,rd:this.$32,bwe:this.$96()}};b.$93=function(){var a=this.$31,b=this.$88(d("FBRTCMediaMetricsConst").FRAMES_ENCODED);if(a!=null&&a>0&&b!=null&&b>0)return Math.round(b*1e3/a)};b.$80=function(){var a,b=this.$92()/1e3;if(b<=0)return;a=((a=this.$52)!=null?a:0)+((a=this.$53)!=null?a:0);a=Math.round(100*(a/b));return{cpu:{proc:{avg:a}}}};b.$91=function(){var a=this,b=this.$50.getAudioStreamReportKeys();b=b.reduce(function(b,c){if(c===v||c===B)return b;var e=a.$50.getMetricStats(c,d("FBRTCMediaMetricsConst").AUDIO_RECEIVE_LOG_LEVEL);c=a.$50.getMetricStats(c,d("FBRTCMediaMetricsConst").AUDIO_RECEIVE_LOG_LEVEL_COUNT);return!e||!c?b:{count:b.count+c.current,levelSum:b.levelSum+e.current}},{count:0,levelSum:0});return b};b.$96=function(){var a=this,b={avg_enc_bitrate:this.$97(),avg_send_bw:this.$98(),avg_trans_bitrate:null,avg_retrans_bitrate:null},c=this.$50.getVideoStreamReportKeys();c.some(function(c){var e=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEOBWE_TRANSMIT_BITRATE);c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEOBWE_RETRANSMIT_BITRATE);if(e&&c){b.avg_trans_bitrate=e.mean;b.avg_retrans_bitrate=c.mean;return!0}return!1});return b};b.$97=function(){var a=this,b=this.$50.getVideoStreamReportKeys(),c=0,e=0;b.forEach(function(b){b=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").ENCODE_BITRATE);b&&(c+=b.total,e+=b.count)});return e===0?null:Math.round(c/e)};b.$98=function(){var a=this,b=this.$50.getVideoStreamReportKeys(),c=null;b.some(function(b){c=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEOBWE_SEND_BANDWIDTH);return c?!0:!1});c&&(c=c.mean);return c};b.$85=function(){var a=this.$99(t,B,w),b=this.$100(u,C,w),c=this.$100(u,D,w);return{audio:a,screen:b,video:c}};b.$99=function(a,b,d){var e=this,f={};a.forEach(function(a){var g,h=a.field,i=a.key;a=a.scale;var k=[];g=(g=e.$50.getMetricStats(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(i,d)))==null?void 0:g.current;j.forEach(function(a){a=(a=(a=e.$50.getMetricStats(b,c("FBRTCMediaMetricTracker").getPercentMediaKey(i,d,a)))==null?void 0:a.current)!=null?a:0;k.push(a)});g!=null&&(f[h]=e.$101(g,k,a,j))});return Object.keys(f).length>0?f:null};b.$100=function(a,b,d){var e=this,f={};a.forEach(function(a){var g,h=a.field,i=a.key;a=a.scale;var k=[];g=(g=e.$50.getVideoMetric(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(i,d)))==null?void 0:g.current;j.forEach(function(a){a=(a=(a=e.$50.getVideoMetric(b,c("FBRTCMediaMetricTracker").getPercentMediaKey(i,d,a)))==null?void 0:a.current)!=null?a:0;k.push(a)});g!=null&&(f[h]=e.$101(g,k,a,j))});return Object.keys(f).length>0?f:null};b.$84=function(){return this.$99(s,v,w)};b.$81=function(){var a=this,b={audio:{avg:{},max:{},min:{}},video:{avg:{},max:{},min:{}}},c=this.$50.getAudioStreamReportKeys(),d=this.$50.getVideoStreamReportKeys();p.forEach(function(d){var e=d.field,f=d.key;d=d.scale;f=a.$102(f,c,d,!0,j);f!=null&&(b.audio.avg[e]=f.avg,b.audio.max[e]=f.max,b.audio.min[e]=f.min)});q.forEach(function(c){var e=c.field,f=c.key;c=c.scale;f=a.$102(f,d,c,!1,j);f!=null&&(b.video.avg[e]=f.avg,b.video.max[e]=f.max,b.video.min[e]=f.min)});r.forEach(function(c){var e=c.field,f=c.key;c=c.scale;f=a.$102(f,d,c,!1,[]);f!=null&&(b.video.avg[e]=f.avg.avg,b.video.max[e]=f.max.avg,b.video.min[e]=f.min.avg)});return b};b.$103=function(a,b,d,e,f){var g=this,h=0,i=new Array(f.length).fill(0),j=0,k=0;b.forEach(function(b){var d=null,l=[];if(e){var m;j=g.$50.getAudioStreamDuration(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,y));d=(m=g.$50.getMetricStats(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,y)))==null?void 0:m.current;f.forEach(function(d){d=(d=g.$50.getMetricStats(b,c("FBRTCMediaMetricTracker").getPercentMediaKey(a,y,d)))==null?void 0:d.current;l.push(d)})}else{j=g.$50.getVideoStreamDuration(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,y));d=(m=g.$50.getVideoMetric(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,y)))==null?void 0:m.current;f.forEach(function(d){d=(d=g.$50.getVideoMetric(b,c("FBRTCMediaMetricTracker").getPercentMediaKey(a,y,d)))==null?void 0:d.current;l.push(d)})}d!=null&&(h+=d*j,i=l.map(function(a,b){return a!=null?a*j+i[b]:i[b]}),k+=j)});if(k===0)return null;b=h/k;var l=i.map(function(a){return a/k});return this.$101(b,l,d,f)};b.$102=function(a,b,d,e,f){var g=this,h=0,i=new Array(f.length).fill(0),j=0,k=new Array(f.length).fill(0),l=0,m=new Array(f.length).fill(0),n=0,o=0;b.forEach(function(b){var d=null,p=[];if(e){var q;n=g.$50.getAudioStreamDuration(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,w));d=(q=g.$50.getMetricStats(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,w)))==null?void 0:q.current;f.forEach(function(d){d=(d=g.$50.getMetricStats(b,c("FBRTCMediaMetricTracker").getPercentMediaKey(a,w,d)))==null?void 0:d.current;p.push(d)})}else{n=g.$50.getVideoStreamDuration(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,w));d=(q=g.$50.getVideoMetric(b,c("FBRTCMediaMetricTracker").getAvgMediaKey(a,w)))==null?void 0:q.current;f.forEach(function(d){d=(d=g.$50.getVideoMetric(b,c("FBRTCMediaMetricTracker").getPercentMediaKey(a,w,d)))==null?void 0:d.current;p.push(d)})}d!=null&&n>0&&(h+=d*n,i=p.map(function(a,b){return a!=null?a*n+i[b]:i[b]}),o===0?(j=d,l=d,k=p,m=p):d>j?(j=d,k=p):d<l&&(l=d,m=p),o+=n)});if(o===0)return null;b=h/o;var p=i.map(function(a){return a/o});b={avg:this.$101(b,p,d,f),min:this.$101(l,m,d,f),max:this.$101(j,k,d,f)};return b};b.$101=function(a,b,c,d){var e={};e.avg=Math.round(a*c);d.forEach(function(a,d){a="p".concat(String(a));e[a]=Math.round(b[d]*c)});return e};b.$83=function(){var a=this,b={audio:{},video:{}},c=this.$50.getAudioStreamReportKeys(),d=this.$50.getVideoStreamReportKeys(),e=!1;p.forEach(function(d){var f=d.field,g=d.key;d=d.scale;g=a.$103(g,c,d,!0,j);g!=null&&(b.audio[f]=g,e=!0)});q.forEach(function(c){var f=c.field,g=c.key;c=c.scale;g=a.$103(g,d,c,!1,j);g!=null&&(b.video[f]=g,e=!0)});r.forEach(function(c){var f=c.field,g=c.key;c=c.scale;g=a.$103(g,d,c,!1,[]);g!=null&&(b.video[f]=g.avg,e=!0)});return!e?null:b};b.$82=function(){var a=this,b=this.$50.getAudioStreamReportKeys(),d=this.$50.getVideoStreamReportKeys();if(!b.includes(z)&&!d.includes(A))return null;var e={audio:{},video:{}};p.forEach(function(b){var d,f=b.field,g=b.key;b=b.scale;var h=[];d=(d=a.$50.getMetricStats(z,c("FBRTCMediaMetricTracker").getAvgMediaKey(g,x)))==null?void 0:d.current;j.forEach(function(b){b=(b=(b=a.$50.getMetricStats(z,c("FBRTCMediaMetricTracker").getPercentMediaKey(g,x,b)))==null?void 0:b.current)!=null?b:0;h.push(b)});d!=null&&(e.audio[f]=a.$101(d,h,b,j))});q.forEach(function(b){var d,f=b.field,g=b.key;b=b.scale;var h=[];d=(d=a.$50.getVideoMetric(A,c("FBRTCMediaMetricTracker").getAvgMediaKey(g,x)))==null?void 0:d.current;j.forEach(function(b){b=(b=(b=a.$50.getVideoMetric(A,c("FBRTCMediaMetricTracker").getPercentMediaKey(g,x,b)))==null?void 0:b.current)!=null?b:0;h.push(b)});d!=null&&(e.video[f]=a.$101(d,h,b,j))});r.forEach(function(b){var d=b.field,f=b.key;b=b.scale;var g=[];f=(f=a.$50.getVideoMetric(A,c("FBRTCMediaMetricTracker").getAvgMediaKey(f,x)))==null?void 0:f.current;f!=null&&(e.video[d]=a.$101(f,g,b,[]).avg)});return e};b.$94=function(a){var b=this,e=this.$50.getVideoStreamReportKeys(),f=new Array(5).fill(0),g=0;e.forEach(function(a){a=b.$50.getHistResScale(a);a&&(g+=1,a.histogram.forEach(function(a,b){f[b]+=a}))});a.histResScale=g===0?null:f;e.reverse().some(function(c){var e=b.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_CAPTURE_WIDTH),f=b.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_CAPTURE_HEIGHT),g=b.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_ENCODED_WIDTH);c=b.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_ENCODED_HEIGHT);e&&f&&(a.cw=e.current,a.ch=f.current);if(g&&c){a.aw=g.current;a.ah=c.current;return!0}return!1});this.$22[c("FBRTCLogger").Key.SCREEN_DURATION]!=null&&typeof this.$22[c("FBRTCLogger").Key.SCREEN_DURATION]==="number"&&(a.ss.dur=this.$22[c("FBRTCLogger").Key.SCREEN_DURATION]);e=this.$88(d("FBRTCMediaMetricsConst").VIDEO_BYTES_SENT,1,"screen");e!=null&&a.ss.dur!=null&&a.ss.dur>0&&(a.ss.avbr=Math.round(1e3*8*e/a.ss.dur));e=this.$88(d("FBRTCMediaMetricsConst").VIDEO_SUM_ENCODED_PIXEL,1,"screen");var h=this.$88(d("FBRTCMediaMetricsConst").FRAMES_ENCODED,1,"screen");e!=null&&h!=null&&h>0&&(a.ss.eopxl=Math.round(e/h));e=this.$88(d("FBRTCMediaMetricsConst").VIDEO_SUM_CAPTURE_PIXEL,1,"screen");h=this.$88(d("FBRTCMediaMetricsConst").VIDEO_CAPTURE_FRAME_COUNT,1,"screen");e!=null&&h!=null&&h>0&&(a.ss.eiframes=h,a.ss.eipxl=Math.round(e/h));e=this.$88(d("FBRTCMediaMetricsConst").VIDEO_SUM_ENCODED_PIXEL,1);h=this.$88(d("FBRTCMediaMetricsConst").FRAMES_ENCODED,1);e!=null&&h!=null&&h>0&&(a.eopxl=Math.round(e/h));e=this.$88(d("FBRTCMediaMetricsConst").VIDEO_SUM_CAPTURE_PIXEL,1);h=this.$88(d("FBRTCMediaMetricsConst").VIDEO_CAPTURE_FRAME_COUNT,1);e!=null&&h!=null&&h>0&&(a.eipxl=Math.round(e/h));return a};b.$95=function(){var a=this,b=this.$50.getVideoStreamReportKeys(),c=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;b.forEach(function(b){var l=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_PKTS_RECEIVED),m=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_PKTS_RECV_LOST);l&&m&&(f+=l.current,g+=m.current);l=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_BYTES_RECEIVED);l&&(c+=l.current);m=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").FRAMES_DECODED);m&&(h+=m.current);l=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").KEYFRAMES_DECODED);l&&(i+=l.current);m=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").PICTURE_LOSS_INDICAION_RECEIVED);m&&(j+=m.current);l=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").FULL_INTRA_REQUEST_RECEIVED);l&&(k+=l.current);m=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_DECODE_TIME);m&&(e+=m.current)});var l={jtkey:i,pli:j,fir:k,dec_bytes:c,dec_frame:h,dec_time:this.$51?Math.round(this.$51):null,dec_time_all_streams:Math.round(e),dname:this.$44,dpxl:null,frd:h,frcnt:null,jtasb:null,precv:f,plost:g,qps:this.$88(d("FBRTCMediaMetricsConst").INBOUND_QP),rh:null,rw:null,tdt:this.$88(d("FBRTCMediaMetricsConst").VIDEO_TOTAL_DECODE_TIME,1e3),jbd:null,jbec:null,recjbl:null,e2el:null,av:null,avabs:null,avhist:this.$70(),avoob:null},m=this.$88(d("FBRTCMediaMetricsConst").VIDEO_JITTER_BUFFER_DELAY,1e3),n=this.$88(d("FBRTCMediaMetricsConst").VIDEO_JITTER_BUFFER_EMITTED_COUNT);l.jbd=m;l.jbec=n;m!=null&&n!=null&&n>0&&(l.recjbl=Math.round(m/n));var o=0,p=0,q=0,r=0,s=0;b.forEach(function(b){var c=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").AV_SYNC),e=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").AV_SYNC_ABS),f=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").AV_SYNC_OOB),g=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").AV_SYNC_COUNT);b=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").FRAMES_DECODED);b!=null&&c!=null&&e!=null&&c.mean!=null&&e.mean!=null&&(q+=b.current,o+=c.mean*b.current,p+=e.mean*b.current);f!=null&&g!=null&&(s+=g.current,r+=f.current)});q>0&&(l.av=Math.round(o/q),l.avabs=Math.round(p/q));s>0&&(l.avoob=Math.round(r*1e4/s));var t=0,u=0;b.forEach(function(b){var c=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_E2E_LATENCY);b=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").FRAMES_DECODED);c!=null&&c.mean!=null&&b!=null&&(t+=b.current,u+=c.mean*b.current)});t>0&&(l.e2el=Math.round(u/t));l.frcnt=b.reduce(function(b,c){c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_FREEZE_COUNT);return b+(c?c.current:0)},0);l.frdur=b.reduce(function(b,c){c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION);return b+(c?c.current:0)},0);l.frdur=Math.round(l.frdur);l.frdur500=b.reduce(function(b,c){c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_FREEZE_DURATION_500MS);return b+(c?c.current:0)},0);l.frdur500=Math.round(l.frdur500);l.pact=b.reduce(function(b,c){c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_PAUSE_COUNT);return b+(c?c.current:0)},0);l.padur=b.reduce(function(b,c){c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").VIDEO_PAUSE_DURATION);return b+(c?c.current:0)},0);l.padur=Math.round(l.padur);var v=0;b.forEach(function(b){var c=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_DECODED_HEIGHT);b=a.$50.getVideoMetric(b,d("FBRTCMediaMetricsConst").VIDEO_DECODED_WIDTH);b&&c&&b.updatedTime>v&&(l.rw=b.current,l.rh=c.current,v=b.updatedTime)});l.jtasb=b.reduce(function(b,c){c=a.$50.getVideoMetric(c,d("FBRTCMediaMetricsConst").FRAMES_RECEIVED);return b+(c?c.current:0)},0);m=this.$88(d("FBRTCMediaMetricsConst").VIDEO_SUM_DECODED_PIXEL,1);n=this.$88(d("FBRTCMediaMetricsConst").FRAMES_DECODED,1);m!=null&&n!=null&&n>0&&(l.dpxl=Math.round(m/n));return l};b.$104=function(){return new Date().valueOf()-this.$15};b.$61=function(){var a=c("performanceNow")()-this.$20;return Math.floor(this.$16+a)};b.$62=function(a){if(this.$6[a])return;this.$6[a]=this.$104();this.$7[a]=this.$61()};b.$69=function(a){if(this.$8[a])return;this.$8[a]=this.$104()};b.$63=function(a){if(this.$9[a])return;this.$9[a]=this.$104()};b.$66=function(a){if(this.$14[a])return;this.$14[a]=this.$104()};b.setDeviceCharged=function(a){this.$42!==!0&&(this.$42=a)};b.$64=function(a,b,c){a?this.$62(c):this.$62(b)};b.$60=function(){this.$17=new Date().valueOf()};b.$56=function(){var a=c("UserAgentData").browserName,b=c("UserAgentData").platformName;window.navigator.userAgent.toLowerCase().includes("mobile")&&(b+=" Mobile",a==="Chrome"&&(a="Mobile "+a));return{device:c("UserAgentData").deviceName,os:b,os_version:c("UserAgentData").platformFullVersion,browser:a,browser_version:c("UserAgentData").browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth,user_agent:window.navigator.userAgent}};b.$57=function(){window.navigator.connection!=null&&window.navigator.connection.effectiveType!=null&&this.addExtraInfo(c("FBRTCLogger").Key.CONNECTION_EFFECTIVE_TYPE,window.navigator.connection.effectiveType)};b.$59=function(){var a=d("WebPerformanceDeviceInfo").getMobileYearClass();a!=null&&a>0?this.addExtraInfo(c("FBRTCLogger").Key.YEAR_CLASS,a):this.addExtraInfo(c("FBRTCLogger").Key.DESKTOP_DEVICE_CLASS,d("WebPerformanceDeviceInfo").getDeviceLevel())};b.$58=function(){navigator.hardwareConcurrency!=null&&this.addExtraInfo(c("FBRTCLogger").Key.CPU_CORES,navigator.hardwareConcurrency),window.navigator.deviceMemory!=null&&this.addExtraInfo(c("FBRTCLogger").Key.DEVICE_MEMORY,window.navigator.deviceMemory),this.addExtraInfo(c("FBRTCLogger").Key.DEVICE_PIXEL_RATIO,window.devicePixelRatio)};b.getCallDuration=function(){var a=c("gkx")("707989");return this.$92({assumeOngoing:a})};b.getConnectedStartTime=function(){return this.$6[k.CALL_CONNECTED]?this.$6[k.CALL_CONNECTED]+this.$15:0};b.getCurrentTimeFromCallConnected=function(){var a=this.$7[k.CALL_CONNECTED];return this.$61()-a};b.getMediaMetricTracker=function(){return this.$50};b.getEndCallReason=function(){return this.$34!=null?d("FBRTCConstants").callEndReasonString(this.$34):"Unknown"};b.getRelayIP=function(){return this.$40};b.setRelayIP=function(a){this.$40=a};b.getClientVersion=function(){return this.$5};b.getHeartbeatData=function(){return this.$71()};b.wasCallEnded=function(){return this.$6[k.CALL_ENDED]!=null};return a}();a.CANONICAL_NULL_SUMMARY=Object.freeze(a.nullSummary());a.OLDEST_SUPPORTED_SUMMARY_VERSION=19;a.CURRENT_SUMMARY_VERSION=24;a.REPORT_KEY="reportID";g["default"]=a}),98);
__d("FBRTCCallSummaryStore",["CacheStorage","FBLogger","FBRTCCallSummary","FBRTCLogger","RTWebUserActionLogger","areEqual","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";var h="localstorage",i="RTC_CALL_SUMMARY_",j="summary",k=2e3,l=3,m=3*60*1e3,n=null;a=function(){a.getInstance=function(){n||(n=new a());return n};function a(){this.$1=new(c("CacheStorage"))(h,i),this.$2=c("FBRTCLogger").getInstance()}var b=a.prototype;b.storeCallSummary=function(a,b,d){if(d.isNull()){c("RTWebUserActionLogger").logError({errorDomain:"FBRTCCallSummaryStore_storeCallSummary",errorType:"FBRTCCallSummaryStore Storing invalid FBRTCCallSummary!",callID:b,userID:a});c("FBLogger")("rtweb").mustfix("Storing invalid FBRTCCallSummary!");return}var e=this;this.$3(function(c){c[a]||(c[a]={});var f=c[a][b];if(f){f=e.$4(f);if(f&&f.getLastUpdatedTime()>d.getLastUpdatedTime()){e.$2.logToConsole("Outdated summaries");return null}}c[a][b]=e.$5(d);return c},e.$2.logError.bind(e.$2,a,b))};b.retrieveCallSummary=function(a,b){var c=this.getCallSummaries(),d=null;c[a]&&(d=c[a][b]);if(d)return this.$4(d);else return null};b.removeCallSummary=function(a,b){this.removeCallSummaries([{peerID:a,callID:b}])};b.removeCallSummaries=function(a){var b=this;this.$3(function(c){var d=a.length;for(var e=0;e<d;e++){var f=a[e].peerID,g=a[e].callID;c[f]&&c[f][g]&&(delete c[f][g],b.$6(c[f])&&delete c[f])}return c},this.$2.logError.bind(this.$2,null,null))};b.getLoggableSummaries=function(){var a=this.getCallSummaries(),b=[];for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c))for(var d in a[c])if(Object.prototype.hasOwnProperty.call(a[c],d)){var e=this.$4(a[c][d],m);e&&b.push(e)}return b};b.$6=function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0};b.$5=function(a){a={__t:Date.now(),__d:a.toJsonString()};return a};b.$4=function(a,b){return a&&(!b||Date.now()-a.__t>=b)?c("FBRTCCallSummary").fromJsonString(a.__d):null};b.getCallSummaries=function(){var a=this.$1.get(j)||{};return a};b.$3=function(a,b,d,e){d===void 0&&(d=l);(d===void 0||d===null)&&(d=l);var f=this.getCallSummaries(),g=this.getCallSummaries();f=a(f);if(f===null)return;var h=this.getCallSummaries();if(c("areEqual")(g,h))this.$1.set(j,f),this.logStorageError(this.$1.getLastSetException());else if(d>0){b("Retry lock");if(e){var i=this;c("setTimeout")(function(){i.$3(a,b,d-1,!0)},k)}else this.$3(a,b,d-1,!0)}else b("Failed to lock")};b.logStorageError=function(a){a!=null&&c("RTWebUserActionLogger").logError({errorDomain:"FBRTCCallSummaryStore_storeCallSummary",errorType:a.name})};return a}();g["default"]=a}),98);
__d("FBRTCCallSummaryUploader",["DateConsts","ZenonCallSummaryUploader","cr:11757"],(function(a,b,c,d,e,f,g){var h=1*d("DateConsts").MS_PER_MIN,i=null;function a(){if(i!==null)return;i=window.setInterval(function(){d("ZenonCallSummaryUploader").logCallSummaries(),b("cr:11757")==null?void 0:b("cr:11757").logCallSummaries()},h)}g.init=a}),98);
__d("StartVideoChatLinkCall",["FBLogger","RTWebPreCallContextSingleton","RelayFBDefaultEnvironment","URI","XGroupCallController","ZenonPeerID","ZenonSignalingProtocol","gkx","randomZenonCallID","randomZenonNonce"],(function(a,b,c,d,e,f,g){"use strict";var h=d("RTWebPreCallContextSingleton").create({relayEnvironment:c("RelayFBDefaultEnvironment")});function a(a,b,e,f){b===void 0&&(b=!1);e===void 0&&(e=!1);f===void 0&&(f="");if(!c("gkx")("1811099"))return null;if(h){var g=h.callWindowController,j=h.incomingRingSDK,k="",l=a,m=c("randomZenonCallID")();if(b){b=i(a);k=c("randomZenonNonce")();b!=null&&(l=c("XGroupCallController").getURIBuilder().setString("call_context","LINK:"+b).setString("funnel_session_id",f).setString("nonce",k).setBool("auto_join",e?!0:null).getURI().getQualifiedURI().toString())}a=g.initCall({context:{callID:m,intent:"start or join",invitees:[],existingCall:null},mediaType:"video",nonce:k,joinContext:{linkUrl:l,type:"link"}});b=a[0];a[1];j.startCallIntent(k,{callID:m,callTrigger:"meetup_join",isPopupBlocked:b===null,isVideo:!0,peerID:d("ZenonPeerID").ZenonMWPeerID,protocol:c("ZenonSignalingProtocol").MW});return b}else return null}function i(a){var b=new(c("URI"))(a),d=b.getDomain();b=b.stripTrailingSlash().getPath();if(d==="msngr.com")return b.substring(1);if(d==="m.me"&&/^\/v(id)?\//.test(b))return b.replace(/^\/v(id)?\//,"");d=/^\/groupcall\/LINK:/;if(d.test(b))return b.replace(d,"");c("FBLogger")("rtc_www").mustfix('Could not extract LinkHash from Video Chat Link. Link = "%s"',a);return null}g.startCall=a}),98);
__d("RTWebCometRoomIncomingCallDialog_DisclaimerQuery_facebookRelayOperation",[],(function(a,b,c,d,e,f){e.exports="5077922372277873"}),null);